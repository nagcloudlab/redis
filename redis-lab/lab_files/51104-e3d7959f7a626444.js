"use strict";(this.webpackChunk_msteams_multi_window=this.webpackChunk_msteams_multi_window||[]).push([[51104],{651601:(n,e,t)=>{t.d(e,{Z:()=>R});var i=t(568140),r=t(198617),u=t(740372),o=t(491551),a=t(328150),c=t(274332),l=t(245018),f=t(137879),s=500;function d(n,e,t){e&&(0,a.kJ)(e)&&e[u.R5]>0&&(e=e.sort((function(n,e){return n[c.yi]-e[c.yi]})),(0,a.tO)(e,(function(n){n[c.yi]<s&&(0,a._y)("Channel has invalid priority - "+n[u.pZ])})),n[u.MW]({queue:(0,a.FL)(e),chain:(0,l.jV)(e,t[u.TC],t)}))}var v=t(28264),h=t(36102),p=t(365107),y=t(759958),g=t(429092),m=t(768599),b=t(97660),_=function(n){function e(){var t,i,o=n.call(this)||this;function l(){t=0,i=[]}return o.identifier="TelemetryInitializerPlugin",o.priority=199,l(),(0,r.Z)(e,o,(function(n,e){n.addTelemetryInitializer=function(n){var e={id:t++,fn:n};return i[u.MW](e),{remove:function(){(0,a.tO)(i,(function(n,t){if(n.id===e.id)return i[u.cb](t,1),-1}))}}},n[c.hL]=function(e,t){for(var r=!1,o=i[u.R5],c=0;c<o;++c){var l=i[c];if(l)try{if(!1===l.fn[u.ZV](null,[e])){r=!0;break}}catch(n){(0,y.kP)(t[u.mc](),1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+(0,a.jj)(n),{exception:(0,b.eU)(n)},!0)}}r||n[u.uL](e,t)},n[u.F3]=function(){l()}})),o}return(0,i.ne)(e,n),e.__ieDyn=1,e}(m.i),C=t(879983),T="Plugins must provide initialize method",x="SDK is still unloading...",S={loggingLevelConsole:1};function k(n,e){return new g.Jk(e)}function L(n,e){var t=!1;return(0,a.tO)(e,(function(e){if(e===n)return t=!0,-1})),t}var O=function(){function n(){var e,t,m,b,O,w,P,K,M,R,E,A,I,U,V,D,j,W,B,z,Z=0;(0,r.Z)(n,this,(function(n){function r(){t=!1,e=(0,a.mm)(!0,{},S),n[u.TC]=e,n[u.eZ]=new y.AQ(e),n[u.iC]=[],V=new _,m=[],b=null,O=null,w=null,P=null,K=null,R=null,M=[],E=null,A=null,I=null,U=!1,D=null,j=(0,h.J)("AIBaseCore",!0),W=(0,C.Y)(),z=null}function q(){return(0,l.CD)(J(),e,n)}function F(t){var i=function(n,e,t){var i,r=[],o={};return(0,a.tO)(t,(function(t){((0,a.le)(t)||(0,a.le)(t[u.VL]))&&(0,a._y)(T);var i=t[c.yi],l=t[u.pZ];t&&i&&((0,a.le)(o[i])?o[i]=l:(0,y.jV)(n,"Two extensions have same priority #"+i+" - "+o[i]+", "+l)),(!i||i<e)&&r[u.MW](t)})),(i={all:t})[c.oV]=r,i}(n[u.eZ],s,M);R=i[c.oV],K=null;var r=i.all;if(I=(0,a.FL)(function(n,e,t){var i=[];if(n&&(0,a.tO)(n,(function(n){return d(i,n,t)})),e){var r=[];(0,a.tO)(e,(function(n){n[c.yi]>s&&r[u.MW](n)})),d(i,r,t)}return i}(A,r,n)),E){var o=(0,a.UA)(r,E);-1!==o&&r[u.cb](o,1),-1!==(o=(0,a.UA)(R,E))&&R[u.cb](o,1),E._setQueue(I)}else E=function(n,e){function t(){return(0,l.CD)(null,e[u.TC],e,null)}function i(n,e,t,i){var r=n?n[u.R5]+1:1;function o(){0==--r&&(i&&i(),i=null)}r>0&&(0,a.tO)(n,(function(n){if(n&&n.queue[u.R5]>0){var i=n.chain,a=e[u.zV](i);a[u.Fc](o),t(a)}else r--})),o()}var r=!1;return{identifier:"ChannelControllerPlugin",priority:s,initialize:function(e,t,i,o){r=!0,(0,a.tO)(n,(function(n){n&&n.queue[u.R5]>0&&(0,f.bP)((0,l.CD)(n.chain,e,t),i)}))},isInitialized:function(){return r},processTelemetry:function(e,r){i(n,r||t(),(function(n){n[u.uL](e)}),(function(){r[u.uL](e)}))},update:function(e,t){var r=t||{reason:0};return i(n,e,(function(n){n[u.uL](r)}),(function(){e[u.uL](r)})),!0},pause:function(){i(n,t(),(function(n){n.iterate((function(n){n.pause&&n.pause()}))}),null)},resume:function(){i(n,t(),(function(n){n.iterate((function(n){n.resume&&n.resume()}))}),null)},teardown:function(e,t){var o=t||{reason:0,isAsync:!1};return i(n,e,(function(n){n[u.uL](o)}),(function(){e[u.uL](o),r=!1})),!0},getChannel:function(e){var t=null;return n&&n[u.R5]>0&&(0,a.tO)(n,(function(n){if(n&&n.queue[u.R5]>0&&((0,a.tO)(n.queue,(function(n){if(n[u.pZ]===e)return t=n,-1})),t))return-1})),t},flush:function(e,r,o,a){var c=1,l=!1,f=null;function s(){c--,l&&0===c&&(f&&(clearTimeout(f),f=null),r&&r(l),r=null)}return a=a||5e3,i(n,t(),(function(n){n.iterate((function(n){if(n[u.kL]){c++;var t=!1;n[u.kL](e,(function(){t=!0,s()}),o)||t||(e&&null==f?f=setTimeout((function(){f=null,s()}),a):s())}}))}),(function(){l=!0,s()})),!0},_setQueue:function(e){n=e}}}(I,n);r[u.MW](E),R[u.MW](E),n[u.iC]=(0,f.AA)(r),E[u.VL](e,n,r),(0,f.bP)(q(),r),n[u.iC]=(0,a.FL)((0,f.AA)(R||[])).slice(),t&&function(e){var t=(0,l.xy)(J(),n);n._updateHook&&!0===n._updateHook(t,e)||t[u.uL](e)}(t)}function H(e){var t,i=null,r=null;return(0,a.tO)(n[u.iC],(function(n){if(n[u.pZ]===e&&n!==E&&n!==V)return r=n,-1})),!r&&E&&(r=E.getChannel(e)),r&&((t={plugin:r})[u.$h]=function(n){(0,f.OY)(r)[c.mE]=!n},t.isEnabled=function(){var n=(0,f.OY)(r);return!n[u.fi]&&!n[c.mE]},t.remove=function(n,e){var t;void 0===n&&(n=!0);var i=[r],o=((t={reason:1})[u.d]=n,t);N(i,o,(function(n){n&&F({reason:32,removed:i}),e&&e(n)}))},i=t),i}function J(){if(!K){var t=(R||[]).slice();-1===(0,a.UA)(t,V)&&t[u.MW](V),K=(0,l.jV)((0,f.AA)(t),e,n)}return K}function N(t,i,r){if(t&&t[u.R5]>0){var o=(0,l.jV)(t,e,n),c=(0,l.Bt)(o,n);c[u.Fc]((function(){var n=!1,e=[];(0,a.tO)(M,(function(i,r){L(i,t)?n=!0:e[u.MW](i)})),M=e;var i=[];A&&((0,a.tO)(A,(function(e,r){var o=[];(0,a.tO)(e,(function(e){L(e,t)?n=!0:o[u.MW](e)})),i[u.MW](o)})),A=i),r&&r(n)})),c[u.uL](i)}else r(!1)}function Y(){var t=n[u.eZ]?n[u.eZ].queue:[];t&&((0,a.tO)(t,(function(t){var i,r=((i={})[u.I]=D||"InternalMessageId: "+t[u.Gc],i.iKey=(0,a.v4)(e[u.p$]),i.time=(0,a.Y6)(new Date),i.baseType=y.lQ.dataType,i.baseData={message:t[u.gU]},i);n.track(r)})),t[u.R5]=0)}function $(n,e,t,i){return E?E[u.kL](n,e,t||6,i):(e&&e(!1),!0)}function Q(e){var t=n[u.eZ];t?(0,y.kP)(t,2,73,e):(0,a._y)(e)}r(),n[u.yl]=function(){return t},n[u.VL]=function(r,o,l,f){U&&(0,a._y)(x),n[u.yl]()&&(0,a._y)("Core should not be initialized more than once"),e=r||{},n[u.TC]=e,(0,a.le)(r[u.p$])&&(0,a._y)("Please provide instrumentation key"),b=f,n._notificationManager=f,function(){var n=(0,a.v4)(e.disableDbgExt);!0===n&&B&&(b[u.n7](B),B=null);b&&!B&&!0!==n&&(B=(0,p.p)(e),b[u.g](B))}(),function(){var n=(0,a.v4)(e.enablePerfMgr);!n&&w&&(w=null);n&&(0,a.qK)(e,c.DN,k)}(),(0,a.qK)(e,c.Zh,{}).NotificationManager=b,l&&(n[u.eZ]=l);var s=(0,a.qK)(e,c.js,[]);(M=[])[u.MW].apply(M,(0,i.$h)((0,i.$h)([],o,!1),s,!1)),A=(0,a.qK)(e,c.Z,[]),F(null),I&&0!==I[u.R5]||(0,a._y)("No "+c.Z+" available"),t=!0,n.releaseQueue()},n.getTransmissionControls=function(){var n=[];return I&&(0,a.tO)(I,(function(e){n[u.MW](e.queue)})),(0,a.FL)(n)},n.track=function(t){t.iKey=t.iKey||e[u.p$],t[u.Z_]=t[u.Z_]||(0,a.Y6)(new Date),t.ver=t.ver||"4.0",!U&&n[u.yl]()?q()[u.uL](t):m[u.MW](t)},n[u.SD]=q,n[u.tb]=function(){var e;return b||(b=(0,o.pu)(((e={})[u.g]=function(n){},e[u.n7]=function(n){},e[c.uC]=function(n){},e[c.$F]=function(n,e){},e[c.f_]=function(n,e){},e)),n._notificationManager=b),b},n[u.g]=function(n){b&&b[u.g](n)},n[u.n7]=function(n){b&&b[u.n7](n)},n.getCookieMgr=function(){return P||(P=(0,v.Nz)(e,n[u.eZ])),P},n.setCookieMgr=function(n){P=n},n[c.kl]=function(){if(!O&&!w&&(0,a.v4)(e.enablePerfMgr)){var t=(0,a.v4)(e[c.DN]);(0,a.mf)(t)&&(w=t(n,n[u.tb]()))}return O||w||(0,g.j5)()},n.setPerfMgr=function(n){O=n},n.eventCnt=function(){return m[u.R5]},n.releaseQueue=function(){if(t&&m[u.R5]>0){var n=m;m=[],(0,a.tO)(n,(function(n){q()[u.uL](n)}))}},n.pollInternalLogs=function(n){D=n||null;var t=(0,a.v4)(e.diagnosticLogInterval);return t&&t>0||(t=1e4),Z&&clearInterval(Z),Z=setInterval((function(){Y()}),t)},n[u.LS]=function(){Z&&(clearInterval(Z),Z=0,Y())},(0,a.Vb)(n,(function(){return V}),["addTelemetryInitializer"]),n.unload=function(e,i,o){var c;void 0===e&&(e=!0),t||(0,a._y)("SDK is not initialized"),U&&(0,a._y)(x);var f=((c={reason:50})[u.d]=e,c.flushComplete=!1,c),s=(0,l.Bt)(J(),n);function d(e){f.flushComplete=e,U=!0,W.run(s,f),n[u.LS](),s[u.uL](f)}s[u.Fc]((function(){r(),i&&i(f)}),n),$(e,d,6,o)||d(!1)},n[u.TO]=H,n.addPlugin=function(n,e,t,i){if(!n)return i&&i(!1),void Q(T);var r=H(n[u.pZ]);if(r&&!e)return i&&i(!1),void Q("Plugin ["+n[u.pZ]+"] is already loaded!");var o={reason:16};function a(e){M[u.MW](n),o.added=[n],F(o),i&&i(!0)}if(r){var c=[r.plugin];N(c,{reason:2,isAsync:!!t},(function(n){n?(o.removed=c,o.reason|=32,a()):i&&i(!1)}))}else a()},n.evtNamespace=function(){return j},n[u.kL]=$,n.getTraceCtx=function(n){return z||(z=(0,f.Yn)()),z},n.setTraceCtx=function(n){z=n||null},(0,a.Oi)(n,"addUnloadCb",(function(){return W}),"add")}))}return n.__ieDyn=1,n}(),w=t(497275),P=function(n){function e(){var t=n.call(this)||this;return(0,r.Z)(e,t,(function(n,e){function t(e){var t=n[u.tb]();t&&t[c.$F]([e],2)}n[u.VL]=function(n,t,i,r){e[u.VL](n,t,i||new y.AQ(n),r||new w.f(n))},n.track=function(i){(0,g.Lm)(n[c.kl](),(function(){return"AppInsightsCore:track"}),(function(){null===i&&(t(i),(0,a._y)("Invalid telemetry item")),function(n){(0,a.le)(n[u.I])&&(t(n),(0,a._y)("telemetry name required"))}(i),e.track(i)}),(function(){return{item:i}}),!i.sync)}})),t}return(0,i.ne)(e,n),e.__ieDyn=1,e}(O),K=t(733835),M=t(731993);const R=function(n){function e(){var t=n.call(this)||this;return t.pluginVersionStringArr=[],(0,r.Z)(e,t,(function(n,e){n.logger&&n.logger.queue||(n.logger=new y.AQ({loggingLevelConsole:1})),n.initialize=function(t,i,r,u){(0,g.Lm)(n,(function(){return"AppInsightsCore.initialize"}),(function(){var o=n.pluginVersionStringArr;if(t){t.endpointUrl||(t.endpointUrl=K.YT);var c=t.propertyStorageOverride;!c||c.getProperty&&c.setProperty||(0,a._y)("Invalid property storage override passed."),t.channels&&(0,a.tO)(t.channels,(function(n){n&&(0,a.tO)(n,(function(n){if(n.identifier&&n.version){var e=n.identifier+"="+n.version;o.push(e)}}))}))}n.getWParam=function(){return"undefined"!=typeof document||t.enableWParam?0:-1},i&&(0,a.tO)(i,(function(n){if(n&&n.identifier&&n.version){var e=n.identifier+"="+n.version;o.push(e)}})),n.pluginVersionString=o.join(";"),n.pluginVersionStringArr=o;try{e.initialize(t,i,r,u),n.pollInternalLogs("InternalLog")}catch(e){var l=n.logger,f=(0,b.eU)(e);-1!==f.indexOf("channels")&&(f+="\n - Channels must be provided through config.channels only!"),(0,y.kP)(l,1,514,"SDK Initialization Failed - no telemetry will be sent: "+f)}}),(function(){return{config:t,extensions:i,logger:r,notificationManager:u}}))},n.track=function(t){(0,g.Lm)(n,(function(){return"AppInsightsCore.track"}),(function(){var i=t;if(i){i.timings=i.timings||{},i.timings.trackStart=(0,M.hK)(),(0,M.r7)(i.latency)||(i.latency=1);var r=i.ext=i.ext||{};r.sdk=r.sdk||{},r.sdk.ver=M.vs;var u=i.baseData=i.baseData||{};u[K.o6]=u[K.o6]||{};var o=u[K.o6];o[K.p8]=o[K.p8]||n.pluginVersionString||K.qS}e.track(i)}),(function(){return{item:t}}),!t.sync)}})),t}return(0,i.ne)(e,n),e.__ieDyn=1,e}(P)},733835:(n,e,t)=>{t.d(e,{qS:()=>i,YT:()=>r,p8:()=>u,o6:()=>o});var i="",r="https://browser.events.data.microsoft.com/OneCollector/1.0/",u="version",o="properties"},731993:(n,e,t)=>{t.d(e,{vs:()=>v,Sn:()=>y,jM:()=>g,r7:()=>m,yj:()=>b,Vv:()=>_,Do:()=>C,cm:()=>T,l7:()=>x,hK:()=>S,if:()=>O,mJ:()=>P,ot:()=>K});var i,r=t(97660),u=t(328150),o=t(28264),a=t(999519),c=t(422241),l=t(937150),f=t(414112),s=t(491551),d=t(733835),v="1DS-Web-JS-3.2.6",h="withCredentials",p=((i={})[0]=0,i[2]=6,i[1]=1,i[3]=7,i[4098]=6,i[4097]=1,i[4099]=7,i);Boolean((0,r.Me)()),Boolean((0,r.Jj)());function y(n){return!(n===d.qS||(0,u.le)(n))}function g(n){if(n){var e=n.indexOf("-");if(e>-1)return n.substring(0,e)}return d.qS}function m(n){return!!(n&&(0,u.hj)(n)&&n>=1&&n<=4)}function b(n,e,t){if(!e&&!y(e)||"string"!=typeof n)return null;var i=typeof e;if("string"===i||"number"===i||"boolean"===i||(0,u.kJ)(e))e={value:e};else if("object"!==i||c.CY.call(e,"value")){if((0,u.le)(e.value)||e.value===d.qS||!(0,u.HD)(e.value)&&!(0,u.hj)(e.value)&&!(0,u.jn)(e.value)&&!(0,u.kJ)(e.value))return null}else e={value:t?JSON.stringify(e):e};if((0,u.kJ)(e.value)&&!L(e.value))return null;if(!(0,u.le)(e.kind)){if((0,u.kJ)(e.value)||!k(e.kind))return null;e.value=e.value.toString()}return e}function _(n,e,t){var i=-1;if(!(0,u.o8)(n))if(e>0&&(32===e?i=8192:e<=13&&(i=e<<5)),function(n){if(n>=0&&n<=9)return!0;return!1}(t))-1===i&&(i=0),i|=t;else{var r=p[w(n)]||-1;-1!==i&&-1!==r?i|=r:6===r&&(i=r)}return i}function C(n,e,t){var i;return void 0===t&&(t=!0),n&&(i=n.get(e),t&&i&&decodeURIComponent&&(i=decodeURIComponent(i))),i||d.qS}function T(n){void 0===n&&(n="D");var e=(0,a.GW)();return"B"===n?e="{"+e+"}":"P"===n?e="("+e+")":"N"===n&&(e=e.replace(/-/g,d.qS)),e}function x(n,e,t,i,r){var o={},a=!1,l=0,f=arguments.length,s=Object[c.hB],d=arguments;for("[object Boolean]"===s.toString.call(d[0])&&(a=d[0],l++);l<f;l++){n=d[l];(0,u.rW)(n,(function(n,e){a&&e&&(0,u.Kn)(e)?(0,u.kJ)(e)?(o[n]=o[n]||[],(0,u.tO)(e,(function(e,t){e&&(0,u.Kn)(e)?o[n][t]=x(!0,o[n][t],e):o[n][t]=e}))):o[n]=x(!0,o[n],e):o[n]=e}))}return o}var S=a.Jj;function k(n){return 0===n||n>0&&n<=13||32===n}function L(n){return n.length>0}function O(n,e){var t=n;t.timings=t.timings||{},t.timings.processTelemetryStart=t.timings.processTelemetryStart||{},t.timings.processTelemetryStart[e]=S()}function w(n){var e=0;if(null!=n){var t=typeof n;"string"===t?e=1:"number"===t?e=2:"boolean"===t?e=3:t===c.fK&&(e=4,(0,u.kJ)(n)?(e=4096,n.length>0&&(e|=w(n[0]))):c.CY.call(n,"value")&&(e=8192|w(n.value)))}return e}c.jA,c.fK,c.jA,u.tO,u.UA,u.Mr,u.Xz,u.FY,u.Y6,r.b$,u.HD,u.hj,u.jn,u.mf,u.kJ,u.Kn,u.nd,r.MF,u.Y6,r.cp,o.p7,o.UY,u.l_,l.c9,l.Ib,u.Id,u.rW,u.Ym,u.o8,u.le,u.nr,u.mf,u.Kn,u.J_,u.kJ,u.VZ,u.HD,u.hj,u.jn,u.Y6,u.tO,u.UA,u.Mr,u.Xz,u.nd,s.pu,u.FY,u.l_,l.Ib,u.m6,r.w1,a.GW,a.Jj,f.pZ,f.az,f._l,f.CN,f.F6,a.DO;function P(){return!!(0,r.a8)("chrome")}function K(n,e,t,i,r,u){function o(n,e,t){try{n[e]=t}catch(n){}}void 0===i&&(i=!1),void 0===r&&(r=!1);var a=new XMLHttpRequest;return i&&o(a,"Microsoft_ApplicationInsights_BypassAjaxInstrumentation",i),t&&o(a,h,t),a.open(n,e,!r),t&&o(a,h,t),!r&&u&&o(a,"timeout",u),a}},493299:(n,e,t)=>{t.d(e,{Z:()=>un});var i=t(568140),r=t(198617),u=(0,t(637673).By)({Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5}),o=t(429092),a=t(937150),c=t(36102),l=t(731993),f=t(328150),s=t(97660),d=t(759958),v=t(768599),h="REAL_TIME",p="POST",y="drop",g="send",m="requeue",b="rspFail",_="application/x-json-stream",C="cache-control",T="content-type",x="kill-duration",S="time-delta-millis",k="client-version",L="client-id",O="time-delta-to-apply-millis",w="upload-time",P="apikey",K="AuthMsaDeviceTicket",M="AuthXToken";function R(n){var e=(n.ext||{}).intweb;return e&&(0,l.Sn)(e.msfpc)?e.msfpc:null}function E(n){for(var e=null,t=0;null===e&&t<n.length;t++)e=R(n[t]);return e}var A=function(){function n(e,t){var i=t?[].concat(t):[],r=this,u=E(i);r.iKey=function(){return e},r.Msfpc=function(){return u||""},r.count=function(){return i.length},r.events=function(){return i},r.addEvent=function(n){return!!n&&(i.push(n),u||(u=R(n)),!0)},r.split=function(t,r){var o;if(t<i.length){var a=i.length-t;(0,f.le)(r)||(a=r<a?r:a),o=i.splice(t,a),u=E(i)}return new n(e,o)}}return n.create=function(e,t){return new n(e,t)},n}();const I=function(){function n(){var e=!0,t=!0,i=!0,u="use-collector-delta",o=!1;(0,r.Z)(n,this,(function(n){n.allowRequestSending=function(){return e},n.firstRequestSent=function(){i&&(i=!1,o||(e=!1))},n.shouldAddClockSkewHeaders=function(){return t},n.getClockSkewHeaderValue=function(){return u},n.setClockSkew=function(n){o||(n?(u=n,t=!0,o=!0):t=!1,e=!0)}}))}return n.__ieDyn=1,n}();const U=function(){function n(){var e={};(0,r.Z)(n,this,(function(n){n.setKillSwitchTenants=function(n,t){if(n&&t)try{var i=(o=n.split(","),a=[],o&&(0,f.tO)(o,(function(n){a.push((0,f.nd)(n))})),a);if("this-request-only"===t)return i;for(var r=1e3*parseInt(t,10),u=0;u<i.length;++u)e[i[u]]=(0,f.m6)()+r}catch(n){return[]}var o,a;return[]},n.isTenantKilled=function(n){var t=e,i=(0,f.nd)(n);return void 0!==t[i]&&t[i]>(0,f.m6)()||(delete t[i],!1)}}))}return n.__ieDyn=1,n}();var V=t(422241);function D(n){var e,t=Math.floor(1200*Math.random())+2400;return e=Math.pow(2,n)*t,Math.min(e,6e5)}var j,W=2e6,B=Math.min(W,65e3),z=/\./,Z=function(){function n(e,t,i,u){var a="data",c="baseData",s=!!u,d=t,v={};(0,r.Z)(n,this,(function(n){function t(n,e,r,u,o,a,c){(0,f.rW)(n,(function(n,h){var p=null;if(h||(0,l.Sn)(h)){var y=r,g=n,m=o,b=e;if(s&&!u&&z.test(n)){var _=n.split("."),C=_.length;if(C>1){m&&(m=m.slice());for(var T=0;T<C-1;T++){var x=_[T];b=b[x]=b[x]||{},y+="."+x,m&&m.push(x)}g=_[C-1]}}if(p=!(u&&function(n,e){var t=v[n];return void 0===t&&(n.length>=7&&(t=(0,f.xe)(n,"ext.metadata")||(0,f.xe)(n,"ext.web")),v[n]=t),t}(y))&&d&&d.handleField(y,g)?d.value(y,g,h,i):(0,l.yj)(g,h,i)){var S=p.value;if(b[g]=S,a&&a(m,g,p),c&&"object"==typeof S&&!(0,f.kJ)(S)){var k=m;k&&(k=k.slice()).push(g),t(h,S,y+"."+g,u,k,a,c)}}}}))}n.createPayload=function(n,e,t,i,r,u){return{apiKeys:[],payloadBlob:"",overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:n,isTeardown:e,isSync:t,isBeacon:i,sendType:u,sendReason:r}},n.appendPayload=function(t,i,r){var u=t&&i&&!t.overflow;return u&&(0,o.Lm)(e,(function(){return"Serializer:appendPayload"}),(function(){for(var e=i.events(),u=t.payloadBlob,o=t.numEvents,a=!1,c=[],l=[],s=t.isBeacon,d=s?65e3:3984588,v=s?B:W,h=0,p=0;h<e.length;){var y=e[h];if(y){if(o>=r){t.overflow=i.split(h);break}var g=n.getEventBlob(y);if(g&&g.length<=v){var m=g.length;if(u.length+m>d){t.overflow=i.split(h);break}u&&(u+="\n"),u+=g,++p>20&&(u.substr(0,1),p=0),a=!0,o++}else g?c.push(y):l.push(y),e.splice(h,1),h--}h++}if(c&&c.length>0&&t.sizeExceed.push(A.create(i.iKey(),c)),l&&l.length>0&&t.failedEvts.push(A.create(i.iKey(),l)),a){t.batches.push(i),t.payloadBlob=u,t.numEvents=o;var b=i.iKey();-1===(0,f.UA)(t.apiKeys,b)&&t.apiKeys.push(b)}}),(function(){return{payload:t,theBatch:{iKey:i.iKey(),evts:i.events()},max:r}})),u},n.getEventBlob=function(n){try{return(0,o.Lm)(e,(function(){return"Serializer.getEventBlob"}),(function(){var e={};e.name=n.name,e.time=n.time,e.ver=n.ver,e.iKey="o:"+(0,l.jM)(n.iKey);var i={},r=n.ext;r&&(e.ext=i,(0,f.rW)(r,(function(n,e){t(e,i[n]={},"ext."+n,!0,null,null,!0)})));var u=e.data={};u.baseType=n.baseType;var o=u.baseData={};return t(n.baseData,o,c,!1,[c],(function(n,e,t){q(i,n,e,t)}),true),t(n.data,u,a,!1,[],(function(n,e,t){q(i,n,e,t)}),true),JSON.stringify(e)}),(function(){return{item:n}}))}catch(n){return null}}}))}return n.__ieDyn=1,n}();function q(n,e,t,i){if(i&&n){var r=(0,l.Vv)(i.value,i.kind,i.propertyType);if(r>-1){var u=n.metadata;u||(u=n.metadata={f:{}});var o=u.f;if(o||(o=u.f={}),e)for(var a=0;a<e.length;a++){var c=e[a];o[c]||(o[c]={f:{}});var s=o[c].f;s||(s=o[c].f={}),o=s}o=o[t]={},(0,f.kJ)(i.value)?o.a={t:r}:o.t=r}}}var F="&NoResponseBody=true",H=((j={})[1]=m,j[100]=m,j[200]="sent",j[8004]=y,j[8003]=y,j),J={},N={};function Y(n,e,t){J[n]=e,!1!==t&&(N[e]=n)}function $(n){try{return n.responseText}catch(n){}return""}function Q(n,e){var t=!1;if(n&&e){var i=(0,f.FY)(n);if(i&&i.length>0)for(var r=e.toLowerCase(),u=0;u<i.length;u++){var o=i[u];if(o&&(0,f.nr)(e,o)&&o.toLowerCase()===r){t=!0;break}}}return t}function X(n,e,t,i){e&&t&&t.length>0&&(i&&J[e]?(n.hdrs[J[e]]=t,n.useHdrs=!0):n.url+="&"+e+"="+t)}Y(K,K,!1),Y(k,k),Y(L,"Client-Id"),Y(P,P),Y(O,O),Y(w,w),Y(M,M);var G=function(){function n(e,t,i,u,a){this._responseHandlers=[];var c,v,h,m,K,M,R,E="?cors=true&"+T.toLowerCase()+"="+_,A=new U,j=!1,W=new I,B=!1,z=0,q=!0,J=[],Y={},G=[],nn=null,en=!1,tn=!1,rn=!1;(0,r.Z)(n,this,(function(n){var r=!0;function I(n,e){for(var t=0,i=null,r=0;null==i&&r<n.length;)1===(t=n[r])?(0,s.cp)()?i=U:(0,s.Z3)()&&(i=on):2===t&&(0,s.JO)(e)?i=un:B&&3===t&&(0,s.MF)()&&(i=cn),r++;return i?{_transport:t,_isSync:e,sendPOST:i}:null}function U(n,e,t){var i=new XDomainRequest;i.open(p,n.urlString),n.timeout&&(i.timeout=n.timeout),i.onload=function(){var n=$(i);an(e,200,{},n),_n(n)},i.onerror=function(){an(e,400,{})},i.ontimeout=function(){an(e,500,{})},i.onprogress=function(){},t?i.send(n.data):a.set((function(){i.send(n.data)}),0)}function un(n,e,t){var i,u=n.urlString,o=!1,c=!1,l=((i={body:n.data,method:p}).Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0,i);t&&(l.keepalive=!0,2===n._sendReason&&(o=!0,u+=F)),r&&(l.credentials="include"),n.headers&&(0,f.FY)(n.headers).length>0&&(l.headers=n.headers),fetch(u,l).then((function(n){var t={},i="",r=n.headers;r&&r.forEach((function(n,e){t[e]=n})),n.body&&n.text().then((function(n){i=n})),c||(c=!0,an(e,n.status,t,i),_n(i))})).catch((function(n){c||(c=!0,an(e,0,{}))})),o&&!c&&(c=!0,an(e,200,{})),!c&&n.timeout>0&&a.set((function(){c||(c=!0,an(e,500,{}))}),n.timeout)}function on(n,e,t){var i=n.urlString;function u(n,e,t){if(!n[t]&&e&&e.getResponseHeader){var i=e.getResponseHeader(t);i&&(n[t]=(0,f.nd)(i))}return n}function o(n){var e={};return n.getAllResponseHeaders?e=function(n){var e={};if((0,f.HD)(n)){var t=(0,f.nd)(n).split(/[\r\n]+/);(0,f.tO)(t,(function(n){if(n){var t=n.indexOf(": ");if(-1!==t){var i=(0,f.nd)(n.substring(0,t)).toLowerCase(),r=(0,f.nd)(n.substring(t+1));e[i]=r}else e[(0,f.nd)(n)]=1}}))}return e}(n.getAllResponseHeaders()):(e=u(e,n,S),e=u(e,n,x),e=u(e,n,"kill-duration-seconds")),e}function a(n,t){an(e,n.status,o(n),t)}t&&n.disableXhrSync&&(t=!1);var c=(0,l.ot)(p,i,r,!0,t,n.timeout);(0,f.rW)(n.headers,(function(n,e){c.setRequestHeader(n,e)})),c.onload=function(){var n=$(c);a(c,n),_n(n)},c.onerror=function(){a(c)},c.ontimeout=function(){a(c)},c.send(n.data)}function an(n,e,t,i){try{n(e,t,i)}catch(n){(0,d.kP)(v,2,518,(0,s.eU)(n))}}function cn(n,e,t){var i=200,r=n._thePayload,u=n.urlString+F;try{var o=(0,s.jW)();if(!o.sendBeacon(u,n.data))if(r){var a=[];(0,f.tO)(r.batches,(function(n){if(a&&n&&n.count()>0){for(var e=n.events(),t=0;t<e.length;t++)if(!o.sendBeacon(u,nn.getEventBlob(e[t]))){a.push(n.split(t));break}}else a.push(n.split(0))})),Cn(a,8003,r.sendType,!0)}else i=0}catch(n){(0,d.jV)(v,"Failed to send telemetry using sendBeacon API. Ex:"+(0,s.eU)(n)),i=0}finally{an(e,i,{},"")}}function ln(n){return 2===n||3===n}function fn(n){return tn&&ln(n)&&(n=2),n}function sn(){return!j&&z<t}function dn(){var n=G;return G=[],n}function vn(n,e,t){var i=!1;return n&&n.length>0&&!j&&h[e]&&nn&&(i=0!==e||sn()&&(t>0||W.allowRequestSending())),i}function hn(n){var e={};return n&&(0,f.tO)(n,(function(n,t){e[t]={iKey:n.iKey(),evts:n.events()}})),e}function pn(n,t,i,r,u){if(n&&0!==n.length)if(j)Cn(n,1,r);else{r=fn(r);try{var a=n,c=0!==r;(0,o.Lm)(m,(function(){return"HttpManager:_sendBatches"}),(function(o){o&&(n=n.slice(0));for(var a=[],f=null,d=(0,l.hK)(),v=h[r]||(c?h[1]:h[0]),p=(tn||ln(r)||v&&3===v._transport)&&!q&&B&&(0,s.MF)();vn(n,r,t);){var y=n.shift();y&&y.count()>0&&(A.isTenantKilled(y.iKey())?a.push(y):(f=f||nn.createPayload(t,i,c,p,u,r),nn.appendPayload(f,y,e)?null!==f.overflow&&(n=[f.overflow].concat(n),f.overflow=null,mn(f,d,(0,l.hK)(),u),d=(0,l.hK)(),f=null):(mn(f,d,(0,l.hK)(),u),d=(0,l.hK)(),n=[y].concat(n),f=null)))}f&&mn(f,d,(0,l.hK)(),u),n.length>0&&(G=n.concat(G)),Cn(a,8004,r)}),(function(){return{batches:hn(a),retryCount:t,isTeardown:i,isSynchronous:c,sendReason:u,useSendBeacon:ln(r),sendType:r}}),!c)}catch(n){(0,d.kP)(v,2,48,"Unexpected Exception sending batch: "+(0,s.eU)(n))}}}function yn(n,e){var t={url:E,hdrs:{},useHdrs:!1};e?(t.hdrs=(0,l.l7)(t.hdrs,Y),t.useHdrs=(0,f.FY)(t.hdrs).length>0):(0,f.rW)(Y,(function(n,e){N[n]?X(t,N[n],e,!1):(t.hdrs[n]=e,t.useHdrs=!0)})),X(t,L,"NO_AUTH",e),X(t,k,l.vs,e);var i="";(0,f.tO)(n.apiKeys,(function(n){i.length>0&&(i+=","),i+=n})),X(t,P,i,e),X(t,w,(0,f.m6)().toString(),e);var r=function(n){for(var e=0;e<n.batches.length;e++){var t=n.batches[e].Msfpc();if(t)return encodeURIComponent(t)}return""}(n);if((0,l.Sn)(r)&&(t.url+="&ext.intweb.msfpc="+r),W.shouldAddClockSkewHeaders()&&X(t,O,W.getClockSkewHeaderValue(),e),m.getWParam){var u=m.getWParam();u>=0&&(t.url+="&w="+u)}for(var o=0;o<J.length;o++)t.url+="&"+J[o].name+"="+J[o].value;return t}function gn(n,e,t){n[e]=n[e]||{},n[e][c.identifier]=t}function mn(e,t,r,u){if(e&&e.payloadBlob&&e.payloadBlob.length>0){var a=!!n.sendHook,p=h[e.sendType];!ln(e.sendType)&&e.isBeacon&&2===e.sendReason&&(p=h[2]||h[3]||p);var y=rn;(e.isBeacon||3===p._transport)&&(y=!1);var g=yn(e,y);y=y||g.useHdrs;var b=(0,l.hK)();(0,o.Lm)(m,(function(){return"HttpManager:_doPayloadSend"}),(function(){for(var h=0;h<e.batches.length;h++)for(var x=e.batches[h].events(),S=0;S<x.length;S++){var k=x[S];if(en){var L=k.timings=k.timings||{};gn(L,"sendEventStart",b),gn(L,"serializationStart",t),gn(L,"serializationCompleted",r)}k.sendAttempt>0?k.sendAttempt++:k.sendAttempt=1}Cn(e.batches,1e3+(u||0),e.sendType,!0);var O={data:e.payloadBlob,urlString:g.url,headers:g.hdrs,_thePayload:e,_sendReason:u,timeout:M};(0,f.o8)(R)||(O.disableXhrSync=!!R),y&&(Q(O.headers,C)||(O.headers["cache-control"]="no-cache, no-store"),Q(O.headers,T)||(O.headers["content-type"]=_));var w=null;p&&(w=function(t){W.firstRequestSent();var r=function(t,r){!function(e,t,r,u){var o=9e3,a=null,s=!1,d=!1;try{var v=!0;if(typeof e!==V.jA){if(t){W.setClockSkew(t["time-delta-millis"]);var h=t["kill-duration"]||t["kill-duration-seconds"];(0,f.tO)(A.setKillSwitchTenants(t["kill-tokens"],h),(function(n){(0,f.tO)(r.batches,(function(e){if(e.iKey()===n){a=a||[];var t=e.split(0);r.numEvents-=t.count(),a.push(t)}}))}))}if(200==e||204==e)return void(o=200);((y=e)>=300&&y<500&&408!=y&&429!=y||501==y||505==y||r.numEvents<=0)&&(v=!1),o=9e3+e%1e3}if(v){o=100;var p=r.retryCnt;0===r.sendType&&(p<i?(s=!0,bn((function(){0===r.sendType&&z--,pn(r.batches,p+1,r.isTeardown,tn?2:r.sendType,5)}),tn,D(p))):(d=!0,tn&&(o=8001)))}}finally{s||(W.setClockSkew(),function(e,t,i,r){try{r&&c._backOffTransmission(),200===t&&(r||e.isSync||c._clearBackOff(),function(n){if(en){var e=(0,l.hK)();(0,f.tO)(n,(function(n){n&&n.count()>0&&function(n,e){en&&(0,f.tO)(n,(function(n){gn(n.timings=n.timings||{},"sendEventCompleted",e)}))}(n.events(),e)}))}}(e.batches)),Cn(e.batches,t,e.sendType,!0)}finally{0===e.sendType&&(z--,5!==i&&n.sendQueuedRequests(e.sendType,i))}}(r,o,u,d)),Cn(a,8004,r.sendType)}var y}(t,r,e,u)},o=e.isTeardown||e.isSync;try{p.sendPOST(t,r,o),n.sendListener&&n.sendListener(O,t,o,e.isBeacon)}catch(n){(0,d.jV)(v,"Unexpected exception sending payload. Ex:"+(0,s.eU)(n)),an(r,0,{})}}),(0,o.Lm)(m,(function(){return"HttpManager:_doPayloadSend.sender"}),(function(){if(w)if(0===e.sendType&&z++,a&&!e.isBeacon&&3!==p._transport){var t={data:O.data,urlString:O.urlString,headers:(0,l.l7)({},O.headers),timeout:O.timeout,disableXhrSync:O.disableXhrSync},i=!1;(0,o.Lm)(m,(function(){return"HttpManager:_doPayloadSend.sendHook"}),(function(){try{n.sendHook(t,(function(n){i=!0,q||n._thePayload||(n._thePayload=n._thePayload||O._thePayload,n._sendReason=n._sendReason||O._sendReason),w(n)}),e.isSync||e.isTeardown)}catch(n){i||w(O)}}))}else w(O)}))}),(function(){return{thePayload:e,serializationStart:t,serializationCompleted:r,sendReason:u}}),e.isSync)}e.sizeExceed&&e.sizeExceed.length>0&&Cn(e.sizeExceed,8003,e.sendType),e.failedEvts&&e.failedEvts.length>0&&Cn(e.failedEvts,8002,e.sendType)}function bn(n,e,t){e?n():a.set(n,t)}function _n(e){var t=n._responseHandlers;try{for(var i=0;i<t.length;i++)try{t[i](e)}catch(n){(0,d.kP)(v,1,519,"Response handler failed: "+n)}if(e){var r=JSON.parse(e);(0,l.Sn)(r.webResult)&&(0,l.Sn)(r.webResult.msfpc)&&K.set("MSFPC",r.webResult.msfpc,31536e3)}}catch(n){}}function Cn(n,e,t,i){if(n&&n.length>0&&u){var r=u[function(n){var e=H[n];(0,l.Sn)(e)||(e="oth",n>=9e3&&n<=9999?e=b:n>=8e3&&n<=8999?e=y:n>=1e3&&n<=1999&&(e=g));return e}(e)];if(r){var a=0!==t;(0,o.Lm)(m,(function(){return"HttpManager:_sendBatchesNotification"}),(function(){bn((function(){try{r.call(u,n,e,a,t)}catch(n){(0,d.kP)(v,1,74,"send request notification failed: "+n)}}),i||a,0)}),(function(){return{batches:hn(n),reason:e,isSync:a,sendSync:i,sendType:t}}),!a)}}}n.initialize=function(n,e,t,i,u){var o;u||(u={}),E=n+E,rn=!!(0,f.o8)(u.avoidOptions)||!u.avoidOptions,m=e,K=e.getCookieMgr(),en=!m.config.disableEventTimings;var a=!!m.config.enableCompoundKey;v=(c=t).diagLog();var l=u.valueSanitizer,p=u.stringifyObjects;(0,f.o8)(u.enableCompoundKey)||(a=!!u.enableCompoundKey),M=u.xhrTimeout,R=u.disableXhrSync,B=!(0,s.b$)(),nn=new Z(m,l,p,a);var y=i,g=u.alwaysUseXhrOverride?i:null,b=u.alwaysUseXhrOverride?i:null;if(!i){q=!1;var _=(0,s.k$)();_&&_.protocol&&"file:"===_.protocol.toLowerCase()&&(r=!1);var C=[];C=(0,s.b$)()?[2,1]:[1,2,3];var T=u.transports;T&&((0,f.hj)(T)?C=[T].concat(C):(0,f.kJ)(T)&&(C=T.concat(C))),i=I(C,!1),y=I(C,!0),i||(0,d.jV)(v,"No available transport to send events")}(o={})[0]=i,o[1]=y||I([1,2,3],!0),o[2]=g||I([3,2],!0)||y||I([1],!0),o[3]=b||I([2,3],!0)||y||I([1],!0),h=o},n._getDbgPlgTargets=function(){return[h[0],A,nn,h]},n.addQueryStringParameter=function(n,e){for(var t=0;t<J.length;t++)if(J[t].name===n)return void(J[t].value=e);J.push({name:n,value:e})},n.addHeader=function(n,e){Y[n]=e},n.canSendRequest=function(){return sn()&&W.allowRequestSending()},n.sendQueuedRequests=function(n,e){(0,f.o8)(n)&&(n=0),tn&&(n=fn(n),e=2),vn(G,n,0)&&pn(dn(),0,!1,n,e||0)},n.isCompletelyIdle=function(){return!j&&0===z&&0===G.length},n.setUnloading=function(n){tn=n},n.addBatch=function(n){if(n&&n.count()>0){if(A.isTenantKilled(n.iKey()))return!1;G.push(n)}return!0},n.teardown=function(){G.length>0&&pn(dn(),0,!0,2,2)},n.pause=function(){j=!0},n.resume=function(){j=!1,n.sendQueuedRequests(0,4)},n.sendSynchronousBatch=function(n,e,t){n&&n.count()>0&&((0,f.le)(e)&&(e=1),tn&&(e=fn(e),t=2),pn([n],0,!1,e,t||0))}}))}return n.__ieDyn=1,n}();function nn(n,e){for(var t=[],i=2;i<arguments.length;i++)t[i-2]=arguments[i];return setTimeout(n,e,t)}function en(n){clearTimeout(n)}function tn(n,e){return{set:n||nn,clear:e||en}}var rn="eventsDiscarded";const un=function(n){function e(){var t,i=n.call(this)||this;i.identifier="PostChannel",i.priority=1011,i.version="3.2.6";var v,p,y,g,m,b,_,C=!1,T=[],x=null,S=!1,k=0,L=500,O=0,w=1e4,P={},M=h,R=null,E=null,I=0,U=0,V={},j=-1,W=!0,B=!1,z=6,Z=2;return(0,r.Z)(e,i,(function(n,e){function i(n){"beforeunload"!==(n||(0,s.Jj)().event).type&&(B=!0,p.setUnloading(B)),Q(2,2)}function r(n){B=!1,p.setUnloading(B)}function q(n,e){if(n.sendAttempt||(n.sendAttempt=0),n.latency||(n.latency=1),n.ext&&n.ext.trace&&delete n.ext.trace,n.ext&&n.ext.user&&n.ext.user.id&&delete n.ext.user.id,W&&(l.if,n.ext=(0,f.Ax)(n.ext),n.baseData&&(n.baseData=(0,f.Ax)(n.baseData)),n.data&&(n.data=(0,f.Ax)(n.data))),n.sync)if(I||S)n.latency=3,n.sync=!1;else if(p)return W&&(n=(0,f.Ax)(n)),void p.sendSynchronousBatch(A.create(n.iKey,[n]),!0===n.sync?1:n.sync,3);var t=n.latency,i=O,r=w;4===t&&(i=k,r=L);var o=!1;if(i<r)o=!en(n,e);else{var a=1,c=20;4===t&&(a=4,c=1),o=!0,function(n,e,t,i){for(;t<=e;){var r=X(n,e,!0);if(r&&r.count()>0){var o=r.split(0,i),a=o.count();if(a>0)return 4===t?k-=a:O-=a,vn(rn,[o],u.QueueFull),!0}t++}return un(),!1}(n.iKey,n.latency,a,c)&&(o=!en(n,e))}o&&dn(rn,[n],u.QueueFull)}function F(n,e,t){var i=on(n,e,t);return p.sendQueuedRequests(e,t),i}function H(){return O>0}function J(){if(j>=0&&on(j,0,m)&&p.sendQueuedRequests(0,m),k>0&&!E&&!S){var n=P[M][2];n>=0&&(E=Y((function(){E=null,F(4,0,1),J()}),n))}var e=P[M][1];!R&&!x&&e>=0&&!S&&(H()?R=Y((function(){R=null,F(0===U?3:1,0,1),U++,U%=2,J()}),e):U=0)}function N(){t=null,C=!1,T=[],x=null,S=!1,k=0,L=500,O=0,w=1e4,P={},M=h,R=null,E=null,I=0,U=0,v=null,V={},y=void 0,g=0,j=-1,m=null,W=!0,B=!1,z=6,Z=2,b=null,_=tn(),p=new G(500,2,1,{requeue:fn,send:hn,sent:pn,drop:yn,rspFail:gn,oth:mn},_),ln(),V[4]={batches:[],iKeyMap:{}},V[3]={batches:[],iKeyMap:{}},V[2]={batches:[],iKeyMap:{}},V[1]={batches:[],iKeyMap:{}},bn()}function Y(n,e){0===e&&I&&(e=1);var t=1e3;return I&&(t=D(I-1)),_.set(n,e*t)}function $(){return null!==R&&(_.clear(R),R=null,U=0,!0)}function Q(n,e){$(),x&&(_.clear(x),x=null),S||F(1,n,e)}function X(n,e,t){var i=V[e];i||(i=V[e=1]);var r=i.iKeyMap[n];return!r&&t&&(r=A.create(n),i.batches.push(r),i.iKeyMap[n]=r),r}function nn(e,t){p.canSendRequest()&&!I&&(y>0&&O>y&&(t=!0),t&&null==x&&n.flush(e,null,20))}function en(n,e){W&&(n=(0,f.Ax)(n));var t=n.latency,i=X(n.iKey,t,!0);return!!i.addEvent(n)&&(4!==t?(O++,e&&0===n.sendAttempt&&nn(!n.sync,g>0&&i.count()>=g)):k++,!0)}function un(){for(var n=0,e=0,t=function(t){var i=V[t];i&&i.batches&&(0,f.tO)(i.batches,(function(i){4===t?n+=i.count():e+=i.count()}))},i=1;i<=4;i++)t(i);O=e,k=n}function on(e,t,i){var r=!1,a=0===t;return!a||p.canSendRequest()?(0,o.Lm)(n.core,(function(){return"PostChannel._queueBatches"}),(function(){for(var n=[],t=4;t>=e;){var i=V[t];i&&i.batches&&i.batches.length>0&&((0,f.tO)(i.batches,(function(e){p.addBatch(e)?r=r||e&&e.count()>0:n=n.concat(e.events()),4===t?k-=e.count():O-=e.count()})),i.batches=[],i.iKeyMap={}),t--}n.length>0&&dn(rn,n,u.KillSwitch),r&&j>=e&&(j=-1,m=0)}),(function(){return{latency:e,sendType:t,sendReason:i}}),!a):(j=j>=0?Math.min(j,e):e,m=Math.max(m,i)),r}function an(n,e){F(1,0,e),un(),cn((function(){n&&n(),T.length>0?x=Y((function(){x=null,an(T.shift(),e)}),0):(x=null,J())}))}function cn(n){p.isCompletelyIdle()?n():x=Y((function(){x=null,cn(n)}),.25)}function ln(){(P={}).REAL_TIME=[2,1,0],P.NEAR_REAL_TIME=[6,3,0],P.BEST_EFFORT=[18,9,0]}function fn(e,t){var i=[],r=z;B&&(r=Z),(0,f.tO)(e,(function(e){e&&e.count()>0&&(0,f.tO)(e.events(),(function(e){e&&(e.sync&&(e.latency=4,e.sync=!1),e.sendAttempt<r?((0,l.if)(e,n.identifier),q(e,!1)):i.push(e))}))})),i.length>0&&dn(rn,i,u.NonRetryableStatus),B&&Q(2,2)}function sn(e,t){var i=n._notificationManager||{},r=i[e];if(r)try{r.apply(i,t)}catch(t){(0,d.kP)(n.diagLog(),1,74,e+" notification failed: "+t)}}function dn(n,e){for(var t=[],i=2;i<arguments.length;i++)t[i-2]=arguments[i];e&&e.length>0&&sn(n,[e].concat(t))}function vn(n,e){for(var t=[],i=2;i<arguments.length;i++)t[i-2]=arguments[i];e&&e.length>0&&(0,f.tO)(e,(function(e){e&&e.count()>0&&sn(n,[e.events()].concat(t))}))}function hn(n,e,t){n&&n.length>0&&sn("eventsSendRequest",[e>=1e3&&e<=1999?e-1e3:0,!0!==t])}function pn(n,e){vn("eventsSent",n,e),J()}function yn(n,e){vn(rn,n,e>=8e3&&e<=8999?e-8e3:u.Unknown)}function gn(n){vn(rn,n,u.NonRetryableStatus),J()}function mn(n,e){vn(rn,n,u.Unknown),J()}function bn(){g=t&&t.disableAutoBatchFlushLimit?0:Math.max(1500,w/6)}N(),n._getDbgPlgTargets=function(){return[p]},n.initialize=function(u,s,d){(0,o.Lm)(s,(function(){return"PostChannel:initialize"}),(function(){var o=s;e.initialize(u,s,d);try{s.addUnloadCb;b=(0,a.jU)((0,c.J)(n.identifier),s.evtNamespace&&s.evtNamespace());var h=n._getTelCtx();u.extensionConfig[n.identifier]=u.extensionConfig[n.identifier]||{},t=h.getExtCfg(n.identifier),_=tn(t.setTimeoutOverride,t.clearTimeoutOverride),W=!t.disableOptimizeObj&&(0,l.mJ)(),function(n){var e=n.getWParam;n.getWParam=function(){var n=0;return t.ignoreMc1Ms0CookieProcessing&&(n|=2),n|e()}}(o),t.eventsLimitInMem>0&&(w=t.eventsLimitInMem),t.immediateEventLimit>0&&(L=t.immediateEventLimit),t.autoFlushEventsLimit>0&&(y=t.autoFlushEventsLimit),(0,f.hj)(t.maxEventRetryAttempts)&&(z=t.maxEventRetryAttempts),(0,f.hj)(t.maxUnloadEventRetryAttempts)&&(Z=t.maxUnloadEventRetryAttempts),bn(),t.httpXHROverride&&t.httpXHROverride.sendPOST&&(v=t.httpXHROverride),(0,l.Sn)(u.anonCookieName)&&p.addQueryStringParameter("anoncknm",u.anonCookieName),p.sendHook=t.payloadPreprocessor,p.sendListener=t.payloadListener;var g=t.overrideEndpointUrl?t.overrideEndpointUrl:u.endpointUrl;n._notificationManager=u.extensionConfig.NotificationManager,p.initialize(g,n.core,n,v,t);var m=u.disablePageUnloadEvents||[];(0,a.c9)(i,m,b),(0,a.TJ)(i,m,b),(0,a.nD)(r,u.disablePageShowEvents,b)}catch(e){throw n.setInitialized(!1),e}}),(function(){return{coreConfig:u,core:s,extensions:d}}))},n.processTelemetry=function(e,i){(0,l.if)(e,n.identifier);var r=(i=n._getTelCtx(i)).getExtCfg(n.identifier),u=!!t.disableTelemetry;r&&(u=u||!!r.disableTelemetry);var o=e;u||C||(t.overrideInstrumentationKey&&(o.iKey=t.overrideInstrumentationKey),r&&r.overrideInstrumentationKey&&(o.iKey=r.overrideInstrumentationKey),q(o,!0),B?Q(2,2):J()),n.processNext(o,i)},n._doTeardown=function(n,e){Q(2,2),C=!0,p.teardown(),(0,a.JA)(null,b),(0,a.C9)(null,b),(0,a.Yl)(null,b),N()},n.setEventQueueLimits=function(n,e){w=n>0?n:1e4,y=e>0?e:0,bn();var t=O>n;if(!t&&g>0)for(var i=1;!t&&i<=3;i++){var r=V[i];r&&r.batches&&(0,f.tO)(r.batches,(function(n){n&&n.count()>=g&&(t=!0)}))}nn(!0,t)},n.pause=function(){$(),S=!0,p.pause()},n.resume=function(){S=!1,p.resume(),J()},n.addResponseHandler=function(n){p._responseHandlers.push(n)},n._loadTransmitProfiles=function(n){$(),ln(),M=h,J(),(0,f.rW)(n,(function(n,e){var t=e.length;if(t>=2){var i=t>2?e[2]:0;if(e.splice(0,t-2),e[1]<0&&(e[0]=-1),e[1]>0&&e[0]>0){var r=e[0]/e[1];e[0]=Math.ceil(r)*e[1]}i>=0&&e[1]>=0&&i>e[1]&&(i=e[1]),e.push(i),P[n]=e}}))},n.flush=function(n,e,t){if(void 0===n&&(n=!0),!S)if(t=t||1,n)null==x?($(),on(1,0,t),x=Y((function(){x=null,an(e,t)}),0)):T.push(e);else{var i=$();F(1,1,t),null!=e&&e(),i&&J()}},n.setMsaAuthTicket=function(n){p.addHeader(K,n)},n.hasEvents=H,n._setTransmitProfile=function(n){M!==n&&void 0!==P[n]&&($(),M=n,J())},n._backOffTransmission=function(){I<4&&(I++,$(),J())},n._clearBackOff=function(){I&&(I=0,$(),J())},(0,f.l_)(n,"_setTimeoutOverride",(function(){return _.set}),(function(n){_=tn(n,_.clear)})),(0,f.l_)(n,"_clearTimeoutOverride",(function(){return _.clear}),(function(n){_=tn(_.set,n)}))})),i}return(0,i.ne)(e,n),e.__ieDyn=1,e}(v.i)},768599:(n,e,t)=>{t.d(e,{i:()=>l});var i=t(198617),r=t(740372),u=t(328150),o=t(274332),a=t(245018),c=t(879983),l=function(){function n(){var e,t,l,f,s,d=this;function v(n){void 0===n&&(n=null);var e=n;if(!e){var i=t||(0,a.CD)(null,{},d[o.oV]);e=l&&l.getPlugin?i[r.zV](null,l.getPlugin):i[r.zV](null,l)}return e}function h(n,e,i){n&&(0,u.sO)(n,o.Zh,[],null,u.le),!i&&e&&(i=e[r.SD]()[r.W2]());var c=l;l&&l.getPlugin&&(c=l.getPlugin()),d[o.oV]=e,t=(0,a.CD)(i,n,e,c)}function p(){e=!1,d[o.oV]=null,t=null,l=null,s=[],f=(0,c.Y)()}p(),(0,i.Z)(n,d,(function(n){n[r.VL]=function(n,t,i,r){h(n,t,r),e=!0},n[r.fi]=function(e,t){var i,c=n[o.oV];if(c&&(!e||c===e[o.oV]())){var d,v=!1,h=e||(0,a.Bt)(null,c,l&&l.getPlugin?l.getPlugin():l),y=t||((i={reason:0})[r.d]=!1,i);return n[r.F3]&&!0===n[r.F3](h,y,g)?d=!0:g(),d}function g(){if(!v){v=!0,f.run(h,t);var n=s;s=[],(0,u.tO)(n,(function(n){n.rm()})),!0===d&&h[r.uL](y),p()}}},n[r.Tu]=function(e,t){var i=n[o.oV];if(i&&(!e||i===e[o.oV]())){var u,c=!1,f=e||(0,a.xy)(null,i,l&&l.getPlugin?l.getPlugin():l),s=t||{reason:0};return n._doUpdate&&!0===n._doUpdate(f,s,d)?u=!0:d(),u}function d(){c||(c=!0,h(f.getCfg(),f.core(),f[r.W2]()))}},n._addHook=function(n){n&&((0,u.kJ)(n)?s=s.concat(n):s[r.MW](n))},(0,u.Oi)(n,"_addUnloadCb",(function(){return f}),"add")})),d[r.mc]=function(n){return v(n)[r.mc]()},d[r.yl]=function(){return e},d.setInitialized=function(n){e=n},d[r.Jd]=function(n){l=n},d[r.uL]=function(n,e){e?e[r.uL](n):l&&(0,u.mf)(l[o.hL])&&l[o.hL](n,null)},d._getTelCtx=v}return n.__ieDyn=1,n}()},497275:(n,e,t)=>{t.d(e,{f:()=>c});var i=t(198617),r=t(740372),u=t(328150),o=t(274332);function a(n,e,t,i){(0,u.tO)(n,(function(n){if(n&&n[e])if(t)setTimeout((function(){return i(n)}),0);else try{i(n)}catch(n){}}))}var c=function(){function n(e){this.listeners=[];var t=!!(e||{}).perfEvtsSendAll;(0,i.Z)(n,this,(function(n){n[r.g]=function(e){n.listeners[r.MW](e)},n[r.n7]=function(e){for(var t=(0,u.UA)(n[r.dE],e);t>-1;)n.listeners[r.cb](t,1),t=(0,u.UA)(n[r.dE],e)},n[o.uC]=function(e){a(n[r.dE],o.uC,!0,(function(n){n[o.uC](e)}))},n[o.$F]=function(e,t){a(n[r.dE],o.$F,!0,(function(n){n[o.$F](e,t)}))},n[o.f_]=function(e,t){a(n[r.dE],o.f_,t,(function(n){n[o.f_](e,t)}))},n[o.C$]=function(e){e&&(!t&&e[r.PL]()||a(n[r.dE],o.C$,!1,(function(n){e[r.d]?setTimeout((function(){return n[o.C$](e)}),0):n[o.C$](e)})))}}))}return n.__ieDyn=1,n}()},429092:(n,e,t)=>{t.d(e,{Jk:()=>l,Lm:()=>s,j5:()=>d});var i=t(198617),r=t(740372),u=t(328150),o=t(274332),a=null,c=function(){function n(e,t,i){var o,a=this,c=!1;(a.start=(0,u.m6)(),a[r.I]=e,a[r.d]=i,a[r.PL]=function(){return!1},(0,u.mf)(t))&&(c=(0,u.l_)(a,"payload",(function(){return!o&&(0,u.mf)(t)&&(o=t(),t=null),o})));a[r.T]=function(e){return e?e===n.ParentContextKey||e===n.ChildrenContextKey?a[e]:(a.ctx||{})[e]:null},a[r.wu]=function(e,t){if(e)if(e===n.ParentContextKey)a[e]||(a[r.PL]=function(){return!0}),a[e]=t;else if(e===n.ChildrenContextKey)a[e]=t;else{(a.ctx=a.ctx||{})[e]=t}},a[r.Km]=function(){var e=0,i=a[r.T](n.ChildrenContextKey);if((0,u.kJ)(i))for(var o=0;o<i[r.R5];o++){var l=i[o];l&&(e+=l[r.Z_])}a[r.Z_]=(0,u.m6)()-a.start,a.exTime=a[r.Z_]-e,a[r.Km]=function(){},!c&&(0,u.mf)(t)&&(a.payload=t())}}return n.ParentContextKey="parent",n.ChildrenContextKey="childEvts",n}(),l=function(){function n(e){this.ctx={},(0,i.Z)(n,this,(function(n){n.create=function(n,e,t){return new c(n,e,t)},n.fire=function(n){n&&(n[r.Km](),e&&(0,u.mf)(e[o.C$])&&e[o.C$](n))},n[r.wu]=function(e,t){e&&((n.ctx=n.ctx||{})[e]=t)},n[r.T]=function(e){return(n.ctx||{})[e]}}))}return n.__ieDyn=1,n}(),f="CoreUtils.doPerf";function s(n,e,t,i,u){if(n){var a=n;if(a[o.kl]&&(a=a[o.kl]()),a){var l=void 0,s=a[r.T](f);try{if(l=a.create(e(),i,u)){if(s&&l[r.wu]&&(l[r.wu](c.ParentContextKey,s),s[r.T]&&s[r.wu])){var d=s[r.T](c.ChildrenContextKey);d||(d=[],s[r.wu](c.ChildrenContextKey,d)),d[r.MW](l)}return a[r.wu](f,l),t(l)}}catch(n){l&&l[r.wu]&&l[r.wu]("exception",n)}finally{l&&a.fire(l),a[r.wu](f,s)}}}return t()}function d(){return a}},245018:(n,e,t)=>{t.d(e,{CD:()=>v,Bt:()=>h,xy:()=>p,jV:()=>y});var i=t(740372),r=t(759958),u=t(97660),o=t(328150),a=t(274332),c=t(429092),l=t(137879),f="TelemetryPluginChain",s=0;function d(n,e,t,c){var l=null,f=[];null!==c&&(l=c?function(n,e,t){for(;n;){if(n[i.TO]()===t)return n;n=n[i.W2]()}return y([t],e[i.TC]||{},e)}(n,t,c):n);var s={_next:function(){var n=l;if(l=n?n[i.W2]():null,!n){var e=f;e&&e[i.R5]>0&&((0,o.tO)(e,(function(n){try{n.func[i._S](n.self,n.args)}catch(n){(0,r.kP)(t[i.eZ],2,73,"Unexpected Exception during onComplete - "+(0,u.eU)(n))}})),f=[])}return n},ctx:{core:function(){return t},diagLog:function(){return(0,r.vH)(t,e)},getCfg:function(){return e},getExtCfg:d,getConfig:function(n,t,i){void 0===i&&(i=!1);var r,u=d(n,null);u&&!(0,o.le)(u[t])?r=u[t]:e&&!(0,o.le)(e[t])&&(r=e[t]);return(0,o.le)(r)?i:r},hasNext:function(){return!!l},getNext:function(){return l},setNext:function(n){l=n},iterate:function(n){var e;for(;e=s._next();){var t=e[i.TO]();t&&n(t)}},onComplete:function(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];n&&f[i.MW]({func:n,self:(0,o.o8)(e)?s.ctx:e,args:t})}}};function d(n,t,i){var r;if(void 0===t&&(t={}),void 0===i&&(i=0),e){var u=e[a.Zh];u&&n&&(r=u[n])}if(r){if((0,o.Kn)(t)&&0!==i){var c=(0,o.mm)(!0,t,r);e&&2===i&&(0,o.rW)(t,(function(n){if((0,o.le)(c[n])){var t=e[n];(0,o.le)(t)||(c[n]=t)}})),r=c}}else r=t;return r}return s}function v(n,e,t,r){var u=d(n,e,t,r),c=u.ctx;return c[i.uL]=function(n){var e=u._next();return e&&e[a.hL](n,c),!e},c[i.zV]=function(n,r){return void 0===n&&(n=null),(0,o.kJ)(n)&&(n=y(n,e,t,r)),v(n||c[i.W2](),e,t,r)},c}function h(n,e,t){var r=e[i.TC]||{},u=d(n,r,e,t),a=u.ctx;return a[i.uL]=function(n){var e=u._next();return e&&e.unload(a,n),!e},a[i.zV]=function(n,t){return void 0===n&&(n=null),(0,o.kJ)(n)&&(n=y(n,r,e,t)),h(n||a[i.W2](),e,t)},a}function p(n,e,t){var r=e[i.TC]||{},u=d(n,r,e,t).ctx;return u[i.uL]=function(n){return u.iterate((function(e){(0,o.mf)(e[i.Tu])&&e[i.Tu](u,n)}))},u[i.zV]=function(n,t){return void 0===n&&(n=null),(0,o.kJ)(n)&&(n=y(n,r,e,t)),p(n||u[i.W2](),e,t)},u}function y(n,e,t,d){var h=null,p=!d;if((0,o.kJ)(n)&&n[i.R5]>0){var g=null;(0,o.tO)(n,(function(n){if(p||d!==n||(p=!0),p&&n&&(0,o.mf)(n[a.hL])){var y=function(n,e,t){var d,h=null,p=(0,o.mf)(n[a.hL]),y=(0,o.mf)(n[i.Jd]);d=n?n[i.pZ]+"-"+n[a.yi]+"-"+s++:"Unknown-0-"+s++;var g={getPlugin:function(){return n},getNext:function(){return h},processTelemetry:_,unload:C,update:T,_id:d,_setNext:function(n){h=n}};function m(){var i;return n&&(0,o.mf)(n._getTelCtx)&&(i=n._getTelCtx()),i||(i=v(g,e,t)),i}function b(e,t,o,l,s){var v=!1,p=n?n[i.pZ]:f,y=e._hasRun;return y||(y=e._hasRun={}),e.setNext(h),n&&(0,c.Lm)(e[a.oV](),(function(){return p+":"+o}),(function(){y[d]=!0;try{var n=h?h._id:a.qS;n&&(y[n]=!1),v=t(e)}catch(n){var c=!h||y[h._id];c&&(v=!0),h&&c||(0,r.kP)(e[i.mc](),1,73,"Plugin ["+p+"] failed during "+o+" - "+(0,u.eU)(n)+", run flags: "+(0,u.eU)(y))}}),l,s),v}function _(e,t){function r(t){if(!n||!p)return!1;var r=(0,l.OY)(n);return!r[i.fi]&&!r[a.mE]&&(y&&n[i.Jd](h),n[a.hL](e,t),!0)}b(t=t||m(),r,"processTelemetry",(function(){return{item:e}}),!e.sync)||t[i.uL](e)}function C(e,t){function r(){var r=!1;if(n){var u=(0,l.OY)(n),o=n[a.oV]||u[a.oV];!n||o&&o!==e.core()||u[i.fi]||(u[a.oV]=null,u[i.fi]=!0,u[i.yl]=!1,n[i.fi]&&!0===n[i.fi](e,t)&&(r=!0))}return r}b(e,r,"unload",(function(){}),t[i.d])||e[i.uL](t)}function T(e,t){function r(){var r=!1;if(n){var u=(0,l.OY)(n),o=n[a.oV]||u[a.oV];!n||o&&o!==e.core()||u[i.fi]||n[i.Tu]&&!0===n[i.Tu](e,t)&&(r=!0)}return r}b(e,r,"update",(function(){}),!1)||e[i.uL](t)}return(0,o.FL)(g)}(n,e,t);h||(h=y),g&&g._setNext(y),g=y}}))}return d&&!h?y([d],e,t):h}},137879:(n,e,t)=>{t.d(e,{OY:()=>l,bP:()=>f,AA:()=>s,Yn:()=>d});var i=t(740372),r=t(36102),u=t(328150),o=t(274332),a=t(679823),c=(0,r.K)("plugin");function l(n){return c.get(n,"state",{},!0)}function f(n,e){for(var t,r=[],a=null,c=n[i.W2]();c;){var f=c[i.TO]();if(f){a&&(0,u.mf)(a[i.Jd])&&(0,u.mf)(f[o.hL])&&a[i.Jd](f);((0,u.mf)(f[i.yl])?f[i.yl]():(t=l(f))[i.yl])||r[i.MW](f),a=f,c=c[i.W2]()}}(0,u.tO)(r,(function(r){var u=n[o.oV]();r[i.VL](n.getCfg(),u,e,n[i.W2]()),t=l(r),r[o.oV]||t[o.oV]||(t[o.oV]=u),t[i.yl]=!0,delete t[i.fi]}))}function s(n){return n.sort((function(n,e){var t=0;if(e){var i=(0,u.mf)(e[o.hL]);(0,u.mf)(n[o.hL])?t=i?n[o.yi]-e[o.yi]:1:i&&(t=-1)}else t=n?1:-1;return t}))}function d(n){var e={};return{getName:function(){return e[i.I]},setName:function(t){n&&n.setName(t),e[i.I]=t},getTraceId:function(){return e[i.nY]},setTraceId:function(t){n&&n.setTraceId(t),(0,a.jN)(t)&&(e[i.nY]=t)},getSpanId:function(){return e[i._d]},setSpanId:function(t){n&&n.setSpanId(t),(0,a.Lc)(t)&&(e[i._d]=t)},getTraceFlags:function(){return e[i.T0]},setTraceFlags:function(t){n&&n.setTraceFlags(t),e[i.T0]=t}}}},879983:(n,e,t)=>{t.d(e,{Y:()=>a});var i=t(740372),r=t(759958),u=t(97660),o=t(328150);function a(){var n=[];return{add:function(e){e&&n[i.MW](e)},run:function(e,t){(0,o.tO)(n,(function(n){try{n(e,t)}catch(n){(0,r.kP)(e[i.mc](),2,73,"Unexpected error calling unload handler - "+(0,u.eU)(n))}})),n=[]}}}},679823:(n,e,t)=>{t.d(e,{jN:()=>a,Lc:()=>c});var i=t(740372),r="00000000000000000000000000000000",u="0000000000000000";function o(n,e,t){return!(!n||n[i.R5]!==e||n===t)&&!!n.match(/^[\da-f]*$/)}function a(n){return o(n,32,r)}function c(n){return o(n,16,u)}}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/51104-e3d7959f7a626444.js.map