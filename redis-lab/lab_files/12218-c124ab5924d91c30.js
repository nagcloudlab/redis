"use strict";(this.webpackChunk_msteams_multi_window=this.webpackChunk_msteams_multi_window||[]).push([[12218],{603153:(e,t,i)=>{i.d(t,{S:()=>c});var n=i(122267),r=i(232410);const{OverlayThinHorizontalBar:a,PartialOverlay:o,ThinHorizontalBar:s,TitleBar:d,VerticalBar:l}=r.OQr,c=(0,n.__rest)(r.OQr,["OverlayThinHorizontalBar","PartialOverlay","ThinHorizontalBar","TitleBar","VerticalBar"])},327921:(e,t,i)=>{var n;i.d(t,{y:()=>n}),function(e){e.p720="720p",e.p1080="1080p",e.p2k="2k",e.p4k="4k",e.unkown="unkown"}(n||(n={}))},27234:(e,t,i)=>{i.d(t,{ip:()=>c,Yx:()=>p,MI:()=>u,P3:()=>m,aA:()=>h});var n=i(682770),r=i(601542),a=i(578790),o=i(784850),s=i(61984),d=i(804261);const l="heartbeat";class c{constructor(){this.initialized=!1,this.eventDecoratorCallbacks=[],this.flush=()=>this.telemetryProvider.flush(),this.telemetryProvider=(0,n.G)(),(0,a.Y)((()=>{this.initialized=!1,this.eventDecoratorCallbacks=[]}))}get sessionId(){return this.telemetryProvider.sessionId}initialize(e,t){this.initialized||(this.consoleLogger=e,this.consoleLogger.debug("TelemetrySender initialized."),this._tablePostfix=t,this.initialized=!0)}static getInstance(){return this.telemetrySender||(this.telemetrySender=new c),this.telemetrySender}registerEventDecorator(e){this.eventDecoratorCallbacks.push(e)}sendTelemetry(e,t,i={},n,a,l,c=""){if(!this.initialized)return;t=t.replace(/\-/g,"_").toLowerCase();const p=`${o.x[e]}${this._tablePostfix}`.toLowerCase(),u=e===o.x.Http?i.resultCode:e===o.x.Endpoint&&i.result&&d.qb[i.result]?d.qb[i.result].toString():e===o.x.Endpoint&&i.hasInnerError?"fail":"success",m=s.H.getInstance().getSampleRate(p,null!=l?l:t,u);if(m===s.k)return;this.decorateEvent(t,i);const h=this.telemetryProvider.createEvent(p,t,i,n,a,l);h.setProperty("sampleRate",m),this.telemetryProvider.logEvent(r.hy.default,h,c)}sendScenarioEvent(e,t,i,n,a,d=""){if(!this.initialized)return;const l=e.replace(/\-/g,"_").toLowerCase(),c=`${o.x[o.x.Scenario]}${this._tablePostfix}`.toLowerCase(),p=s.H.getInstance().getSampleRate(c,l,i["Scenario.Status"]);if(p===s.k)return;this.decorateEvent(l,t);const u=Object.assign(Object.assign({},i),t),m=this.telemetryProvider.createEvent(c,e,u,n,a);m.setProperty("sampleRate",p),this.telemetryProvider.logEvent(r.hy.default,m,d)}sendHeartbeatEvent(e){if(!this.initialized)return;const t=`${o.x[o.x.Heartbeat]}${this._tablePostfix}`.toLowerCase();this.decorateEvent(l,e);const i=this.telemetryProvider.createEvent(t,l,e);this.telemetryProvider.logEvent(r.hy.default,i,void 0)}sendLoggingEvent(e,t,i,n,a,d){if(!this.initialized)return;e=e.replace(/\-/g,"_").toLowerCase();const l=`${o.x[o.x.Logging]}${this._tablePostfix}`.toLowerCase(),c=s.H.getInstance().getSampleRate(l,i,t.logLevel);if(c===s.k)return;this.decorateEvent(e,t);const p=this.telemetryProvider.createEvent(l,e,t,a,d,i);p.setProperty("sampleRate",c),this.telemetryProvider.logEvent(r.hy.default,p,n)}decorateEvent(e,t){this.eventDecoratorCallbacks.forEach((i=>i(e,t)))}}function p(e,t,i,n,r,a=""){c.getInstance().sendScenarioEvent(e,t,i,n,r,a)}function u(e,t,i,n,r,a=""){c.getInstance().sendLoggingEvent(e,t,i,a,n,r)}function m(e,t,i,n,r,a,o=""){c.getInstance().sendTelemetry(e,t,i,n,r,a,o)}function h(e){c.getInstance().sendHeartbeatEvent(e)}},66704:(e,t,i)=>{i.d(t,{K:()=>S});var n=i(122267),r=i(327921);const a=2073600,o=3686400,s=8294400;function d(e){var t,i,d;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n={Perf_Screen:void 0};let l;const c=e.screen.availWidth*(null===(t=e.screen)||void 0===t?void 0:t.availHeight);return l=c<a?r.y.p720:c>=a&&c<o?r.y.p1080:c>=o&&c<s?r.y.p2k:c>=s?r.y.p4k:r.y.unkown,n.Perf_Screen={width:null===(i=e.screen)||void 0===i?void 0:i.availWidth,height:null===(d=e.screen)||void 0===d?void 0:d.availHeight,resolution:l,dpr:e.devicePixelRatio},Promise.resolve(n)}))}var l=i(223283),c=i(155974),p=i(211728),u=i(27234),m=i(596144),h=i(141657),v=i(375422),f=i(458281);class g{constructor(e,t){this.hostCommunicationService=t,this.uuidToAppIdMap={},this.cmsObjects=[],this.logger=e.newLogger("PlatformAppsManagementService")}getTelemetry(e){return this.getPlatformAppsStats(e)}getAppsPerfMetrics(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(this.hostCommunicationService){const e=yield(0,h.K)(this.hostCommunicationService,!0);return this.getPlatformAppsStats(e)}}))}addCacheManagementService(e){var t,i;return this.cmsObjects.find((t=>t===e))?(null===(i=(t=this.logger).errorToTelemetry)||void 0===i||i.call(t,"addCacheManagementService: cms exists in appManagementService","platform_app_caching_cms_exists_in_app_management_service",void 0,!0),!1):(this.cmsObjects.push(e),!0)}removeCacheManagementService(e){return this.cmsObjects.splice(this.cmsObjects.indexOf(e),1),!0}addApp(e,t,i){var n,r;return this.uuidToAppIdMap.hasOwnProperty(e)?(null===(r=(n=this.logger).errorToTelemetry)||void 0===r||r.call(n,"addApp: App exists in appManagementService","platform_app_exists_in_app_management_service",{"App.Id":t},!0),!1):(this.uuidToAppIdMap[e]={appId:t,managedByCache:i},!0)}removeApp(e){var t,i;return this.uuidToAppIdMap[e]?(delete this.uuidToAppIdMap[e],!0):(null===(i=(t=this.logger).errorToTelemetry)||void 0===i||i.call(t,"removeApp: App is not in uuid map","platform_app_missing_in_uuid_map",void 0,!0),!1)}findMemoryByProcessId(e,t){const i=t.processes.find((t=>t.processId===e));return{workingSetSize:(null==i?void 0:i.workingSetSizeKB)||0,commitSize:(null==i?void 0:i.commitSizeKB)||0}}computeSizeOfFrames(e){const{memoryMetrics:t,processVisitedMap:i,isActiveApp:n,appsStats:r,perAppData:a,frames:o}=e;for(const s of o){const{workingSetSize:o,commitSize:d}=this.findMemoryByProcessId(s.processId,t);i[s.processId]||(i[s.processId]=s,this.addAppStatsInfo(n,o,d,r)),a.totalWorkingSetSizeKB+=o,a.totalCommitSizeKB+=d,s.platformFrameUuid&&(n?r.activeAppsCount+=1:r.cachedAppsCount+=1),a.frameInfo.push({processId:s.processId,workingSetSizeKB:o,cpuCycleTime:0}),this.computeSizeOfFrames(Object.assign(Object.assign({},e),{frames:s.frames}))}}isActiveApp(e){let t=!1;for(const i of this.cmsObjects)if(t=i.isAppActive(e),t)break;return t}getPlatformAppsStats(e){const t={activeWorkingSetSizeKB:0,cachedWorkingSetSizeKB:0,activeCommitSizeKB:0,cachedCommitSizeKB:0,activeAppsCount:0,cachedAppsCount:0,appsPlatformStats:[]},i={windows:e.windows,processVisitedMap:{},memoryMetrics:e,appsStats:t};return this.processMemoryInformation(Object.assign(Object.assign({},i),{computeActiveApps:!0})),this.processMemoryInformation(Object.assign(Object.assign({},i),{computeActiveApps:!1})),t}addAppStatsInfo(e,t,i,n){e?(n.activeWorkingSetSizeKB+=t,n.activeCommitSizeKB+=i):(n.cachedWorkingSetSizeKB+=t,n.cachedCommitSizeKB+=i)}processMemoryInformation(e){var t;const{windows:i,computeActiveApps:n,appsStats:r,memoryMetrics:a,processVisitedMap:o}=e;for(const e of i)for(const i of e.frames){if(!i.platformFrameUuid)continue;const s=this.uuidToAppIdMap[i.platformFrameUuid],d=!(null==s?void 0:s.managedByCache)||this.isActiveApp(i.platformFrameUuid);if(d===!n)continue;const l={windowId:e.windowId,isCached:!d,totalWorkingSetSizeKB:0,totalCommitSizeKB:0,maxCpuCycleTime:0,frameInfo:[],appId:null!==(t=null==s?void 0:s.appId)&&void 0!==t?t:""};this.computeSizeOfFrames({frames:[i],appsStats:r,memoryMetrics:a,perAppData:l,isActiveApp:d,processVisitedMap:o}),r.appsPlatformStats.push(l)}}}class S{constructor(e){this.context=e,this.isRunning=!1,this.timeouts={},this.granularNativeMetrics=[],this.granularWorkerMetrics=[],this.packedCallingData=new Map,this.peakWorkingSetByProcess=new Map,this.peakUsedJSHeapSize=0,this.granularJSHeapMetrics=[],this.getHeartbeatInterval=()=>{var e,t;return null!==(t=null===(e=this._configuration)||void 0===e?void 0:e.intervalInSeconds)&&void 0!==t?t:Number.MAX_SAFE_INTEGER},this.getMemorySubInterval=()=>{var e,t;return null!==(t=null===(e=this._configuration)||void 0===e?void 0:e.memoryMetricsCollection.collectionIntervalInSeconds)&&void 0!==t?t:Number.MAX_SAFE_INTEGER},this.logger=e.loggerFactory.newLogger("Heartbeat"),this.platformAppsManagementService=new g(e.loggerFactory,e.hostCommunicationService)}static getInstance(){return S.instance}get configuration(){return this._configuration}getPlatformAppsService(){return this.platformAppsManagementService}start(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){S.instance||(S.instance=this,this.logger.debug("Starting the monitor..."),this.subscribeToCoreSettings(),this.initializedTime=(new Date).getTime(),yield this.registerScenarios())}))}stop(){this.logger.debug("Stopping the monitor..."),this.stopHeartbeat(),S.instance=void 0}isHeartbeatMonitorRunning(){return this.isRunning}getMemoryData(){var e,t;return(null===(t=null===(e=this._configuration)||void 0===e?void 0:e.memoryMetricsCollection)||void 0===t?void 0:t.enabled)?this.getAverageMemoryMetrics():{}}collectData(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const e=this.getActions().map((e=>e()));return Object.assign.apply(Object,yield Promise.all(e))}))}collectCallingData(e,t){var i,n;const{enableCallingCDLTrackingNS:r}=this.context.coreSettings.get(l.J.Calling)||{};if(r){const e=JSON.parse(t),n={cdlData:null===(i=this.context.graphqlOpsCountService)||void 0===i?void 0:i.getLatestDataAndClear()},r=Object.assign(e,n);t=JSON.stringify(r)}this.packedCallingData.set(e,(null!==(n=this.packedCallingData.get(e))&&void 0!==n?n:[]).concat(t))}getActions(){var e,t,i,n,r,a,o,s,c,p,u,m,h,v,f,g,S,k,b,y,P;const C=[];(null===(t=null===(e=this._configuration)||void 0===e?void 0:e.memoryMetricsCollection)||void 0===t?void 0:t.enabled)&&C.push(this.getAverageMemoryMetrics.bind(this)),(null===(n=null===(i=this._configuration)||void 0===i?void 0:i.elapsedTimeTracking)||void 0===n?void 0:n.enabled)&&C.push(this.getElapsedTime.bind(this)),(null===(a=null===(r=this._configuration)||void 0===r?void 0:r.screenInfoCollection)||void 0===a?void 0:a.enabled)&&C.push(d.bind(this,this.context.windowProvider)),(null===(s=null===(o=this._configuration)||void 0===o?void 0:o.ariMetricsCollection)||void 0===s?void 0:s.enabled)&&C.push(this.getAriMetrics.bind(this)),(null===(p=null===(c=this._configuration)||void 0===c?void 0:c.dataClientMetricsCollection)||void 0===p?void 0:p.enabled)&&C.push(this.getDataClientMetrics.bind(this)),(null===(m=null===(u=this._configuration)||void 0===u?void 0:u.windowMetricsCollection)||void 0===m?void 0:m.enabled)&&C.push(this.getWindowMetrics.bind(this)),(null===(v=null===(h=this._configuration)||void 0===h?void 0:h.clientStateMetricsCollection)||void 0===v?void 0:v.enabled)&&C.push(this.getClientStateMetrics.bind(this)),(null===(g=null===(f=this._configuration)||void 0===f?void 0:f.OLDMetricsCollection)||void 0===g?void 0:g.enabled)&&C.push(this.getObjectLeakDetectorMetrics.bind(this));const{enableCallingDataCollectionInHeartbeatConfig:T}=(null===(S=this.context.coreSettings)||void 0===S?void 0:S.get(l.J.Calling))||{};return T&&(null===(b=null===(k=this._configuration)||void 0===k?void 0:k.callingDataCollection)||void 0===b?void 0:b.enabled)&&C.push(this.getCallingData.bind(this)),(null===(P=null===(y=this._configuration)||void 0===y?void 0:y.graphqlStoreMetricsCollection)||void 0===P?void 0:P.enabled)&&C.push(this.getGraphQLStoreMetrics.bind(this)),C}stopHeartbeat(){this.isRunning&&this.logger.debug("stopping heartbeat monitor"),Object.keys(this.timeouts).forEach((e=>{this.context.windowProvider.clearTimeout(this.timeouts[e])})),this.timeouts={},this.isRunning=!1}subscribeToCoreSettings(){this.context.coreSettings.getObservable(l.J.Telemetry).subscribe((e=>{var t,i,n;const{enableHeartbeatMonitor:r,heartbeatConfiguration:a}=e;a?(this._configuration=a,this.logger.debug("Configuration loaded...",this._configuration)):null===(i=(t=this.logger).errorToTelemetry)||void 0===i||i.call(t,"'heartbeatConfiguration' not found.","fundamentals_performance_heartbeat_monitor"),r?(this.startHeartbeat(),(null===(n=this._configuration)||void 0===n?void 0:n.memoryMetricsCollection.enabled)||(this.context.windowProvider.clearTimeout(this.timeouts.memory),this.timeouts.memory=void 0)):this.stopHeartbeat()}))}startHeartbeat(){!this.isRunning&&this.logger.debug("starting heartbeat monitor"),this.scheduleNextTimeout("heartbeat",this.isRunning?this.getHeartbeatInterval():Math.min(30,this.getHeartbeatInterval()),this.beat.bind(this),this.getHeartbeatInterval),this.scheduleNextTimeout("memory",this.isRunning?this.getMemorySubInterval():Math.min(25,this.getMemorySubInterval()),this.collectGranularMemoryAndJSHeapData.bind(this),this.getMemorySubInterval),this.isRunning=!0}scheduleNextTimeout(e,t=Number.MAX_SAFE_INTEGER,i,r){var a;const o=t*c.B.second;0<o&&o<2147483647&&(this.timeouts[e]=null!==(a=this.timeouts[e])&&void 0!==a?a:this.context.windowProvider.setTimeout((()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){var t,n;this.timeouts[e]=void 0;try{yield i()}catch(e){null===(n=(t=this.logger).errorToTelemetry)||void 0===n||n.call(t,`call to function '${i}' failed in heartbeat monitor.`,"fundamentals_performance_heartbeat_monitor")}finally{this.scheduleNextTimeout(e,r(),i,r)}}))),o))}beat(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.collectData();(0,u.aA)(e)}))}getElapsedTime(){const e=(new Date).getTime(),t=this.initializedTime||e;return{elapsed:Math.floor((e-t)/c.B.second)}}getAverageMemoryMetrics(){const e=[];if(this.granularNativeMetrics.length){const t=new Map(this.peakWorkingSetByProcess.entries());this.peakWorkingSetByProcess.clear(),this.granularNativeMetrics.reduce(((e,t)=>{var i;for(const n of t){const{processId:t}=n;e.set(t,(null!==(i=e.get(t))&&void 0!==i?i:[]).concat(n))}return e}),new Map).forEach(((i,n)=>{var r;this.peakWorkingSetByProcess.set(n,null!==(r=t.get(n))&&void 0!==r?r:0);const a=(0,f.meanBy)(i,(e=>e.workingSetSizeKB)),o=(0,f.meanBy)(i,(e=>e.commitSizeKB)),s={processId:n,name:i[0].name,type:i[0].type,utilitySubType:i[0].utilitySubType,embeddedBrowserWebView:i[0].embeddedBrowserWebView,cpuCycleTime:i[0].cpuCycleTime,workingSetSizeKB:isNaN(a)?void 0:Math.round(a),commitSizeKB:isNaN(o)?void 0:Math.round(o)};e.push(s)}))}const t=[];this.granularWorkerMetrics.length&&this.granularWorkerMetrics.reduce(((e,t)=>{var i;for(const n of t){const{targetSessionId:t}=n;e.set(t,(null!==(i=e.get(t))&&void 0!==i?i:[]).concat(n))}return e}),new Map).forEach(((e,i)=>{const n=(0,f.meanBy)(e,(e=>e.totalSizeKB)),r=(0,f.meanBy)(e,(e=>e.usedSizeKB)),a={targetSessionId:i,type:e[0].type,subType:e[0].subType,totalSizeKB:isNaN(n)?void 0:Math.round(n),usedSizeKB:isNaN(r)?void 0:Math.round(r)};t.push(a)}));const i=(0,m.Mv)(e,this.peakWorkingSetByProcess,this.mainRendererProcessId),n=(0,m.tC)(t);let r={};if(this.granularJSHeapMetrics.length){const e={jsHeapSizeLimit:Math.round((0,f.meanBy)(this.granularJSHeapMetrics,(e=>e.jsHeapSizeLimit||0))),totalJSHeapSize:Math.round((0,f.meanBy)(this.granularJSHeapMetrics,(e=>e.totalJSHeapSize||0))),usedJSHeapSize:Math.round((0,f.meanBy)(this.granularJSHeapMetrics,(e=>e.usedJSHeapSize||0)))};r=(0,m.RQ)(e,this.peakUsedJSHeapSize)}return Object.assign(Object.assign(Object.assign({},i),n),r)}getAriMetrics(){const e={Perf_Ari:""};if(this.context.appResponsivenessService){const t=this.context.appResponsivenessService.getTelemetry();e.Perf_Ari=t}return e}getDataClientMetrics(){const e={Perf_ApolloCacheStats:void 0};if(this.context.dataClientTrackingService){const t=this.context.dataClientTrackingService.getTelemetry();e.Perf_ApolloCacheStats=t}return e}getWindowMetrics(){const e={Perf_WindowStats:void 0};if(this.context.windowTrackerService){const t=this.context.windowTrackerService.getTelemetry();e.Perf_WindowStats=t}return e}getObjectLeakDetectorMetrics(){const e={};return this.context.leakDetectorService&&(e.Perf_OLDStats=this.context.leakDetectorService.getTelemetry()),e}getClientStateMetrics(){const e={Perf_IsUserInCall:void 0};if(this.context.clientState){const t=this.context.clientState.getState()===p.pk.VeryActive;e.Perf_IsUserInCall=t}return e}getCallingData(){const e={Perf_Calling_Data:void 0};return this.packedCallingData.forEach((t=>{e.Perf_Calling_Data?e.Perf_Calling_Data.push(...t):e.Perf_Calling_Data=t})),this.packedCallingData.clear(),e}getGraphQLStoreMetrics(){const e={};return this.context.graphqlStoreStatsReporterService&&(e.Perf_GraphQLStoreStats=this.context.graphqlStoreStatsReporterService.getTelemetry()),e}collectGranularMemoryAndJSHeapData(){var e,t,i;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=Math.max(Math.floor(this.getHeartbeatInterval()/this.getMemorySubInterval()),1)||1;if(this.context.hostCommunicationService){const r=yield(0,h.K)(this.context.hostCommunicationService,(null===(t=null===(e=this._configuration)||void 0===e?void 0:e.workerMetricsCollection)||void 0===t?void 0:t.enabled)||!1);this.granularNativeMetrics=this.granularNativeMetrics.concat([r.processes]).slice(-n),this.granularWorkerMetrics=this.granularWorkerMetrics.concat([r.workers]).slice(-n);const a=[];for(const e of r.processes){const{processId:t,type:i}=e,n=this.peakWorkingSetByProcess.get(t);this.peakWorkingSetByProcess.set(t,Math.max(n||0,e.workingSetSizeKB||0)),"renderer"===i.toLowerCase()&&a.push(e)}this.mainRendererProcessId=this.mainRendererProcessId&&a.find((e=>e.processId===this.mainRendererProcessId))?this.mainRendererProcessId:null===(i=a.sort(((e,t)=>{var i,n;return(null!==(i=t.workingSetSizeKB)&&void 0!==i?i:0)-(null!==(n=e.workingSetSizeKB)&&void 0!==n?n:0)}))[0])||void 0===i?void 0:i.processId}else this.logger.error("Invalid hostCommunicationService, cannot get metrics from Desktop");if(this.context.windowProvider){const e=(0,v.P)(this.context.windowProvider);this.peakUsedJSHeapSize=Math.max(this.peakUsedJSHeapSize,e.usedJSHeapSize||0),this.granularJSHeapMetrics=this.granularJSHeapMetrics.concat(e).slice(-n)}}))}registerScenarios(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(this.context.hostCommunicationService){const e=yield this.context.hostCommunicationService.loadModule("heartbeat");if(null==e?void 0:e.registerForScenarioStart)try{e.registerForScenarioStart((e=>{}))}catch(e){this.logger.error("Failed to register for listening to host scenarios starting")}if(null==e?void 0:e.registerForScenarioStop)try{e.registerForScenarioStop((e=>{}))}catch(e){this.logger.error("Failed to register for listening to host scenarios stopping")}}}))}}S.instance=void 0},626733:(e,t,i)=>{i.d(t,{E:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformAppButtonQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appButtonResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"action"}}]}}]}}]}},392971:(e,t,i)=>{i.d(t,{i:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformBackButtonHandlerStateQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"backButtonHandlerState"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"registered"}}]}}]}}]}},454529:(e,t,i)=>{i.d(t,{L:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformChangeSettingsQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"changeSettingsResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"tabId"}}]}}]}}]}},567912:(e,t,i)=>{i.d(t,{N:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformChangeSettingsTriggerQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"changeSettingsTriggerResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"tabId"}},{kind:"Field",name:{kind:"Name",value:"message"}}]}}]}}]}},376484:(e,t,i)=>{i.d(t,{O:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformLocalFrameContextQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"localFrameContext"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"threadId"}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"tabId"}},{kind:"Field",name:{kind:"Name",value:"websiteUrl"}},{kind:"Field",name:{kind:"Name",value:"contentUrl"}}]}}]}}]}},273980:(e,t,i)=>{i.d(t,{i:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mapCoordinateResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mapCoordinateResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"latitude"}},{kind:"Field",name:{kind:"Name",value:"longitude"}},{kind:"Field",name:{kind:"Name",value:"locationApiError"}}]}}]}}]}},173837:(e,t,i)=>{i.d(t,{n:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"messageToChildResult"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"messageToChildResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"message"}}]}}]}}]}},242213:(e,t,i)=>{i.d(t,{y:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"messageToParentResult"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"messageToParentResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"message"}}]}}]}}]}},23517:(e,t,i)=>{i.d(t,{a:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"selectMediaResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"selectMediaResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"selectMediaError"}},{kind:"Field",name:{kind:"Name",value:"mediaUrls"}}]}}]}}]}},998945:(e,t,i)=>{i.d(t,{k:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"selectPeoplePickerResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"selectPeoplePickerResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"email"}}]}}]}}]}},494788:(e,t,i)=>{i.d(t,{F:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"showLocationResponse"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showLocationResponse"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},683979:(e,t,i)=>{i.d(t,{sR:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"taskModuleResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"taskModuleResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"card"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appIcon"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"appName"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"contentType"}},{kind:"Field",name:{kind:"Name",value:"locale"}}]}},{kind:"Field",name:{kind:"Name",value:"adaptiveCardTabResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appIcon"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"appName"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"contentType"}},{kind:"Field",name:{kind:"Name",value:"locale"}}]}},{kind:"Field",name:{kind:"Name",value:"text"}},{kind:"Field",name:{kind:"Name",value:"taskModuleId"}},{kind:"Field",name:{kind:"Name",value:"draftId"}},{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"reason"}},{kind:"Field",name:{kind:"Name",value:"entryPoint"}}]}}]}}]}},36357:(e,t,i)=>{i.d(t,{R:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"viewImagesResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"viewImagesResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"viewImagesError"}},{kind:"Field",name:{kind:"Name",value:"errorCode"}}]}}]}}]}},703192:(e,t,i)=>{if(i.d(t,{w:()=>l,K:()=>c,su:()=>p}),40179==i.j)var n=i(323751);var r=i(25010),a=i(223283),o=i(545227);const s=e=>e&&e.startsWith(r.V.Bot),d=e=>s(e)?e.slice(3):e.slice(e.includes("_")?41:8),l=(e,t)=>{let i=[];return i=s(e)&&!s(t)?[d(t),d(e)]:!s(e)&&s(t)?[d(e),d(t)]:[d(e),d(t)].sort(),`19:${i[0]}_${i[1]}@unq.gbl.spaces`};function c(){const[e,t]=(0,n.M)(2);return`${e}${t}`.substr(0,19)}function p(e){const{ageGroup:t}=e.get(a.J.AgeConsent);return t===o.zH.MinorWithMsaParentalConsent||t===o.zH.MinorWithoutMsaParentalConsent}},789450:(e,t,i)=>{i.d(t,{kn:()=>n,uS:()=>r,U3:()=>a});const n="Layout",r={closeMonitor:"closeMonitor",collapseHeader:"collapseHeader",completeAppPhaseReached:"completeAppPhaseReached",criticalAppPhaseReached:"criticalAppPhaseReached",expandHeader:"expandHeader",expandTab:"expandTab",hideMonitor:"hideMonitor",maximizeTab:"maximizeTab",postCriticalAppPhaseReached:"postCriticalAppPhaseReached",reset:"reset",resetLayoutOverrides:"resetLayoutOverrides",resizeSlot:"resizeSlot",showMonitor:"showMonitor",unhideMonitor:"unhideMonitor",updateAmsV2Domain:"updateAmsV2Domain",updateBaseImageUrl:"updateBaseImageUrl",updateIsImageAuthCookieValid:"updateIsImageAuthCookieValid"},a={collapseHeader:()=>({originator:n,type:r.collapseHeader}),completeAppPhaseReached:()=>({originator:n,type:r.completeAppPhaseReached}),criticalAppPhaseReached:()=>({originator:n,type:r.criticalAppPhaseReached}),expandHeader:()=>({originator:n,type:r.expandHeader}),expandTab:e=>({originator:n,type:r.expandTab,data:e}),maximizeTab:()=>({originator:n,type:r.maximizeTab}),postCriticalAppPhaseReached:()=>({originator:n,type:r.postCriticalAppPhaseReached}),resetLayoutOverrides:()=>({originator:n,type:r.resetLayoutOverrides}),resizeSlot:e=>({originator:n,type:r.resizeSlot,data:e}),updateAmsV2Domain:e=>({data:e,originator:n,type:r.updateAmsV2Domain}),updateBaseImageUrl:e=>({data:e,originator:n,type:r.updateBaseImageUrl}),updateIsImageAuthCookieValid:e=>({data:e,originator:n,type:r.updateIsImageAuthCookieValid}),closeMonitor:()=>({originator:n,type:r.closeMonitor}),hideMonitor:()=>({originator:n,type:r.hideMonitor}),showMonitor:e=>({originator:n,type:r.showMonitor,data:()=>Object.assign({},e)}),unhideMonitor:()=>({originator:n,type:r.unhideMonitor})}},292256:(e,t,i)=>{var n,r,a,o,s,d,l,c,p,u,m,h,v,f,g,S,k,b,y,P,C,T,I,_;i.d(t,{qi:()=>n,OM:()=>r,Pw:()=>a,aZ:()=>o,Aj:()=>s,jD:()=>d,BU:()=>l,YV:()=>c,Ye:()=>p,Uh:()=>u,Z9:()=>m,o1:()=>P,g7:()=>C,Hd:()=>T,_W:()=>I,n$:()=>_}),function(e){e.Team="Team",e.Personal="Personal",e.GroupChat="GroupChat"}(n||(n={})),function(e){e.Team="Team",e.Personal="Personal",e.GroupChat="GroupChat",e.Channel="Channel"}(r||(r={})),function(e){e.Tab="Tab",e.Bot="Bot",e.Messaging="Messaging",e.Connector="Connector"}(a||(a={})),function(e){e.Added="Added",e.Removed="Removed",e.Updated="Updated",e.Synced="Synced"}(o||(o={})),function(e){e.Unknown="Unknown",e.SidePanel="SidePanel",e.Stage="Stage"}(s||(s={})),function(e){e.Unknown="Unknown",e.PersonalTab="PersonalTab",e.ChannelTab="ChannelTab",e.PrivateChatTab="PrivateChatTab",e.MeetingChatTab="MeetingChatTab",e.MeetingDetailsTab="MeetingDetailsTab",e.MeetingSidePanel="MeetingSidePanel",e.MeetingStage="MeetingStage",e.CallingSidePanel="CallingSidePanel"}(d||(d={})),function(e){e.Unknown="Unknown",e.PersonalTab="PersonalTab",e.ChannelTab="ChannelTab",e.PrivateChatTab="PrivateChatTab",e.MeetingChatTab="MeetingChatTab",e.MeetingDetailsTab="MeetingDetailsTab",e.MeetingSidePanel="MeetingSidePanel",e.MeetingStage="MeetingStage",e.TeamLevelApp="TeamLevelApp"}(l||(l={})),function(e){e.Application="Application",e.Delegated="Delegated"}(c||(c={})),function(e){e.MRU="MRU",e.AlphabeticalAsc="AlphabeticalAsc",e.AlphabeticalDesc="AlphabeticalDesc"}(p||(p={})),function(e){e.NewUpload="NewUpload",e.Update="Update",e.Upgrade="Upgrade"}(u||(u={})),function(e){e.Unknown="Unknown",e.PrivateChannel="PrivateChannel"}(m||(m={})),function(e){e.Mail="mail"}(h||(h={})),function(e){e.Desktop="desktop",e.Mobile="mobile"}(v||(v={})),function(e){e.General="general"}(f||(f={})),function(e){e.Short="short",e.Long="long"}(g||(g={})),function(e){e.MailRead="mailRead",e.MailCompose="mailCompose",e.MeetingDetailsOrganizer="meetingDetailsOrganizer",e.MeetingDetailsAttendee="meetingDetailsAttendee"}(S||(S={})),function(e){e.After="after",e.Before="before"}(k||(k={})),function(e){e.Button="button",e.Menu="menu"}(b||(b={})),function(e){e.PromptUser="promptUser",e.SoftBlock="softBlock",e.Block="block"}(y||(y={})),function(e){e.Personal="Personal",e.Team="Team",e.GroupChat="GroupChat",e.Meetings="Meetings"}(P||(P={})),function(e){e.Tab="Tab",e.Bot="Bot",e.Connector="Connector"}(C||(C={})),function(e){e.Unknown="Unknown",e.OfficeAddIn="OfficeAddIn",e.OfficeAddIns="OfficeAddIns",e.ExchangeAddIn="ExchangeAddIn",e.ExchangeAddIns="ExchangeAddIns",e.LineOfBusiness="LineOfBusiness",e.Bot="Bot",e.Bots="Bots",e.MessageExtension="MessageExtension",e.ComposeExtensions="ComposeExtensions",e.Extension="Extension",e.Extensions="Extensions",e.FirstPartyPages="FirstPartyPages",e.Dynamics="Dynamics",e.AAD="AAD",e.LaunchPage="LaunchPage",e.StaticTabs="StaticTabs",e.GraphConnector="GraphConnector",e.ConfigurableTabs="ConfigurableTabs",e.Connector="Connector",e.Connectors="Connectors",e.Activity="Activity",e.Activities="Activities",e.MeetingExtension="MeetingExtension",e.MeetingExtensionDefinition="MeetingExtensionDefinition"}(T||(T={})),function(e){e.MessageReadCommandSurface="MessageReadCommandSurface",e.MessageComposeCommandSurface="MessageComposeCommandSurface",e.AppointmentOrganizerCommandSurface="AppointmentOrganizerCommandSurface",e.AppointmentAttendeeCommandSurface="AppointmentAttendeeCommandSurface"}(I||(I={})),function(e){e.GET="GET",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(_||(_={}))},541960:(e,t,i)=>{i.d(t,{dP:()=>n,qN:()=>r,iv:()=>a,vO:()=>s,VS:()=>c,f1:()=>p,b:()=>u});var n,r,a,o,s,d,l=i(217135);!function(e){e.ScheduledDraft="ScheduledDraft"}(n||(n={})),function(e){e[e.Sync=1]="Sync",e[e.LongPoll=2]="LongPoll",e[e.SfB=3]="SfB",e[e.SyncRelated=4]="SyncRelated",e[e.Local=5]="Local",e[e.CSAReplyChain=6]="CSAReplyChain",e[e.DeltaSync=7]="DeltaSync",e[e.SyncOnDemandFromLongpoll=8]="SyncOnDemandFromLongpoll",e[e.AdHocPropertyUpdate=9]="AdHocPropertyUpdate"}(r||(r={})),function(e){e[e.Sending=0]="Sending",e[e.Delivered=1]="Delivered",e[e.Received=2]="Received",e[e.Error=3]="Error",e[e.Deleted=4]="Deleted"}(a||(a={})),function(e){e[e.Muted=0]="Muted",e[e.Simple=1]="Simple",e[e.Important=2]="Important",e[e.Mentioned=3]="Mentioned"}(o||(o={})),function(e){e[e.StartupSyncClean=1]="StartupSyncClean",e[e.StartupSyncUpdate=2]="StartupSyncUpdate",e[e.ThreadDetailsSync=3]="ThreadDetailsSync",e[e.LongPoll=4]="LongPoll",e[e.ResolverPutConversation=5]="ResolverPutConversation",e[e.LocalUpdate=6]="LocalUpdate",e[e.PutConversationLie=7]="PutConversationLie",e[e.AddUsersToConversation=8]="AddUsersToConversation",e[e.ConversationFetchJob=9]="ConversationFetchJob",e[e.GroupChatsStartupJob=10]="GroupChatsStartupJob",e[e.OneToOneChatFetchJob=11]="OneToOneChatFetchJob",e[e.NonRecentChatsStartupJob=12]="NonRecentChatsStartupJob",e[e.NonRecentChatsStartupRetryJob=13]="NonRecentChatsStartupRetryJob"}(s||(s={}));class c{}c.NotificationConversationId=`${l.at.PrivateFeed}notifications`,c.StarredConversationId=`${l.at.PrivateFeed}starred`,c.CallLogConversationId=`${l.at.PrivateFeed}calllogs`,c.AnnotationsConversationId=`${l.at.PrivateFeed}annotations`,function(e){e[e.Message=0]="Message"}(d||(d={}));const p="x-ms-request-priority";var u;!function(e){e[e.RealTimeSync=0]="RealTimeSync",e[e.ForegroundSync=10]="ForegroundSync",e[e.BackgroundSync=20]="BackgroundSync"}(u||(u={}))},15101:(e,t,i)=>{i.d(t,{wT:()=>m,GS:()=>h,c_:()=>v,B8:()=>S,_2:()=>k,LQ:()=>b,Jn:()=>y,Iy:()=>P,Bu:()=>C,vJ:()=>T,re:()=>I,mO:()=>_,dk:()=>w,io:()=>M,x:()=>N,X5:()=>x,$n:()=>A,_T:()=>D,MQ:()=>L,Xc:()=>E,DA:()=>F,gw:()=>O,lj:()=>R,oy:()=>B,lF:()=>U});var n=i(223283),r=i(217135),a=i(351171),o=i(458281),s=i(541960),d=i(50604),l=i(232410),c=i(207629),p=i(373661),u=i(506796);const m=({isActionToAccept:e,isUserBlocked:t,isInQuarantine:i,quarantineCounter:a,creator:o,currentUserMri:s},d)=>{let l=r.uI.Accepted;if(e){if(t){const e=o===s,{maxInviteFreeQuarantineCounter:t}=d.get(n.J.People),c=a>=(t||0);i&&!e?l=r.uI.AcceptPending:e&&c&&(l=r.uI.Quarantined)}}else l=r.uI.Blocked;return l},h=(e,t)=>v(e.id,t)&&k(e,t),v=(e,t)=>{if(!g(e))return!1;const{overrideThreadTypeForPrivateFeeds:i}=t.get(n.J.Sync);return!(0,d.dV)(e)||!i},f=/^\d+[:]{1}.+/,g=e=>!(0,o.isUndefined)(e)&&e!==r.kK&&e!==r.Ov&&!e.includes(r.YP)&&f.test(e),S=e=>e.startsWith(r.IK)?"MRI conv id":e,k=(e,t)=>!(b(e)&&!function(e){const{msgEnableSfbCloudFromBVD:t}=e.get(n.J.Messaging),{isSfbCloud:i,isSipEnabled:r,isSfbCloudInBVD:a,isSipEnabledInBVD:o}=e.get(n.J.UserResources);return!!(t?o&&a:r&&i)}(t));function b(e){return((0,o.isString)(e)?e:e.id).endsWith(r.GQ)}const y=e=>!!e&&b(e),P=e=>{var t;const i=null===(t=e.memberProperties)||void 0===t?void 0:t[r.e0.RelationshipState];return!!(null==i?void 0:i.edRedemptionRequired)},C=e=>{var t;const i=null===(t=e.memberProperties)||void 0===t?void 0:t[r.e0.RelationshipState];return!!(null==i?void 0:i.blockTime)};const T=e=>{var t;return!!(null===(t=e.memberProperties)||void 0===t?void 0:t[r.e0.IsModerator])},I=e=>e.threadProperties&&!!e.threadProperties[r.Q5.ParentSpaces],_=e=>e.threadProperties&&e.threadProperties[r.Q5.ThreadType]===a.T.Team&&I(e),w=e=>{var t,i;if(e.threadProperties&&(null===(t=e.threadProperties)||void 0===t?void 0:t[r.Q5.ParentSpaces]))try{const t=JSON.parse(null===(i=e.threadProperties)||void 0===i?void 0:i[r.Q5.ParentSpaces]);return t&&t.linkedSpaceInfoItems&&t.linkedSpaceInfoItems[0]&&t.linkedSpaceInfoItems[0].spaceThreadId&&t.linkedSpaceInfoItems[0].spaceThreadId.length>0}catch(e){return!1}return!1},M=e=>{if(e.threadProperties)try{const t=e.threadProperties.meeting,i=t?JSON.parse(t):void 0;return i?i.meetingType:void 0}catch(e){return}},N=e=>x(e.type),x=e=>!!e&&e.toLowerCase&&e.toLowerCase()===r.i1.Meeting.toLowerCase(),A=e=>{let t;if(N(e)&&e.threadProperties.meeting)try{const i=JSON.parse(e.threadProperties.meeting);i.subject&&(t=i.subject)}catch(e){return t}return t},D=e=>e===r.Cs.Text||e===r.Cs.RichText||e===r.Cs.HTML,L=e=>{var t;return!!(null===(t=e.members)||void 0===t?void 0:t.some((e=>(0,d.Nl)(e.id))))},E=e=>{var t;return e.id===s.VS.CallLogConversationId||(0,d.u5)(null===(t=null==e?void 0:e.threadProperties)||void 0===t?void 0:t.threadType)},F=e=>{const t=p.I*c.kg*p.s;if(!e||isNaN(e))return!0;return e-Date.now()<t},O=e=>(null==e?void 0:e.threadProperties)&&((null==e?void 0:e.threadProperties[r.Q5.ThreadType])===a.T.Community||(null==e?void 0:e.threadProperties[r.Q5.SpaceType])===r.Q5.SpaceType_Community),R=e=>e.threadProperties&&e.threadProperties[r.Q5.SubstrateGroupId]||"",B=e=>{var t,i;const n=null===(i=null===(t=e.threadProperties)||void 0===t?void 0:t[r.Q5.ThreadSubType])||void 0===i?void 0:i.toLowerCase();return n||u.YF.Unknown},U=e=>{const t=e.threadProperties&&e.threadProperties[r.Q5.ThreadType];return z(t)},z=e=>{if(e)return"space"===e||"topic"===e?l.k2e.Channel:"meeting"===e?l.k2e.Meeting:l.k2e.None}},810455:(e,t,i)=>{i.d(t,{MJ:()=>u,K6:()=>m,Du:()=>h,ut:()=>v,uY:()=>f,pl:()=>g,ky:()=>S,Fz:()=>k,zb:()=>b,s6:()=>y,rt:()=>P,xb:()=>C,eb:()=>T,HU:()=>I,X3:()=>_,Dq:()=>M,iX:()=>N,S5:()=>x,$V:()=>A,JJ:()=>D,J6:()=>L,sL:()=>E,pi:()=>F,Cd:()=>O,hk:()=>R,rj:()=>B,Fv:()=>U,hu:()=>z,dO:()=>W,BL:()=>H,jo:()=>j,nZ:()=>Q,iE:()=>J,hP:()=>$,qo:()=>V,CB:()=>K,au:()=>G,ZY:()=>q,T7:()=>X,Xg:()=>Y,YP:()=>Z,Zg:()=>ee,j8:()=>ie,dG:()=>oe,Lg:()=>se,Su:()=>de,rP:()=>le,As:()=>ce,nL:()=>pe,Bl:()=>ue,mB:()=>me,Eu:()=>he,hC:()=>ve,DZ:()=>fe,me:()=>ge,BU:()=>Se,Ii:()=>ke,$c:()=>be,tl:()=>ye,Ts:()=>Pe,wU:()=>Ce,jM:()=>_e,Il:()=>we,Fx:()=>Me,Ki:()=>Ne,rf:()=>xe,cu:()=>Ae,ln:()=>De,iK:()=>Le,y5:()=>Ee});var n=i(541960),r=i(458281),a=i(223283),o=i(50604),s=i(217135),d=i(351171),l=i(506796),c=i(15101),p=i(216173);var u;!function(e){e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.TWO=2]="TWO"}(u||(u={}));const m=e=>{const t=T(e);return(0,c.LQ)(e)?t:t||(0,c.Jn)(e)},h=e=>{var t;return(null===(t=e.threadProperties)||void 0===t?void 0:t[s.Q5.Creator])||null},v=e=>e.threadProperties&&e.threadProperties[s.Q5.CreatedAt]?e.threadProperties[s.Q5.CreatedAt]:null,f=e=>{if(!e)throw new Error("Invalid conversation passed to isDeleted()");if(!e.threadProperties)return!1;const t=e.threadProperties.isDeleted||e.threadProperties[s.Q5.IsDeleted];return!!t&&("boolean"==typeof t?t:"function"==typeof t.toLowerCase&&"true"===t.toLowerCase())},g=e=>{if(!e)throw new Error("Invalid conversation passed to isConversationDeleted()");if(!e.properties)return!1;const t=e.properties.isDeleted||e.properties[s.Ff.isDeleted];return!!t&&("boolean"==typeof t?t:"function"==typeof t.toLowerCase&&"true"===t.toLowerCase())},S=(e,t)=>{if(!e)throw new Error("Invalid conversation passed to shouldConversationDeletedByDeleteChat()");const i=W(e,t);return 0!==i&&(!(0,r.isNil)(e.lastMessageTimeUtc)&&i>=e.lastMessageTimeUtc)},k=e=>{var t;return!(!e.properties||!e.properties[s.Ff.Followed])&&"true"===(null===(t=e.properties[s.Ff.Followed])||void 0===t?void 0:t.toLowerCase())},b=e=>{var t;return!(!e.properties||!e.properties[s.Ff.Collapsed])&&"true"===(null===(t=e.properties[s.Ff.Collapsed])||void 0===t?void 0:t.toLowerCase())},y=e=>-1===e.detailsVersion?-1===e.threadVersion:0===e.threadVersion,P=e=>y(e)||!$(e);function C(e){return e.includes(s.YP)||e===s.kK}const T=e=>{var t;return(0,o.Q5)(e.id,null===(t=null==e?void 0:e.threadProperties)||void 0===t?void 0:t.threadType)&&C(e.id)},I=e=>e.threadProperties&&(e.threadProperties[s.Q5.ThreadType]===d.T.Team||e.threadProperties[s.Q5.ThreadType]===d.T.Community)&&!(0,c.re)(e),_=e=>F(e)?ge(e)||"":X(e)||"";function w(e){return!!e.threadProperties&&e.threadProperties[s.Q5.ThreadType]===d.T.Team}const M=e=>{var t;if(e.properties){if(e.properties[s.Ff.Favorite])return"true"===(null===(t=e.properties[s.Ff.Favorite])||void 0===t?void 0:t.toLowerCase());if(w(e))return!0}return!1},N=(e,t=!1)=>x(e.type,t),x=(e,t=!1)=>!(0,r.isNil)(e)&&(e.toLowerCase()===s.i1.Chat.toLowerCase()||e.toLowerCase()===s.i1.PhoneChat.toLowerCase()||e.toLowerCase()===s.i1.OneOnOne.toLowerCase()||e.toLowerCase()===s.i1.StreamOfNotes.toLowerCase()||!t&&(0,c.X5)(e)),A=e=>{var t;return e.id===n.VS.NotificationConversationId||(0,o.j6)(null===(t=null==e?void 0:e.threadProperties)||void 0===t?void 0:t.threadType)},D=e=>e===n.VS.AnnotationsConversationId,L=e=>e.type===s.i1.Team||e.type===s.i1.Topic,E=e=>V(e)===l.xu.Shared,F=e=>(0,c.mO)(e)&&(0,c.dk)(e)&&V(e)===l.xu.Private,O=e=>I(e)&&!!e.memberProperties&&!!e.memberProperties[s.e0.ChannelOnlyMember],R=e=>{if(!(0,c.x)(e))return!1;const t=(0,c.io)(e);return!!t&&t===s.wJ.Adhoc},B=e=>{if(!(0,c.x)(e))return!1;const t=(0,c.io)(e);return!!t&&t===s.wJ.Scheduled},U=(e,t)=>e.from.substring(e.from.indexOf("/")+1)===(-1===t.indexOf(s.rK)?s.rK+t:t),z=(e,t)=>{if(!e.threadProperties)return 0;const{enableRetentionHorizonBasedPruning:i}=t.get(a.J.Sync),n=i||E(e)?e.threadProperties.retentionHorizonV2:0;return n&&isFinite(Number(n))?Number(n):0},W=(e,t)=>{if(!e.properties)return 0;if(g(e))return e.lastMessageTimeUtc?e.lastMessageTimeUtc+1:864e13;const i=(!t||!!t.get(a.J.Messaging).enableDeleteChat)&&N(e)?e.properties.clearHistoryTime:0;return i&&isFinite(Number(i))?Number(i):0},H=e=>!!e.mruEvictedTime&&e.mruEvictedTime>0,j=(e,t,i)=>{const n=z(t,i);return!isNaN(Number(e))&&!isNaN(n)&&Number(e)<n},Q=(e,t,i)=>{const n=W(t,i),r=Number(e);return!isNaN(r)&&!isNaN(n)&&r<n},J=(e,t,i=!1)=>{var n;if((0,o.Q5)(e.id,null===(n=null==e?void 0:e.threadProperties)||void 0===n?void 0:n.threadType)&&!y(e)){if(e.memberProperties&&i)return e.memberProperties[s.e0.ExpirationTime];if(e.members&&t){const i=(0,r.find)(e.members,(e=>e&&e.id===t));return i&&i.memberExpirationTime}return e.memberProperties&&e.memberProperties[s.e0.ExpirationTime]}},$=(e,t)=>{var i;return!(0,o.Q5)(e.id,null===(i=null==e?void 0:e.threadProperties)||void 0===i?void 0:i.threadType)||!y(e)&&!f(e)&&((0,r.isArray)(e.members)&&t?(0,r.some)(e.members,(e=>e&&e.id===t)):!(e.threadProperties&&L(e)&&!e.threadProperties[s.Q5.LastLeaveAt]&&!e.threadProperties[s.Q5.LastJoinAt])&&!(e.threadProperties&&e.threadProperties[s.Q5.LastLeaveAt]&&(!e.threadProperties[s.Q5.LastJoinAt]||e.threadProperties[s.Q5.LastJoinAt]<e.threadProperties[s.Q5.LastLeaveAt])))};function V(e){if(!e||!L(e))return;const t=e.threadProperties[s.Q5.SpaceTypes],i=t?parseInt(t,10):0,n=!!e.threadProperties[s.Q5.SubstrateGroupId],r=(0,c.oy)(e);return n?r===l.YF.PrivateChannel?l.xu.Private:l.xu.Shared:(i&l.tG.Private)===l.tG.Private?l.xu.Private:l.xu.Standard}const K=(e,t)=>{var i;if(!!e.threadProperties.isLastMessageFromMe)return!0;const n=null===(i=e.lastMessage)||void 0===i?void 0:i.from;if(!n)return!1;return t===(0,r.last)(n.split("/"))},G=(e,t)=>(0,r.reduce)(e.members,((e,i)=>{const n=i.id;return n&&n!==t&&e.push(n),e}),[]),q=(e,t,i)=>{let n;const a=!e.members||!!e.members&&(0,r.some)(e.members,(e=>!e));if(i&&!a){const r=G(e,t);n=T(e)&&1===r.length?i[r[0]]:i[e.id]}return n},X=e=>{if(!e)throw new Error("Invalid conversation passed to topicName");if(e.threadProperties){if(N(e)){let t=e.threadProperties.topic;if(t&&-1!==t.indexOf(":")&&(t=void 0),!t&&(0,c.x)(e)){const i=(0,c.$n)(e);i&&(t=i)}return t}if(w(e)&&oe(e)){const t=ge(e);if(t&&t.trim())return t}else{const t=e.threadProperties.topic,i=e.threadProperties[s.Q5.TopicThreadTopic];if(t&&t.trim())return t;if(i&&i.trim())return i}}return""},Y=(e,t=!1)=>N(e,!0)&&!Z(e,t),Z=(e,t=!1)=>{var i;const n=e.members&&e.members.length<=2;return N(e,!0)&&n&&(T(e)||ae(e)||!t&&re(e)||te(e))&&!(null===(i=e.members)||void 0===i?void 0:i.some((e=>(0,o.$i)(e.id))))},ee=e=>{var t;return Z(e)&&(null===(t=e.members)||void 0===t?void 0:t.some((({id:e})=>(0,o.bl)(e))))},te=e=>e.members&&e.members.length<=2&&ne(e)&&(e.type===s.i1.PhoneChat||e.threadProperties&&e.threadProperties[s.Q5.ThreadType]===d.T.PhoneChat),ie=e=>!!(null==e?void 0:e.startsWith(s.at.PhonelinkSmsPrefix)),ne=e=>(0,r.some)(e.members,(e=>!!e.id&&e.id.startsWith(s.at.Pstn))),re=e=>N(e,!0)&&e.members&&2===e.members.length&&!(0,r.isNil)(e.threadProperties)&&parseInt(e.threadProperties[s.Q5.CreatedAt],10)<s.Yv,ae=e=>{var t,i;return!!e.id&&e.id.indexOf(s.B3)>-1||"true"===(null===(i=null===(t=e.threadProperties[s.Q5.P2PChatUniqueRosterThread])||void 0===t?void 0:t.toString())||void 0===i?void 0:i.toLowerCase())||Te(e)},oe=e=>e.threadProperties&&e.threadProperties[s.Q5.ThreadType]===d.T.Topic||F(e)||E(e),se=e=>(0,c.Jn)(e),de=e=>ue(e&&e.id),le=e=>se(e)||(e=>ce(e))(e)||de(e),ce=e=>{const t=(0,r.isString)(e)?e:e.id;return(0,r.endsWith)(t,s.M9)||(0,r.endsWith)(t,s.IS)||(0,r.startsWith)(t,s.X2)},pe=e=>ce(e)||Ce(e),ue=e=>!!e&&((0,r.endsWith)(e,s.RS)||(0,r.startsWith)(e,s.QV)),me=e=>e===s.Z,he=e=>{const t=(0,r.endsWith)(e,s.M9)||(0,r.endsWith)(e,s.IS)||(0,r.startsWith)(e,s.X2),i=e.endsWith(s.GQ),n=ue(e);return t||i||n},ve=e=>{const t=J(e),i=t&&t<Date.now();return $(e)&&!i},fe=e=>{if(e.threadProperties&&e.threadProperties[s.Q5.Topics]){const t=e.threadProperties[s.Q5.Topics];if("["!==t.substr(0,1))return t.split("|").map((e=>({id:e,name:"Unknown"})));try{return JSON.parse(t)}catch(e){return[]}}return[]},ge=e=>{if(e.threadProperties){if(e.threadProperties[s.Q5.XTeamName])return e.threadProperties[s.Q5.XTeamName];if(e.type===s.i1.Team&&e.threadProperties.topic)return e.threadProperties.topic}},Se=e=>{const t=fe(e),i=ge(e);return t.map((t=>{const n={},r=t.name;return n[s.Q5.CreatedAt]=parseInt(t.createdat,10),n[s.Q5.Picture]=t.picture,n[s.Q5.IsDeleted]=t.isdeleted,n[s.Q5.XTeamName]=t.isShared?r:i,n.topic=r,n[s.Q5.TopicThreadTopic]=r,{threadProperties:n,id:t.id,members:[],messages:"",properties:{},version:0,type:s.i1.Topic,threadVersion:0,detailsVersion:-1,oldConsumptionHorizonKeys:[],teamId:e.id,lastMessageTimeUtc:0,isPending:void 0,memberProperties:{},mruEvictedTime:0,rosterVersion:0,rosterSummary:void 0,botMembers:[],lastSeenSkipRosterState:void 0,lastMessage:void 0,localClientId:"",isUserMember:!1,source:e.source}}))},ke=e=>{if(e.parentId)return e.parentId;if((0,c.re)(e))try{const t=JSON.parse(e.threadProperties[s.Q5.ParentSpaces]),i=t.linkedSpaceInfoItems[0].spaceThreadId;if(!(0,r.isEmpty)(i))return i}catch(e){return}},be=e=>{const t=e.threadProperties&&e.threadProperties[s.Q5.SpaceId];return(I(e)?e.id:(0,c.re)(e)?ke(e):t)||e.teamId},ye=e=>{var t;const i=e.properties?null===(t=e.properties[s.Ff.Alerts])||void 0===t?void 0:t.trim().toLowerCase():void 0;return"true"!==i&&("false"===i||void 0)},Pe=e=>e.threadProperties&&((0,r.isBoolean)(e.threadProperties[s.Q5.GapDetectionEnabled])?e.threadProperties[s.Q5.GapDetectionEnabled]:"true"===(0,r.lowerCase)(e.threadProperties[s.Q5.GapDetectionEnabled])),Ce=e=>{const t=_e(e);return t&&!ce(e)&&Z(e)&&(0,r.some)(e.members,(e=>e.tenantId&&e.tenantId!==t))||Ie(e.id)||Ie(e.localClientId||"")},Te=e=>{var t,i;return!(0,r.isNil)(e.threadProperties)&&(e.threadProperties[s.Q5.TemplateType]===s.Q5.ImmutableRoster||"true"===(null===(i=null===(t=e.threadProperties[s.Q5.IsStickyThread])||void 0===t?void 0:t.toString())||void 0===i?void 0:i.toLowerCase()))},Ie=e=>(0,r.startsWith)(e,s.At),_e=e=>e.threadProperties&&e.threadProperties[s.Q5.TenantId],we=e=>{const t=I(e)&&e.threadProperties[s.Q5.ArchivalLevel]&&e.threadProperties[s.Q5.ArchivalLevel].toLowerCase()===s.C8.Space.toLowerCase(),i=L(e)&&e.threadProperties[s.Q5.ArchivalLevel]&&e.threadProperties[s.Q5.ArchivalLevel].toLowerCase()===s.C8.Topic.toLowerCase();return t||i},Me=e=>function(e){if(!e.properties)return!1;return function(e){if(!e)return 0;const t=new Date(e),i=t?t.getTime():0;return isNaN(i)?0:i}(e.properties[s.Ff.LastImportantImTime])>Number(Ne(e).originalArrivalTime)}(e),Ne=e=>(0,r.isEmpty)(e.properties&&e.properties[s.Ff.ConsumptionHorizonBookmark])?(0,p.bf)(e):(0,p.BU)(e);const xe=e=>{if(!e||!e.properties)return!1;const t=e.properties[s.Ff.isPinned];return!!t&&("boolean"==typeof t?t:"string"==typeof t&&"true"===t.toLowerCase())},Ae=e=>{var t;const i=null===(t=e.memberProperties)||void 0===t?void 0:t[s.e0.RelationshipState];return!!(null==i?void 0:i.inQuarantine)},De=e=>{var t;const i=null===(t=e.memberProperties)||void 0===t?void 0:t[s.e0.RelationshipState];return"number"==typeof(null==i?void 0:i.quarantineCounter)?null==i?void 0:i.quarantineCounter:0},Le=e=>{var t;return!!(null===(t=e.memberProperties)||void 0===t?void 0:t[s.e0.ExplicitlyAdded])},Ee=e=>{var t;return(null===(t=null==e?void 0:e.properties)||void 0===t?void 0:t.supressLastMessageUpdate)===s.Zt.Sender}},829540:(e,t,i)=>{if(i.d(t,{Kz:()=>a,eT:()=>o,uO:()=>s,aE:()=>d,eA:()=>l,h5:()=>c,vf:()=>p,Mw:()=>u}),40179==i.j)var n=i(232410);var r=i(458281);const a=e=>{const t=decodeURIComponent(e),i=new RegExp("context=(.*)$","g").exec(t);if(!i||i.length<2)throw new Error(`Meeting context is not in valid format ${t}`);const n=JSON.parse(i[1]);if(!n||!n.Tid||!n.Oid)throw new Error("Meeting url is malformed Tid or Oid is missing");return{tenantId:n.Tid,organizerId:n.Oid}},o=(e,t,i)=>{const r=(e=>{const t="meet",i="meetup-join",n=new URL(e);let r;if(n.pathname.includes(t)||n.pathname.includes(i))r=n;else{if(!n.hash||!n.hash.includes(t)&&!n.hash.includes(i))throw new Error("Invalid URL - unsupported URL format");r=new URL(n.hash.substring(1),n.origin)}const a=r.searchParams,o=r.pathname.split("/"),s={isLegacyUrl:!1,meetingCloud:r.hostname,meetingUrl:e};if(o[2]===i){const e=a.get("context");if(5!==o.length||!e)throw new Error("Invalid URL - context param is missing");s.threadId=decodeURIComponent(o[3]),s.messageId=decodeURIComponent(o[4]);try{const t=JSON.parse(decodeURIComponent(e));if(!t.Tid||!t.Oid)throw new Error("Invalid URL - context param is invalid. Tid or Oid missing.");s.tenantId=t.Tid,s.organizerId=t.Oid,s.isBroadcastMeeting=t.IsBroadcastMeeting||void 0,s.attendeeRole=t.role||void 0,s.replyChainMessageId=t.MessageId||void 0}catch(e){throw new Error("Invalid URL - could not parse context param.")}s.isLegacyUrl=!0}else{if(o[1]!==t)throw new Error("Invalid URL - unsupported URL format");s.meetingId=o[2],s.passCode=a.get("p")||void 0}return s})(e);let a;return a=r.isLegacyUrl?{type:n.GXC.Meeting,joinOptions:{meeting:{showPrejoin:!0,isPSTN:!1,title:t},context:i},coordinates:{legacyMeeting:{meetingCloud:r.meetingCloud,conversationId:r.threadId||"",rootMessageId:r.messageId||"",messageId:r.replyChainMessageId||r.messageId||"",isChannel:"0"!==r.messageId,isAdhoc:!1,tenantId:r.tenantId||"",organizerId:r.organizerId||""}}}:{type:n.GXC.Meeting,joinOptions:{meeting:{showPrejoin:!0,isPSTN:!1,title:t},context:i},coordinates:{meetingData:{meetingUrl:e}}},a},s=e=>{var t,i,n,r;try{return new URL(e).hostname}catch(a){return(null===(r=null===(n=null===(i=null===(t=e.split("/"))||void 0===t?void 0:t[2])||void 0===i?void 0:i.split("@"))||void 0===n?void 0:n.pop())||void 0===r?void 0:r.split(":").shift())||""}},d=e=>{let t=!1;if(e&&e.skypeTeamsDataObj){t=1===e.skypeTeamsDataObj.type}return t};function l(e){return!(!e||!e.skypeTeamsDataObj||(0,r.isEmpty)(e.skypeTeamsDataObj))&&!1===e.skypeTeamsDataObj.private}const c=e=>{var t;return!!(null===(t=e.webinarRegistration)||void 0===t?void 0:t.webinarId)},p=e=>{var t;return!!(null===(t=e.virtualEventsData)||void 0===t?void 0:t.eventId)},u=e=>{try{return"meet"===new URL(e).pathname.split("/")[1]}catch(e){return!1}}},275925:(e,t,i)=>{if(i.d(t,{Hk:()=>a,Rd:()=>o,By:()=>s}),40179==i.j)var n=i(122267);function r(e,t){if(!e.startsWith("blob"))return Promise.reject("invalid blob url");const i=new XMLHttpRequest;return i.open("GET",e,!0),i.responseType=t,new Promise(((e,t)=>{i.onload=()=>{200===i.status&&i.response?e(i.response):t(200!==i.status?{status:i.status,statusText:i.statusText}:{status:404,statusText:"no response data"})},i.onerror=()=>{t({status:i.status,statusText:i.statusText})},i.send()}))}function a(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return yield r(e,"blob")}))}function o(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=yield r(e,"arraybuffer");return new Uint8Array(t)}))}function s(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return e.then((e=>URL.createObjectURL(e)))}))}},138053:(e,t,i)=>{i.d(t,{Fd:()=>o,s3:()=>d,HC:()=>l,wm:()=>c,LY:()=>p,Bj:()=>u});var n=i(458281);if(40179==i.j)var r=i(329635);var a=i(217135);function o(e,t){try{const i=s(e);if("https://local.teams.office.com"===new URL(e).origin)return!0;for(const e of(0,n.uniqBy)(t,(e=>e.toLowerCase()))){let t="";const n=e.split(".");for(let e=0;e<n.length;e++)t+=(e>0?"[.]":"")+n[e].replace("*","[^/^.]+");const r=new RegExp(`^https://${t}((/|\\?).*)?$`,"i");if(i.match(r))return!0}}catch(e){return!1}return!1}const s=e=>new URL(e).href,d=(e,t)=>{let i="";if(!e.id||c(e.id))return i;switch(e.type){case r.p.extensions:try{i=JSON.parse(e.id).threadId}catch(t){i=e.id}break;case r.p.chats:i=e.id.replace("replyChainId","messageid");break;case r.p.communities:case r.p.channels:let n;try{n=JSON.parse(e.id).channelId}catch(t){n=e.id}i=t?`${n};messageid=${t}`:n;break;case r.p.shareformdialog:break;default:i=e.id}return i},l=e=>e&&e.replace(new RegExp(`^${a.at.BotPrefix}`),""),c=e=>"newchat"===e||(null==e?void 0:e.includes("preview")),p=(e,t=a.Cs.Call)=>t===a.Cs.Call&&/<partlist/.test(e)&&!u(e,t),u=(e,t=a.Cs.Call)=>t===a.Cs.Call&&(-1!==e.indexOf("<ended/>")||/^<partlist[^>]*type="ended"/.test(e))},668414:(e,t,i)=>{i.d(t,{X:()=>n,si:()=>a,D:()=>o});const n="other";var r;function a(e){return!!r[e]}function o(){return Object.keys(r).filter((e=>isNaN(Number(e))))}!function(e){e[e["3mf"]=0]="3mf",e[e.cool=1]="cool",e[e.glb=2]="glb",e[e.gltf=3]="gltf",e[e.obj=4]="obj",e[e.stl=5]="stl",e[e.movie=6]="movie",e[e.pages=7]="pages",e[e.pict=8]="pict",e[e.sketch=9]="sketch",e[e.ai=10]="ai",e[e.pdf=11]="pdf",e[e.psb=12]="psb",e[e.psd=13]="psd",e[e["3g2"]=14]="3g2",e[e["3gp"]=15]="3gp",e[e.asf=16]="asf",e[e.bmp=17]="bmp",e[e.hevc=18]="hevc",e[e.m2ts=19]="m2ts",e[e.m4v=20]="m4v",e[e.mov=21]="mov",e[e.mp3=22]="mp3",e[e.mp4=23]="mp4",e[e.mp4v=24]="mp4v",e[e.mts=25]="mts",e[e.ts=26]="ts",e[e.wmv=27]="wmv",e[e.dwg=28]="dwg",e[e.fbx=29]="fbx",e[e.erf=30]="erf",e[e.zip=31]="zip",e[e["7z"]=32]="7z",e[e.z=33]="z",e[e.dcm=34]="dcm",e[e.dcm30=35]="dcm30",e[e.dicm=36]="dicm",e[e.dicom=37]="dicom",e[e.ply=38]="ply",e[e.hcp=39]="hcp",e[e.gif=40]="gif",e[e.heic=41]="heic",e[e.heif=42]="heif",e[e.jpeg=43]="jpeg",e[e.jpg=44]="jpg",e[e.jpe=45]="jpe",e[e.mef=46]="mef",e[e.mrw=47]="mrw",e[e.nef=48]="nef",e[e.nrw=49]="nrw",e[e.orf=50]="orf",e[e.pano=51]="pano",e[e.pef=52]="pef",e[e.png=53]="png",e[e.rw2=54]="rw2",e[e.spm=55]="spm",e[e.tif=56]="tif",e[e.tiff=57]="tiff",e[e.xbm=58]="xbm",e[e.xcf=59]="xcf",e[e.key=60]="key",e[e.csv=61]="csv",e[e.dic=62]="dic",e[e.doc=63]="doc",e[e.docm=64]="docm",e[e.docx=65]="docx",e[e.dot=66]="dot",e[e.dotm=67]="dotm",e[e.dotx=68]="dotx",e[e.pot=69]="pot",e[e.potm=70]="potm",e[e.potx=71]="potx",e[e.pps=72]="pps",e[e.ppsm=73]="ppsm",e[e.ppsx=74]="ppsx",e[e.ppt=75]="ppt",e[e.pptm=76]="pptm",e[e.pptx=77]="pptx",e[e.xd=78]="xd",e[e.xls=79]="xls",e[e.xlsb=80]="xlsb",e[e.xlsm=81]="xlsm",e[e.xlsx=82]="xlsx",e[e.sltx=83]="sltx",e[e.eml=84]="eml",e[e.msg=85]="msg",e[e.vsd=86]="vsd",e[e.vsdx=87]="vsdx",e[e.cur=88]="cur",e[e.ico=89]="ico",e[e.icon=90]="icon",e[e.epub=91]="epub",e[e.odp=92]="odp",e[e.ods=93]="ods",e[e.odt=94]="odt",e[e.arw=95]="arw",e[e.cr2=96]="cr2",e[e.crw=97]="crw",e[e.dng=98]="dng",e[e.rtf=99]="rtf",e[e.abap=100]="abap",e[e.ada=101]="ada",e[e.adp=102]="adp",e[e.ahk=103]="ahk",e[e.as=104]="as",e[e.as3=105]="as3",e[e.asc=106]="asc",e[e.ascx=107]="ascx",e[e.asm=108]="asm",e[e.asp=109]="asp",e[e.awk=110]="awk",e[e.bas=111]="bas",e[e.bash=112]="bash",e[e.bash_login=113]="bash_login",e[e.bash_logout=114]="bash_logout",e[e.bash_profile=115]="bash_profile",e[e.bashrc=116]="bashrc",e[e.bat=117]="bat",e[e.bib=118]="bib",e[e.bsh=119]="bsh",e[e.build=120]="build",e[e.builder=121]="builder",e[e.c=122]="c",e[e.capfile=123]="capfile",e[e.cbk=124]="cbk",e[e.cc=125]="cc",e[e.cfc=126]="cfc",e[e.cfm=127]="cfm",e[e.cfml=128]="cfml",e[e.cl=129]="cl",e[e.clj=130]="clj",e[e.cmake=131]="cmake",e[e.cmd=132]="cmd",e[e.coffee=133]="coffee",e[e.cpp=134]="cpp",e[e.cpt=135]="cpt",e[e.cpy=136]="cpy",e[e.cs=137]="cs",e[e.cshtml=138]="cshtml",e[e.cson=139]="cson",e[e.csproj=140]="csproj",e[e.css=141]="css",e[e.ctp=142]="ctp",e[e.cxx=143]="cxx",e[e.d=144]="d",e[e.ddl=145]="ddl",e[e.dif=146]="dif",e[e.diff=147]="diff",e[e.disco=148]="disco",e[e.dml=149]="dml",e[e.dtd=150]="dtd",e[e.dtml=151]="dtml",e[e.el=152]="el",e[e.emake=153]="emake",e[e.erb=154]="erb",e[e.erl=155]="erl",e[e.f90=156]="f90",e[e.f95=157]="f95",e[e.fluid=158]="fluid",e[e.fs=159]="fs",e[e.fsi=160]="fsi",e[e.fsscript=161]="fsscript",e[e.fsx=162]="fsx",e[e.gemfile=163]="gemfile",e[e.gemspec=164]="gemspec",e[e.gitconfig=165]="gitconfig",e[e.go=166]="go",e[e.groovy=167]="groovy",e[e.gvy=168]="gvy",e[e.h=169]="h",e[e.haml=170]="haml",e[e.handlebars=171]="handlebars",e[e.hbs=172]="hbs",e[e.hrl=173]="hrl",e[e.hs=174]="hs",e[e.htc=175]="htc",e[e.hxx=176]="hxx",e[e.idl=177]="idl",e[e.iim=178]="iim",e[e.inc=179]="inc",e[e.inf=180]="inf",e[e.ini=181]="ini",e[e.inl=182]="inl",e[e.ipp=183]="ipp",e[e.ipynb=184]="ipynb",e[e.irbrc=185]="irbrc",e[e.jade=186]="jade",e[e.jav=187]="jav",e[e.java=188]="java",e[e.jfif=189]="jfif",e[e.js=190]="js",e[e.json=191]="json",e[e.jsp=192]="jsp",e[e.jsx=193]="jsx",e[e.l=194]="l",e[e.less=195]="less",e[e.lhs=196]="lhs",e[e.lisp=197]="lisp",e[e.log=198]="log",e[e.lst=199]="lst",e[e.ltx=200]="ltx",e[e.lua=201]="lua",e[e.m=202]="m",e[e.make=203]="make",e[e.markdn=204]="markdn",e[e.mdown=205]="mdown",e[e.mkdn=206]="mkdn",e[e.ml=207]="ml",e[e.mli=208]="mli",e[e.mll=209]="mll",e[e.mly=210]="mly",e[e.mm=211]="mm",e[e.mud=212]="mud",e[e.nfo=213]="nfo",e[e.opml=214]="opml",e[e.osascript=215]="osascript",e[e.out=216]="out",e[e.p=217]="p",e[e.pas=218]="pas",e[e.patch=219]="patch",e[e.php=220]="php",e[e.php2=221]="php2",e[e.php3=222]="php3",e[e.php4=223]="php4",e[e.php5=224]="php5",e[e.pl=225]="pl",e[e.plist=226]="plist",e[e.pm=227]="pm",e[e.pod=228]="pod",e[e.pp=229]="pp",e[e.profile=230]="profile",e[e.properties=231]="properties",e[e.ps=232]="ps",e[e.ps1=233]="ps1",e[e.pt=234]="pt",e[e.py=235]="py",e[e.pyw=236]="pyw",e[e.r=237]="r",e[e.rake=238]="rake",e[e.rb=239]="rb",e[e.rbx=240]="rbx",e[e.rc=241]="rc",e[e.re=242]="re",e[e.readme=243]="readme",e[e.reg=244]="reg",e[e.rest=245]="rest",e[e.resw=246]="resw",e[e.resx=247]="resx",e[e.rhtml=248]="rhtml",e[e.rjs=249]="rjs",e[e.rprofile=250]="rprofile",e[e.rpy=251]="rpy",e[e.rss=252]="rss",e[e.rst=253]="rst",e[e.rxml=254]="rxml",e[e.s=255]="s",e[e.sass=256]="sass",e[e.scala=257]="scala",e[e.scm=258]="scm",e[e.sconscript=259]="sconscript",e[e.sconstruct=260]="sconstruct",e[e.script=261]="script",e[e.scss=262]="scss",e[e.sgml=263]="sgml",e[e.sh=264]="sh",e[e.shtml=265]="shtml",e[e.sml=266]="sml",e[e.sql=267]="sql",e[e.sty=268]="sty",e[e.tcl=269]="tcl",e[e.tex=270]="tex",e[e.text=271]="text",e[e.textile=272]="textile",e[e.tld=273]="tld",e[e.tli=274]="tli",e[e.tmpl=275]="tmpl",e[e.tpl=276]="tpl",e[e.txt=277]="txt",e[e.vb=278]="vb",e[e.vi=279]="vi",e[e.vim=280]="vim",e[e.wsdl=281]="wsdl",e[e.xaml=282]="xaml",e[e.xhtml=283]="xhtml",e[e.xoml=284]="xoml",e[e.xml=285]="xml",e[e.xsd=286]="xsd",e[e.xsl=287]="xsl",e[e.xslt=288]="xslt",e[e.yaml=289]="yaml",e[e.yaws=290]="yaws",e[e.yml=291]="yml",e[e.zsh=292]="zsh",e[e.htm=293]="htm",e[e.html=294]="html",e[e.markdown=295]="markdown",e[e.md=296]="md",e[e.url=297]="url",e[e.one=298]="one",e[e.note=299]="note"}(r||(r={}))},211975:(e,t,i)=>{i.d(t,{Q:()=>o});var n=i(526382);const r=new RegExp(n.yH.oneDriveFile),a=new RegExp(n.yH.sharePointFile),o=(e,t)=>{if(t){const i=t.replace(n.yH.leadingAndTrailingSlashesRegex,"").split("/");i.pop();const r=i.join("/");return`${new URL(e).origin}/${r}/`}if(a.test(e)){const t=e.match(a);return t?t[0]:null}if(r.test(e)){const t=e.match(r);return t?t[0]:null}return e}},526382:(e,t,i)=>{i.d(t,{as:()=>n,Ho:()=>r,HV:()=>a,Hr:()=>o,yH:()=>s,v$:()=>d,wg:()=>l,BY:()=>c,Y_:()=>p,Bx:()=>u,MI:()=>m,Aq:()=>h,N0:()=>v,BS:()=>f,Fk:()=>g,Z2:()=>S,Z$:()=>k,ov:()=>b,Mc:()=>y,p5:()=>P,xK:()=>C,_v:()=>T,JJ:()=>I});const n={url:{getDriveItemAndPermissions:"/_api/v2.0/shares/{shareID}",fetchShareInfo:"/_api/v2.0/shares/{shareID}/driveItem",getDriveItemWithId:"/_api/v2.0/sites/root/items/{fileId}/driveItem",defaultPermissionsWithFileId:"/_api/v2.0/sites/root/items/{fileID}/driveItem/commands",getLinkPermissions:"/_api/v2.0/shares/{shareID}/permission",fetchVideoInfoWithThumbnails:"/_api/v2.0/shares/{shareID}/driveItem?$expand=thumbnails",createLinkWithId:"/_api/v2.1/sites/root/items/{id}/driveItem/createLink",createLinkWithShareId:"/_api/v2.1/shares/{shareId}/driveItem/createLink",getSharingInformation:"/_api/web/GetFileById(@a1)/ListItemAllFields/GetSharingInformation?@a1=guid",getSharingInformationByUrl:"_api/web/GetFileByUrl(@a1)/ListItemAllFields/GetSharingInformation?@a1="}},r={THREAD_ID_UPDATE_URL:"beta/teams/recent/files/backfillSpoIds?threadId={channelThreadId}",THREAD_ID_UPDATE_APINAME:"backfillSpoIds"},a={personal:"personal",teams:"teams"},o={bim:"bim",mw:"mw",ns:"ns"},s={leadingAndTrailingSlashesRegex:/(^\/|\/$)/g,oneDriveFile:`.*/${a.personal}/[^/]*/`,sharePointFile:`.*/(${a.teams}|sites)/[^/]*/`,trailingSlashRegex:/\/$/,oneNoteTargetRegex:/target\((.*)\/\)/,oneNoteSectionRegex:/(.*).one\|/,title:/^[^\\\/\:\*\?\"\<\>\|\#\%\t]*$/},d={personal:"personal",sharePoint:"share-point"},l={states:{active:"active",deleted:"deleted",reference:"reference",removed:"removed"}},c={type:"oneNote",extension:"one",extensionWithDot:".one"},p={openInTeams:"OpenFileInTeamsViewer",editInTeams:"EditInTeams",openInOfficeOnline:"OpenInOfficeOnline",openInOfficeClient:"OpenInOfficeClient"},u={clientError:-1,ok:200,badRequest:400,unauthorizedAccess:401,forbidden:403,notFound:404,notAcceptable:406,conflict:409,locked:423,tooManyRequests:429,internalServerError:500,serviceUnavailable:503,notModified:304},m={uploadCancelled:"UPLOAD_CANCELLED",conflicted:"-2130575257",conflicted_v2:"-2147024816",conflicted_v3:"nameAlreadyExists",folderDoesNotExist:"-2147024893",locked:"-2147018894",spQuotaReached:"-2147023080",quotaLimitReached:"quotaLimitReached",fileNotFound:"-2130575338",itemNotFound:"itemNotFound",fileAccessDenied:"FileAccessDenied",accessDenied:"accessDenied",sessionInProgress:"-2130575142",unauthorizedAccessException:"-2147024891",cobaltException:"-1, Cobalt.ErrorException",resourceLockedException:"-2147018887",audienceUriValidationFailedException:"Microsoft.IdentityModel.Tokens.AudienceUriValidationFailedException",unauthenticated:"unauthenticated",invalidAudienceUri:"invalidAudienceUri",siteRenameFailure:"-2147024809",notAllowed:"notAllowed",resourceLocked:"resourceLocked"};var h,v,f,g;!function(e){e.filePropertiesMissing="FILE_PROPERTIES_MISSING",e.maxFilesAttachment="MAX_FILES_ATTACHMENT",e.nullFiles="NULL_FILES",e.zeroSizeFile="ZERO_SIZE_FILE",e.titleContainSpecialCharacter="TITLE_CONTAIN_SPECIAL_CHARACTER",e.blacklistedFiletype="BLACK_LIST_FILE_TYPE",e.fileNameTooLong="FILE_NAME_TOO_LONG",e.siteInfoNotFound="SITE_INFO_NOT_FOUND",e.spQuotaReached="SP_QUOTA_REACHED",e.fileNotPresent="FILE_NOT_PRESENT",e.fileAccessDenied="FILE_ACCESS_DENIED",e.fileLocked="FILE_LOCKED",e.siteNotProvisioned="SITE_NOT_PROVISIONED",e.siteNotProvisionedSubtext="SITE_NOT_PROVISIONED_SUBTEXT",e.channelSiteNotProvisioned="CHANNEL_SITE_NOT_PROVISIONED",e.channelSiteNotProvisionedSubtext="CHANNEL_SITE_NOT_PROVISIONED_SUBTEXT",e.fileAlreadyAttachedInMessage="FILE_WITH_SAME_NAME_ALREADY_ATTACHED_IN_MESSAGE",e.audienceUriValidationFailed="INVALID_AUDIENCE_URI"}(h||(h={})),function(e){e.UNKNOWN_UPLOAD_ERROR="UNKNOWN_UPLOAD_ERROR"}(v||(v={})),function(e){e.InvalidRequest="invalidRequest",e.Unhandled="Unhandled"}(f||(f={})),function(e){e.ShareLinkCSL="files_messages_sharelink_csl",e.ShareLinkPSLWithoutIndividualAccess="files_messages_sharelink_psl_without_individual_access",e.ShareLinkPSLWithoutIndividualWrite="files_messages_sharelink_psl_without_individual_write_access",e.ShareLinkPSLWithoutFutureAccess="files_messages_sharelink_psl_without_future_access",e.ShareLinkPSLWithoutFullAndFutureAccess="files_messages_sharelink_psl_without_full_and_future_access",e.ShareLinkPSLWithoutWriteAndFutureAccess="files_messages_sharelink_psl_without_write_and_future_access",e.ShareLinkFederatedAndGuestCSL="files_messages_sharelink_federated_and_guest_csl",e.ShareLinkFederatedCSL="files_messages_sharelink_federated_csl",e.ShareLinkPSLWithoutFullAccess="files_messages_sharelink_psl_without_full_access",e.ShareLinkCSLXTenantSharedChannel="files_messages_sharelink_csl_xtenant_sharedchannel",e.ShareLinkPSLWithoutFullAndFutureAccessXTenantSharedChannel="files_messages_sharelink_psl_without_full_and_future_access_xtenant_sharedchannel",e.ShareLinkPSLWithoutFullAndFutureAccessInTenantSharedChannel="files_messages_sharelink_psl_without_full_and_future_access_intenant_sharedchannel"}(g||(g={}));const S=100,k=10485760,b=12e4,y=3e5,P=600;var C;!function(e){e.GRAPH_URL_KEY="@microsoft.graph.downloadUrl",e.CONTENT_URL_KEY="@content.downloadUrl"}(C||(C={}));const T="/_layouts/15/Doc.aspx?OR=teams&action=edit&sourcedoc=";var I;!function(e){e.InvalidURL="InvalidURL",e.InvalidURLProtocol="InvalidURLProtocol",e.Invalid3PURLDomain="Invalid3PURLDomain",e.InvalidSPOOrPersonalSiteDomain="InvalidSPOOrPersonalSiteDomain",e.DifferentURLDomains="DifferentURLDomains"}(I||(I={}))},219170:(e,t,i)=>{if(i.d(t,{X:()=>r}),40179==i.j)var n=i(526382);const r=e=>{switch(e){case n.Bx.unauthorizedAccess:return!1;case n.Bx.clientError:case n.Bx.badRequest:case n.Bx.internalServerError:case n.Bx.serviceUnavailable:case n.Bx.tooManyRequests:return!0;default:return!1}}},375422:(e,t,i)=>{if(i.d(t,{P:()=>r}),40179==i.j)var n=i(596144);function r(e){const t=e.performance;let i,r,a;const o=null==t?void 0:t.memory;return o&&(i=(0,n.kl)(o.jsHeapSizeLimit),r=(0,n.kl)(o.totalJSHeapSize),a=(0,n.kl)(o.usedJSHeapSize)),{jsHeapSizeLimit:i,totalJSHeapSize:r,usedJSHeapSize:a}}},141657:(e,t,i)=>{if(i.d(t,{K:()=>a}),40179==i.j)var n=i(122267);if(40179==i.j)var r=i(596144);function a(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const i={workers:[],processes:[],windows:[]},n=yield null==e?void 0:e.loadModule("heartbeat");if(!(null==n?void 0:n.getPerfMetrics))return i;try{if(t&&(null==n?void 0:n.getPerfMetricsAsync)){const{processes:e,workers:t,windows:a}=yield n.getPerfMetricsAsync();for(const e of t)i.workers.push({targetSessionId:e.targetSessionId,type:e.type,subType:e.subType,totalSizeKB:(0,r.kl)(e.totalSizeBytes),usedSizeKB:(0,r.kl)(e.usedSizeBytes)});for(const t of e)i.processes.push({processId:t.processId,name:t.name,type:t.type,utilitySubType:t.utilitySubType,embeddedBrowserWebView:t.embeddedBrowserWebView,cpuCycleTime:t.cpuCycleTime,workingSetSizeKB:(0,r.kl)(t.workingSetSizeBytes),commitSizeKB:(0,r.kl)(t.pageFileUsageBytes)});i.windows=a}else{const e=yield n.getPerfMetrics();for(const t of e)i.processes.push({processId:t.processId,name:t.name,type:t.type,utilitySubType:t.utilitySubType,embeddedBrowserWebView:t.embeddedBrowserWebView,cpuCycleTime:t.cpuCycleTime,workingSetSizeKB:(0,r.kl)(t.workingSetSizeBytes),commitSizeKB:(0,r.kl)(t.pageFileUsageBytes)})}}catch(e){console.error("get-webview-2-metrics, getMetrics: Failed to get metrics.")}return i}))}},596144:(e,t,i)=>{i.d(t,{tC:()=>r,Mv:()=>a,RQ:()=>o,kl:()=>s,ev:()=>d});var n=i(458281);function r(e){const t={},i=[...e];return u(t,"TelemetryWorker",g(i,"TelemetryWorker")),u(t,"CDLWorker",g(i,"CDLWorker")),u(t,"ServiceWorker",g(i,"ServiceWorker")),t.Perf_Total_NumberOfCDLWorkers=f(e,"CDLWorker"),t.Perf_Total_NumberOfServiceWorkers=f(e,"ServiceWorker"),t.Perf_Total_NumberOfTelemetryWorkers=f(e,"TelemetryWorker"),t.Perf_Total_NumberOfWorkers=e.length,t}function a(e,t,i){const n={},r=[...e];m(n,"GPU",v(r,["gpu-process","Gpu"]),t),m(n,"NativeShell",v(r,["nativeShell","NativeShell"]),t),m(n,"CrashpadHandler",v(r,"crashpad-handler"),t),m(n,"Browser",v(r,["browser","Browser"]),t);const a=v(r,["renderer","Renderer"]);n.Perf_Renderer_Count_Processes=a.length,m(n,"Renderer",a,t),m(n,"SlimCore",v(r,["NativeModuleProcess_SlimCore"]),t);const o=v(r,["utility","Utility"]);if(m(n,"Utility",o,t),n.Perf_Utility_Process=[...o],k(n,"NetworkService",S(o,"NetworkService")),k(n,"StorageService",S(o,"StorageService")),k(n,"AudioService",S(o,"AudioService")),m(n,"Total",e),n.Perf_Total_NumberOfProcesses=e.length,n.Perf_Unknown_Process=r,n.Perf_Unknown_NumberOfProcesses=r.length,n.Perf_Unknown_WorkingSet=c(r),n.Perf_Unknown_CommitSize=p(r),i){const r=e.find((e=>e.processId===i));r&&(n.Perf_MainRenderer_WorkingSet=c([r]),n.Perf_MainRenderer_CommitSize=p([r]),n.Perf_MainRenderer_PeakWorkingSet=null==t?void 0:t.get(i))}return n}function o(e,t){const i={},{totalJSHeapSize:n,jsHeapSizeLimit:r,usedJSHeapSize:a}=e;return n&&(i.Perf_JSHeap_TotalSize=n),r&&(i.Perf_JSHeap_LimitSize=r),a&&(i.Perf_JSHeap_UsedSize=a),t&&(i.Perf_Peak_UsedJSHeapSize=t),i}function s(e){return"number"!=typeof e||isNaN(e)?void 0:Math.round(e/1024)}const d=40179==i.j?s:null;function l(e,t){const i=(0,n.sumBy)(e,(e=>{var i;return null!==(i=e[t])&&void 0!==i?i:NaN}));return 0===e.length||isNaN(i)?void 0:i}function c(e){return l(e,"workingSetSizeKB")}function p(e){return l(e,"commitSizeKB")}function u(e,t,i){e[`Perf_${t}_UsedSize`]=function(e){return l(e,"usedSizeKB")}(i),e[`Perf_${t}_TotalSize`]=function(e){return l(e,"totalSizeKB")}(i)}function m(e,t,i,n){if(e[`Perf_${t}_WorkingSet`]=c(i),e[`Perf_${t}_CommitSize`]=p(i),"Total"===t)e.Perf_Total_NumberOfProcesses=i.length;else{if(e[`Perf_${t}_Count_Processes`]=i.length,!n||!i.length)return;const r=Math.max(...i.map((e=>n.get(e.processId)||0)));r&&(e[`Perf_${t}_PeakWorkingSet`]=r)}}function h(e,t){let i;const n=[];for(;i=e.findIndex(t),-1!==i;)n.push(e.splice(i,1)[0]);return n}function v(e,t){const i="string"==typeof t?[t]:t;return h(e,(e=>i.includes(e.type)))}const f=(e,t)=>e.filter((e=>e.subType===t)).length;function g(e,t){return h(e,(e=>e.subType.includes(t)))}function S(e,t){return h(e,(e=>e.utilitySubType.includes(t)))}function k(e,t,i){e[`Perf_${t}_WorkingSet`]=c(i),e[`Perf_${t}_CommitSize`]=p(i),e[`Perf_${t}_Count_Processes`]=i.length}},709216:(e,t,i)=>{i.d(t,{hN:()=>a,jE:()=>s,mo:()=>c,PI:()=>p,Xn:()=>u,BN:()=>v,Np:()=>f,mW:()=>g,Qz:()=>S,zG:()=>k,cE:()=>b,Wg:()=>y,_Y:()=>P,cI:()=>T,t_:()=>I,gC:()=>M});var n=i(217135);if(40179==i.j)var r=i(50604);var a,o,s,d=i(458281);if(40179==i.j)var l=i(773823);!function(e){e.TeamsOnly="TeamsOnly",e.SfBOnly="SfBOnly",e.SfBWithTeamsCollab="SfBWithTeamsCollab",e.SfBWithTeamsCollabAndMeetings="SfBWithTeamsCollabAndMeetings",e.Islands="Islands",e.IslandsWithTempInterop="IslandsWithTempInterop",e.IslandsWithVoipDeepLinking="IslandsWithVoipDeepLinking"}(a||(a={})),function(e){e[e.Islands=1]="Islands",e[e.IslandsWithTempInterop=2]="IslandsWithTempInterop",e[e.IslandsWithVoipDeepLinking=3]="IslandsWithVoipDeepLinking",e[e.SfBOnly=4]="SfBOnly",e[e.SfBWithTeamsCollab=5]="SfBWithTeamsCollab",e[e.SfBWithTeamsCollabAndMeetings=6]="SfBWithTeamsCollabAndMeetings",e[e.TeamsOnly=7]="TeamsOnly",e[e.Legacy=8]="Legacy"}(o||(o={})),function(e){e[e.Teams=0]="Teams",e[e.SfB=1]="SfB",e[e.Federated=2]="Federated",e[e.NativeFederated=3]="NativeFederated"}(s||(s={}));const c=e=>!!(e&&e.coExistenceMode&&a[e.coExistenceMode]),p=e=>!(e!==a.TeamsOnly),u=e=>!(-1===[a.Islands,a.IslandsWithTempInterop,a.IslandsWithVoipDeepLinking].indexOf(e)),m=e=>!(-1===[a.SfBOnly,a.SfBWithTeamsCollab,a.SfBWithTeamsCollabAndMeetings].indexOf(e)),h=(e,t,i=!1)=>{const r=[n.Jq,n.Dr,n.iO,n.TO,n.pk,n.P_],a=e.split(":");return r.some((e=>{const n=a.findIndex((t=>t===e.slice(0,-1)));return n>=0&&(i?a.splice(n+1,1):a.splice(n+1,0,t.slice(0,-1)),!0)})),a.join(":")},v=e=>!!e&&!(0,d.startsWith)(n.at.SkypeSpacesUser+n.pW,e)&&e.includes(n.pW),f=e=>!e||v(e)?e:e.includes(n.at.SkypeSpacesUser)?h(e,n.pW):void 0,g=e=>!!e&&!(0,d.startsWith)(n.at.SkypeSpacesUser+n.m_,e)&&e.includes(n.m_),S=e=>!!e&&!(0,d.startsWith)(n.at.SkypeSpacesUser+n.U0,e)&&e.includes(`:${n.U0}`),k=e=>!e||S(e)?e:e.includes(n.at.SkypeSpacesUser)?h(e,n.U0):void 0,b=e=>!e||g(e)?e:e.includes(n.at.SkypeSpacesUser)?h(e,n.m_):void 0,y=e=>{if(e){if(v(e))return h(e,n.pW,!0);if(g(e))return h(e,n.m_,!0)}return e},P=e=>e?S(e)?h(e,n.U0,!0):void 0:e,C={isAllowed:!1},T=(e,t,i,n,r,a,o,s)=>{const d=o&&o.coExistenceMode,l=a&&a.coExistenceMode;if(!d||!l)return{isAllowed:!0};if(n){const n=((e,t,i,n,r,a,o)=>{const s=o.newLogger("sfb-interop");return a.isFederated?!n&&i?(s.log("Chat Disabled: current user is not provisioned on Sfb online"),C):a.coExistenceMode&&r.coExistenceMode?e&&i&&p(r.coExistenceMode)&&p(a.coExistenceMode)?{isAllowed:!1,mri:b(a.mri||"")}:i||t||!u(r.coExistenceMode)&&!u(a.coExistenceMode)?!i&&m(a.coExistenceMode)?{isAllowed:!1,toInterop:!0,mri:a.mri||""}:{isAllowed:!0}:{isAllowed:!1,toInterop:!0,mri:a.mri}:(s.log("Chat Enabled: TeamsUpgradePolicy is not defined for both users"),{isAllowed:!0}):(s.log("Federated Chat Disabled: recipient user is not federated"),(e=>({isAllowed:!1,toInterop:!1,mri:e.mri}))(a))})(e,t,i,r,a,o,s);if(!n.isAllowed)return n}else{const e=((e,t)=>t.coExistenceMode?e&&p(t.coExistenceMode)?{isAllowed:!1,mri:y(t.mri||"")}:!e&&m(t.coExistenceMode)?{isAllowed:!1,mri:f(t.mri||""),toInterop:!0}:{isAllowed:!0}:{isAllowed:!0})(i,o);if(!e.isAllowed)return e}return{isAllowed:!0}},I=e=>{const t=g(e);return _(e)||v(e)||t?t?e.replace(n.m_,""):e.replace(n.pW,"").replace(n.zt,""):e},_=e=>!!e&&!(0,d.startsWith)(n.at.SkypeSpacesUser+n.zt,e)&&e.includes(n.zt),w=(e,t,i,n)=>{const r=e.isFederated,a=(s=e.mri||"",(0,d.endsWith)(s,"@sfbonprem.unq.gbl.spaces"));var s;if(t&&r&&!a&&e.coExistenceMode){const t=o[e.coExistenceMode],r=i===o.TeamsOnly&&t===o.TeamsOnly;return r||n.log(`isNativeFederationMode is false - currentUserMessagingPolicyMode:${o[i]} recipientCoexistenceMode:${o[t]}`),r}return n.log(`isNativeFederationMode is false - enableNativeP2PFederatedChats:${t} isFederated:${r} isOnPremFederated:${a} coExistenceMode:${e.coExistenceMode}`),!1},M=(e,t,i,n,a,d)=>{if(!(e&&e.mri&&e.userType!==l.vf.guest&&e.type!==l.vf.skypeConsumer&&e.type!==l.vf.tflUser&&(0,r.eZ)(e.mri)))return i.log("getUserChatMode - Defaulting to teams chat mode as user profile is undefined or Guest or TFL user or is not a real user mri"),s.Teams;if(e.isFederated)return i.log(`getUserChatMode - federated user - mri: ${e.mri}, coExistenceMode: ${e.coExistenceMode}`),w(e,a,d,i)?s.NativeFederated:s.Federated;const c=((e,t,i)=>{const n=e.coExistenceMode,r=o[n];if(i.log(`getCoexistenceChatMode - caller: ${t}, mri: ${e.mri}, isShortProfile: ${e.isShortProfile}, coExistenceMode: ${o[r]}, MT coExistenceMode: ${n}`),o[r]!==n&&i.error(`getUserChatMode - Mapping error - coExistenceMode : ${o[r]}, MT coExistenceMode: ${n}`),r){const e=[o.SfBOnly,o.SfBWithTeamsCollab,o.SfBWithTeamsCollabAndMeetings],t=[o.TeamsOnly,o.Islands,o.IslandsWithVoipDeepLinking];if(e.includes(r))return s.SfB;if(t.includes(r))return s.Teams;i.warn(`getUserChatMode - unknown coExistenceMode ${o[r]}`)}else e.isShortProfile||i.warn(`getUserChatMode - full profile has no coExistenceMode for mri ${e.mri}`)})(e,t,i);if(c)return c;const p=v(e.mri),u=e.isSkypeTeamsUser,m=(e=>!(!e.isFederated&&void 0!==e.isPrivateChatEnabled)||e.isPrivateChatEnabled)(e);return i.log(`getUserChatMode - caller: ${t}, mri: ${e.mri}, isSfbMri: ${p}, isTeamsChatEnabled: ${m}, hasLoggedInToTeams: ${u}, isSipDisabled: ${e.isSipDisabled}, isSfBEligible: ${n}`),!p&&u&&m||e.isSipDisabled||!n?s.Teams:s.SfB}}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/12218-c124ab5924d91c30.js.map