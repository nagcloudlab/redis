"use strict";(this.webpackChunk_msteams_multi_window=this.webpackChunk_msteams_multi_window||[]).push([[64275],{886620:(e,t,n)=>{var i;n.d(t,{D:()=>i}),function(e){e.AccessibilitySettingsPanelButton="AccessibilitySettingsPanelButton",e.ActivityFeed="ActivityFeed",e.ActivityFeedBellClick="ActivityFeedBellClick",e.AddAccountFromMeMenu="AddAccountFromMeMenu",e.AddAccountFromSettings="AddAccountFromSettings",e.AltTextMenuItem="AltTextMenuItem",e.AnalyticsChannelDropdown="AnalyticsChannelDropdown",e.AnalyticsButtonCrossTeamName="AnalyticsButtonCrossTeamName",e.AnalyticsButtonCrossTeamPeopleCount="AnalyticsButtonCrossTeamPeopleCount",e.AnalyticsButtonPerTeamToCross="AnalyticsButtonPerTeamToCross",e.AnalyticsButtonChannelToTeam="AnalyticsButtonChannelToTeam",e.AppBar="AppBar",e.AppearanceSettings="AppearanceSettings",e.AppProfileCard="AppProfileCard",e.AppSwitchConfirmationPage="AppSwitchConfirmationPage",e.AppSwitcher="AppSwitcher",e.AuthApp="AuthApp",e.Authentication="Authentication",e.AutoBrb="AutoBrb",e.Autosuggest="Autosuggest",e.Avatar="Avatar",e.AvatarCoachmark="AvatarCoachmark",e.BannerNotification="BannerNotification",e.BlockChat="BlockChat",e.BrbForm="BrbForm",e.Breadcrumb="Breadcrumb",e.BreakoutRoomsCreateButton="BreakoutRoomsCreateButton",e.BreakoutRoomsPanel="BreakoutRoomsPanel",e.BreakoutRoomsRecreateButton="BreakoutRoomsRecreateButton",e.BreakoutRoomsSettingPresenter="BreakoutRoomsSettingPresenter",e.BroadcastInfoPanelButton="BroadcastInfoPanelButton",e.BroadcastInfoPanelContainer="BroadcastInfoPanelContainer",e.BroadcastLeaveScreen="BroadcastLeaveScreen",e.BroadcastQnaPanelButton="BroadcastQnaPanelButton",e.BroadcastQnaPanelWrapper="BroadcastQnaPanelWrapper",e.Calendar="Calendar",e.CalendarAnswer="CalendarAnswer",e.CalendarEventAction="CalendarEventAction",e.CalendarSettings="CalendarSettings",e.CalendarSyncBanner="CalendarSyncBanner",e.CallDebug="CallDebug",e.CallHealthButton="CallHealthButton",e.CallSettings="CallSettings",e.CallSettingsHeader="CallSettingsHeader",e.Calling="Calling",e.CallingAlert="CallingAlert",e.CallingAppEvent="CallingAppEvent",e.CallingBreakoutRoomsWrapper="CallingBreakoutRoomsWrapper",e.CallingDeeplinkDialog="CallingDeeplinkDialog",e.CallingCameraEffectsPanelWrapper="CallingCameraEffectsPanelWrapper",e.CallingCustomVideoBackgroundsPanelContainer="CallingCustomVideoBackgroundsPanelContainer",e.CallingCustomVideoBackgroundsPanelWrapper="CallingCustomVideoBackgroundsPanelWrapper",e.CallingDevicesPanelWrapper="CallingDevicesPanelWrapper",e.CallingEndScreen="CallingEndScreen",e.CallingEndScreenPostMeetingChat="CallingEndScreenPostMeetingChat",e.CallingOnBeforeDeeplinkParsed="CallingOnBeforeDeeplinkParsed",e.CallingPreJoinEffectsAndAvatarsButton="CallingPreJoinEffectsAndAvatarsButton",e.CallingPreJoinScreenCancelButton="CallingPreJoinScreenCancelButton",e.CallingPrejoinScreenHideAllPanels="CallingPrejoinScreenHideAllPanels",e.CallingPreJoinScreenVideoEffectsButton="CallingPreJoinScreenVideoEffectsButton",e.CallingRosterWrapper="CallingRosterWrapper",e.CallingScreen="CallingScreen",e.CallingScreenErrorBoundary="CallingScreenErrorBoundary",e.CallingScreenHideAllPanels="CallingScreenHideAllPanels",e.CallMonitor="CallMonitor",e.CallsHeaderRenderer="CallsHeaderRenderer",e.CallTransferButton="CallTransferButton",e.CameraEffectsButton="CameraEffectsButton",e.CameraEffectsPrejoinPanelButton="CameraEffectsPrejoinPanelButton",e.CameraEffectsVideoPreviewButton="CameraEffectsVideoPreviewButton",e.CampaignNotification="CampaignNotification",e.Card="Card",e.CastWizard="CastWizard",e.CDLWorker="CDLWorker",e.ChannelContextualSearch="ChannelContextualSearch",e.ChannelDashboardHeader="ChannelDashboardHeader",e.ChannelDeleteOrUserNotMember="ChannelDeleteOrUserNotMember",e.ChannelEmail="ChannelEmail",e.ChannelHeader="ChannelHeader",e.ChannelInfoPane="ChannelInfoPane",e.ChannelInfoPaneExpanded="ChannelInfoPaneExpanded",e.ChannelLeaveContextMenuButton="ChannelLeaveContextMenuButton",e.ChannelList="ChannelList",e.ChannelListItem="ChannelListItem",e.ChannelPostMessage="ChannelPostMessage",e.ChannelPreStateScheduleMeetingDetailsMenuContextButton="ChannelPreStateScheduleMeetingDetailsMenuContextButton",e.ChannelRepliesPane="ChannelRepliesPane",e.ChannelSettings="ChannelSettings",e.ChannelInvitations="ChannelInvitations",e.ChatAddMembers="ChatAddMembers",e.ChatBubbles="ChatBubbles",e.ChatButton="ChatButton",e.ChatCallButton="ChatCallButton",e.ChatChattingWithMtoUserBanner="ChatChattingWithMtoUserBanner",e.ChatClaimed="ChatClaimed",e.ChatClaimLink="ChatClaimLink",e.ChatContextualSearch="ChatContextualSearch",e.ChatDeeplinkId="ChatDeeplinkId",e.ChatDeeplinkMessage="ChatDeeplinkMessage",e.ChatDeeplinkUsers="ChatDeeplinkUsers",e.ChatDeprovisioned="ChatDeprovisioned",e.ChatDisabledComposeLink="ChatDisabledComposeLink",e.ChatDiscardConversation="ChatDiscardConversation",e.ChatEmbedSdk="ChatEmbedSdk",e.ChatError="ChatError",e.ChatEscalation="ChatEscalation",e.ChatHeader="ChatHeader",e.ChatHighlightsDetails="ChatHighlightsDetails",e.ChatInfoPane="ChatInfoPane",e.ChatInfoPaneButton="ChatInfoPaneButton",e.ChatInfoPaneDetails="ChatInfoPaneDetails",e.ChatInviteConfirmationDialog="ChatInviteConfirmationDialog",e.ChatInviteLink="ChatInviteLink",e.ChatJoinShareButton="ChatJoinShareButton",e.ChatListFilterItem="ChatListFilterItem",e.ChatListItem="ChatListItem",e.ChatListItemBlockChatButton="ChatListItemBlockChatButton",e.ChatListItemDeleteChatButton="ChatListItemDeleteChatButton",e.ChatListItemDiscardButton="ChatListItemDiscardButton",e.ChatListItemInviteLinkButton="ChatListItemInviteLinkButton",e.ChatListItemMenuLeaveButton="ChatListItemMenuLeaveButton",e.ChatListItemMenuPinButton="ChatListItemMenuPinButton",e.ChatListMeetingItem="ChatListMeetingItem",e.ChatListSuggestedContact="ChatListSuggestedContact",e.ChatMeetingChiclet="ChatMeetingChiclet",e.ChatPane="ChatPane",e.ChatPopOutNewChat="ChatPopOutNewChat",e.ChatRailHeader="ChatRailHeader",e.ChatResolveConversationLie="ChatResolveConversationLie",e.ChatRoster="ChatRoster",e.ChatSendMessage="ChatSendMessage",e.ChatSendMessageRetry="ChatSendMessageRetry",e.ChatViewDeeplink="ChatViewDeeplink",e.ChatWith="ChatWith",e.ChatWithUser="ChatWithUser",e.ChatProtocolDeeplink="ChatProtocolDeeplink",e.ClosedCaptionsSettingsPanelWrapper="ClosedCaptionsSettingsPanelWrapper",e.CodeSnippetDiscardButton="CodeSnippetDiscardButton",e.CommunitiesAddMember="CommunitiesAddMember",e.CommunitiesEventsButton="CommunitiesEventsButton",e.CommunitiesCreateEventButton="CommunitiesCreateEventButton",e.CommunitiesInviteLink="CommunitiesInviteLink",e.CommunitiesGuidelinesDialog="CommunitiesGuidelinesDialog",e.CommunitiesGetAppDialog="CommunitiesGetAppDialog",e.CommunitiesCreateDialog="CommunitiesCreateDialog",e.CommunitiesSendPostAsEmailDialog="CommunitiesSendPostAsEmailDialog",e.CommunitiesShareFeedbackButton="CommunitiesShareFeedbackButton",e.CommunitiesManage="CommunitiesManage",e.ComposeChat="ComposeChat",e.ComposeChatDisabled="ComposeChatDisabled",e.ConnectedCalendarStatusBanner="ConnectedCalendarStatusBanner",e.ContactsSyncBanner="ContactsSyncBanner",e.ContactsSyncDialog="ContactsSyncDialog",e.ContactsSyncMobileSyncDialog="ContactsSyncMobileSyncDialog",e.ContentCameraSettingsButton="ContentCameraSettingsButton",e.ConveneOnBeforeDeeplinkParsed="ConveneOnBeforeDeeplinkParsed",e.Conversation="Conversation",e.Core="Core",e.CoreResolvers="CoreResolvers",e.CrossPostDeleteDialogButton="CrossPostDeleteDialogButton",e.CrossPostSelectChannelsButton="CrossPostSelectChannelsButton",e.CustomVideoBackgroundsPanelButton="CustomVideoBackgroundsPanelButton",e.CustomVideoBackgroundsPrejoinPanelButton="CustomVideoBackgroundsPrejoinPanelButton",e.CustomVideoBackgroundsVideoPreviewButton="CustomVideoBackgroundsVideoPreviewButton",e.DebugPanel="DebugPanel",e.DefaultChatNewChat="DefaultChatNewChat",e.DefaultChatNewGroup="DefaultChatNewGroup",e.DevicePanelButton="DevicePanelButton",e.Discover="Discover",e.DiscoverSurface="DiscoverSurface",e.DiscoverSurfaceDislikeFeedItemButton="DiscoverSurfaceDislikeFeedItemButton",e.DiscoverSurfaceEntry="DiscoverSurfaceEntry",e.DiscoverSurfaceL2BackButton="DiscoverSurfaceL2BackButton",e.Dlp="Dlp",e.DocumentCameraSharingButton="DocumentCameraSharingButton",e.DropInSpaces="DropInSpaces",e.EducationGuardians="EducationGuardians",e.EmbedBackButton="EmbedBackButton",e.EmbedDeeplink="EmbedDeeplink",e.EmergencyCallingSettingsSubpage="EmergencyCallingSettingsSubpage",e.Esp="Esp",e.ExtensionCommanding="ExtensionCommanding",e.ExternalCommand="ExternalCommand",e.FaceEnrollmentGetStartedButton="FaceEnrollmentGetStartedButton",e.FileDialog="FileDialog",e.FileViewer="FileViewer",e.FluidAltText="FluidAltText",e.FluidDiscardButton="FluidDiscardButton",e.FluidShareServicePermissionsCallback="FluidShareServicePermissionsCallback",e.Flyout="Flyout",e.FlyoutAuthLanding="FlyoutAuthLanding",e.FlyoutOnExperienceWarmJob="FlyoutOnExperienceWarmJob",e.FlyoutPrewarmJob="FlyoutPrewarmJob",e.FollowHybridRsvpNudgeUfd="FollowHybridRsvpNudgeUfd",e.GalleryImage="GalleryImage",e.GeneralSettings="GeneralSettings",e.GetLinkToCommunityButton="GetLinkToCommunityButton",e.GetTenantsFromSettings="GetTenantsFromSettings",e.GiveFeedbackChoices="GiveFeedbackChoices",e.GoogleAuthOnBeforeDeepLinkParsed="GoogleAuthOnBeforeDeepLinkParsed",e.HangupButton="HangupButton",e.Homepage="Homepage",e.InContextStore="InContextStore",e.InsertHyperlink="InsertHyperlink",e.InternalDeeplink="InternalDeeplink",e.KeyboardShortcut="KeyboardShortcut",e.KeypadButton="KeypadButton",e.LayoutError="LayoutError",e.LeaveGroupAndBlockUser="LeaveGroupAndBlockUser",e.LivePersonaCard="LivePersonaCard",e.LogsDownloading="LogsDownloading",e.LmsCourseCalendar="LmsCourseCalendar",e.LmsCourseTeams="LmsCourseTeams",e.LoopTryInSelfChatButton="LoopTryInSelfChatButton",e.M365ChatFeedback="M365ChatFeedback",e.ManageTeams="ManageTeams",e.ManageUserApps="ManageUserApps",e.ManageTeamDashboard="ManageTeamDashboard",e.MediaStreamsButton="MediaStreamsButton",e.MeetApp="MeetApp",e.MeetingBot="MeetingBot",e.MeetingCollabButton="MeetingCollabButton",e.MeetingDetailsButton="MeetingDetailsButton",e.MeetingDetailsPanelWrapper="MeetingDetailsPanelWrapper",e.MeetingInfoButton="MeetingInfoButton",e.MeetingInfoPanelWrapper="MeetingInfoPanelWrapper",e.MeetingNotesButton="MeetingNotesButton",e.MeetingOptions="MeetingOptions",e.MeetingRecapChatNavButton="MeetingRecapChatNavButton",e.MeetingRoomConsole="MeetingRoomConsole",e.MeetingRoomFrontOfRoom="MeetingRoomFrontOfRoom",e.MeetingRoomFrontOfRoomCallPanelsManager="MeetingRoomFrontOfRoomCallPanelsManager",e.MeetingRoomJoinByCodeButton="MeetingRoomJoinByCodeButton",e.MeetLauncher="MeetLauncher",e.MeshAvatarPanel="MeshAvatarPanel",e.MessageAction="MessageAction",e.MessageDraftDiscardButton="MessageDraftDiscardButton",e.MessageExtensionFlyout="MessageExtensionFlyout",e.MessageGiphyConsent="MessageGiphyConsent",e.MessageLeaveChatButton="MessageLeaveChatButton",e.MessageReaction="MessageReaction",e.MessageReadReceipt="MessageReadReceipt",e.MessageRemoveChatUserButton="MessageRemoveChatUserButton",e.MessageShareChatButton="MessageShareChatButton",e.MoreAvatarSettingsButton="MoreAvatarSettingsButton",e.MoreAvatarSettingsButtonInFlyout="MoreAvatarSettingsButtonInFlyout",e.MoreOptionsMenu="MoreOptionsMenu",e.MTMAChildWindowTenantName="MTMAChildWindowTenantName",e.MTMANotificationCard="MTMANotificationCard",e.NewChat="NewChat",e.Notifications="Notifications",e.NotificationSettings="NotificationSettings",e.Nova="Nova",e.OfficeIntegration="OfficeIntegration",e.OfficeIntegrationChat="OfficeIntegrationChat",e.OofSettings="OofSettings",e.OSFileShareEvent="OSFileShareEvent",e.PeripheralDeviceTeamsButtonShortPress="PeripheralDeviceTeamsButtonShortPress",e.PinUnpinPostConfirmButton="PinUnpinPostConfirmButton",e.PlatformAppDetailsDialog="PlatformAppDetailsDialog",e.PlatformExtension="PlatformExtension",e.PlatformPersonalAppHeader="PlatformPersonalAppHeader",e.PlatformPersonalAppDeepLink="PlatformPersonalAppDeepLink",e.PlatformTabDeepLink="PlatformTabDeepLink",e.PlatformTabHeader="PlatformTabHeader",e.PopOutButton="PopOutButton",e.PresenterToolbar="PresenterToolbar",e.PreviewButton="PreviewButton",e.RecordButton="RecordButton",e.ReplaceChatItemButton="ReplaceChatItemButton",e.ReportConcernCommunitiesButton="ReportConcernCommunitiesButton",e.ReportConcernCommunitiesDialog="ReportConcernCommunitiesDialog",e.ResolveConversation="ResolveConversation",e.RosterButton="RosterButton",e.SchedulingFormHeader="SchedulingFormHeader",e.SchoolTeams="SchoolTeams",e.Search="Search",e.SendChannelPost="SendChannelPost",e.SendChannelReply="SendChannelReply",e.SendChat="SendChat",e.Settings="Settings",e.SettingsHeader="SettingsHeader",e.ShareEmail="ShareEmail",e.ShareMeetingInviteDialog="ShareMeetingInviteDialog",e.ShareToTeamsMultiWindow="ShareToTeamsMultiWindow",e.ShareTray="ShareTray",e.ShellVersionCheck="ShellVersionCheck",e.ShellAuthState="ShellAuthState",e.ShellCDLServicesState="ShellCDLServicesState",e.ShellNetworkState="ShellNetworkState",e.SideloadedAppUploadButton="SideloadedAppUploadButton",e.SignOutEmbedClient="SignOutEmbedClient",e.SignOutLink="SignOutLink",e.Slimcore="Slimcore",e.SmartDeviceAvatarButton="SmartDeviceAvatarButton",e.SmartDeviceJoinByCodeBackButton="SmartDeviceJoinByCodeBackButton",e.SmartDeviceJoinByCodeButton="SmartDeviceJoinByCodeButton",e.StagingAppUploadButton="StagingAppUploadButton",e.StandAlone="StandAlone",e.StopMdpDataCollectionButton="StopMdpDataCollectionButton",e.Store="Store",e.StreamCameraButton="StreamCameraButton",e.Survey="Survey",e.SwitchAccountFromMeMenu="SwitchAccountFromMeMenu",e.SwitchAccountFromSettings="SwitchAccountFromSettings",e.TeamsAPIEventHandler="TeamsAPIEventHandler",e.TabConfigurationDialog="TabConfigurationDialog",e.TabInfoButton="TabInfoButton",e.TagCard="TagCard",e.TakeSnapshot="TakeSnapshot",e.TaskModuleDeeplink="TaskModuleDeeplink",e.TeamChannels="TeamChannels",e.TeamDashboardHeader="TeamDashboardHeader",e.TeamsGallery="TeamsGallery",e.TenantAppUploadButton="TenantAppUploadButton",e.TenantRedemption="TenantRedemption",e.TflFre="TflFre",e.Toast="Toast",e.TranscriptButton="TranscriptButton",e.TranscriptPanelButton="TranscriptPanelButton",e.TranscriptPanelWrapper="TranscriptPanelWrapper",e.TwoWaySmsFriendlyName="TwoWaySmsFriendlyName",e.UbarAccessibilityCoachmark="UbarAccessibilityCoachmark",e.UnifiedConsent="UnifiedConsent",e.UnifiedSearch="UnifiedSearch",e.Unknown="Unknown",e.UnlockTeam="UnlockTeam",e.UnpinChatItemButton="UnpinChatItemButton",e.UpdateGroupChatAvatarButton="UpdateGroupChatAvatarButton",e.UpdateTenantsFromSettings="UpdateTenantsFromSettings",e.VideoCallPreviewPopup="VideoCallPreviewPopup",e.VideoEffectsAndAvatarButton="VideoEffectsAndAvatarButton",e.VideoEffectsAndAvatarPanel="VideoEffectsAndAvatarPanel",e.VideoEffectsButton="VideoEffectsButton",e.VideoEffectsCustomizationButton="VideoEffectsCustomizationButton",e.VideoEffectsMoreViewPanel="VideoEffectsMoreViewPanel",e.VideoEffectsPickerMoreButton="VideoEffectsPickerMoreButton",e.VideoEffectsVideoAppPanel="VideoEffectsVideoAppPanel",e.VideoPreviewDeviceSettingsButton="VideoPreviewDeviceSettingsButton",e.VideoSharingButton="VideoSharingButton",e.VirtualEventDetails="VirtualEventDetails",e.VirtualEventsListItem="VirtualEventsListItem",e.WhiteboardCameraSharingButton="WhiteboardCameraSharingButton",e.YammerQnaButton="YammerQnaButton",e.YammerQnaContainer="YammerQnaContainer"}(i||(i={}))},798546:(e,t,n)=>{var i;n.d(t,{h:()=>i}),function(e){e.default="default"}(i||(i={}))},968862:(e,t,n)=>{var i;n.d(t,{R:()=>i}),function(e){e.flyout="flyout",e.iFrame="iFrame",e.primary="primary",e.secondary="secondary"}(i||(i={}))},131420:(e,t,n)=>{var i;n.d(t,{W:()=>i}),function(e){e.WindowReady="windowReady",e.WindowUnloaded="windowUnloaded",e.WindowAppStart="windowAppStart",e.CoreInitialized="coreInitialized",e.CommandChangeType="commandEvent",e.ExperienceStarted="experienceStarted",e.CoreInitializationFailed="coreInitializationFailed",e.ExtendedEntityContainerState="extendedEntityContainerState",e.MainWindowBlockedState="mainWindowBlockedState"}(i||(i={}))},61984:(e,t,n)=>{n.d(t,{k:()=>r,H:()=>o});var i=n(223283),s=n(507416);const r=-1;class o{constructor(){this.FractionalBuckets=1e3,this.ConvertToWholeDeviser=10,this.WholeNumberBuckets=100,this.DefaultCohort=0,this.DefaultSampleRate=100,this.rulesLookup={},this.cohortBoundary=this.DefaultCohort,this.telemetrySettings={},this.deviceId=null,this.userId=null,this.blockZeroSampleRate=!1,this.preAuthUserSamplingId=null,this.updateSamplingSettings=e=>{if(e){this.telemetrySettings=e;let t={};e.samplingRules&&(t=e.samplingRules,this.rulesLookup=t),this.setCohortBoundry(),this.blockZeroSampleRate=e.enableBlockZeroSampleRate}}}initialize(e){e.getObservable(i.J.Telemetry).subscribe(this.updateSamplingSettings),this.telemetrySettings=e.get(i.J.Telemetry),this.updateSamplingSettings(this.telemetrySettings)}static getInstance(){return this.eventSuppressionService||(this.eventSuppressionService=new o),this.eventSuppressionService}setSamplingByUser(e){this.userId||(this.userId=e,this.setCohortBoundry())}setSamplingByPreAuthId(e){this.preAuthUserSamplingId=e,this.setCohortBoundry()}setSamplingByDevice(e){this.deviceId=e,this.setCohortBoundry()}getCurrentCohort(){return this.cohortBoundary}shouldSuppressEvent(e,t="*"){return this.getSampleRate(e,t,"*")===r}getSampleRate(e,t="*",n="*"){const i=this.rulesLookup[e];if(void 0!==i){const e=void 0!==i[`${t}|${n}`]?i[`${t}|${n}`]:void 0!==i[t]?i[t]:void 0!==i[`*|${n}`]?i[`*|${n}`]:void 0!==i["*"]?i["*"]:this.DefaultSampleRate;if(0===e&&this.blockZeroSampleRate)return r;if(this.cohortBoundary!==this.DefaultCohort)return this.cohortBoundary>e?r:e}return this.DefaultSampleRate}setCohortBoundaryByIdType(e,t){return t&&t>r&&t<=this.DefaultSampleRate?void(this.cohortBoundary=t):e}setCohortBoundry(){if(this.cohortBoundary!==this.DefaultCohort)return;let e=null;const t=this.telemetrySettings;!this.userId&&t.enablePreAuthIdSampling?e=this.preAuthUserSamplingId:t.enableDeviceIdSampling?e=this.setCohortBoundaryByIdType(this.deviceId,this.telemetrySettings.deviceIdSampleCohort):t.enableUserIdSamplingV2&&(e=this.setCohortBoundaryByIdType(this.userId,this.telemetrySettings.userIdSampleCohort)),t.enablePreAuthIdSampling||t.enableDeviceIdSampling||t.enableUserIdSamplingV2?e&&(this.cohortBoundary=((0,s.E)(e)%this.FractionalBuckets+1)/this.ConvertToWholeDeviser):this.userId&&(this.cohortBoundary=(0,s.E)(this.userId)%this.WholeNumberBuckets+1)}}},682770:(e,t,n)=>{n.d(t,{G:()=>S});var i,s=n(122267),r=n(648465),o=n(325790),a=n(798546),l=n(360237);!function(e){e.Desktop="Desktop",e.Messaging="Messaging",e.Files="Files",e.Apps="Apps",e.Activity="Activity",e.Feeds="Feeds",e.Teams="Teams",e.CMD="CMD",e.Notifications="Notifications",e.Foundation="Foundation"}(i||(i={}));const d=new Map;d.set(l.RG.WindowLaunchTime,{featureArea:i.Foundation,customDimensions:["App"]});var c=n(223283),h=n(609e3),u=n(578790),C=n(61984);class _{constructor(){this.propagators={}}addCallback(e,t){const n=this.propagators[e];this.propagators[e]=n?Object.assign(Object.assign({},n),{callbacks:[...n.callbacks,t]}):{filters:void 0,usingCache:!1,cache:{},callbacks:[t]};const i=this.propagators[e];if(i){const{cache:e,usingCache:n}=i;n&&Object.keys(e).forEach((n=>{const i=e[n];i&&t(n,i[0],i[1])}))}}updateFilter(e,t,n=!1){const i=this.propagators[e];i?(i.filters=t,i.usingCache=n):this.propagators[e]={filters:t,usingCache:n,cache:{},callbacks:[]}}send(e,t,n){Object.keys(this.propagators).forEach((i=>{var s,r;const o=this.propagators[i];if(o){const a=o.filters;a?a.has(e)&&(o.usingCache&&(o.cache[e]=[t,n]),null===(s=this.propagators[i])||void 0===s||s.callbacks.forEach((i=>i(e,t,n)))):null===(r=this.propagators[i])||void 0===r||r.callbacks.forEach((i=>i(e,t,n)))}}))}}class p{constructor(e,t){this.router=e,this.coreSettings=t,this.categorySubscriptions=new Map}init(){this.channel=new MessageChannel,this.router.postMessage("initCoreSettingsWorker",void 0,[this.channel.port2]),this.registerListeners()}registerListeners(){this.channel&&(this.channel.port1.onmessage=e=>{const{data:t}=e;"settingsRequest"===t.type&&this.handleSettings(t.payload),"subscribeCategory"===t.type&&this.handleSubscription(t.payload),"unsubscribeCategory"===t.type&&this.handleUnsubscription(t.payload)})}handleSubscription({category:e}){if(this.categorySubscriptions.has(e))return;const t=this.coreSettings.getObservable(e).subscribe((t=>{var n;null===(n=this.channel)||void 0===n||n.port1.postMessage({type:"categorySubscriptionResponse",payload:{values:t,category:e}})}));this.categorySubscriptions.set(e,t)}handleUnsubscription({category:e}){const t=this.categorySubscriptions.get(e);t&&(t.unsubscribe(),this.categorySubscriptions.delete(e))}handleSettings({category:e,settings:t,id:n}){var i;const s=this.coreSettings.get(e),r={};null==t||t.forEach((e=>{r[e]=s[e]})),null===(i=this.channel)||void 0===i||i.port1.postMessage({type:"settingsResponse",payload:{values:r,id:n}})}}const g="default";class m{constructor(){this._contextPropagator=new _,this._sessionId="",this._silent=!1,this._sharedWorkerOptions={delayLoadingWorker:!1,isSharedWorkerEnabled:!1,isWorkerEnabled:!1},this._cachedOperation=[],this._workerInited=!1,this._capturingEventsForDiagnosticPanel=!1,this._capturingContextForDiagnosticPanel=!1,this._capturedEvents={},this._capturedContext={},this._primaryUserId="",this._primaryTenantId="",this._users=new Set,this.defaultLoggerName=a.h.default,(0,u.Y)((()=>{this._cachedOperation=[],this._sharedWorkerOptions.sharedWorkerUrl=void 0}))}getUsers(){return this._users}getPrimaryUserId(){return this._primaryUserId}getPrimaryTenantId(){return this._primaryTenantId}get sessionId(){return this._sessionId}startCapturingEventsAndContext(){this._capturingContextForDiagnosticPanel=!0,this._capturingEventsForDiagnosticPanel=!0}stopCapturingEventsAndContext(){this._capturingContextForDiagnosticPanel=!1,this._capturingEventsForDiagnosticPanel=!1}get capturedContext(){return this._capturedContext}get capturedEvents(){return this._capturedEvents}clearCapturedEvents(){this._capturedEvents={[g]:[]}}setCdlContextCallback(e){this._contextPropagator.addCallback("cdl",((t,n,i)=>{var s;e(t,null!==(s=null==n?void 0:n.toString())&&void 0!==s?s:"",i)}))}setMultiContextCallback(e){this._contextPropagator.addCallback("maglev",((t,n,i)=>{var s;e(t,null!==(s=null==n?void 0:n.toString())&&void 0!==s?s:"",i)}))}setEndpointHealth(e){this._getEndpointHealth=e}getEndpointHealth(e,t){var n;return this._getEndpointHealth?null===(n=this._getEndpointHealth(e,t))||void 0===n?void 0:n.isHealthy:void 0}setupReinitSubscriptions(e){var t;if(!this._initializeParams||!e.enableTelemetryRegionReinit)return;let n=!1;e.oneDsCollectorUrl&&this._initializeParams.oneDsCollectorUrl!==e.oneDsCollectorUrl&&(this._initializeParams.oneDsCollectorUrl=e.oneDsCollectorUrl,n=!0),e.telemetryServer&&this._initializeParams.config.collectorUrl!==e.telemetryServer&&(this._initializeParams.config.collectorUrl=e.telemetryServer,n=!0),void 0!==e.enableOneDsSdkNs&&this._initializeParams.enableOneDsSdkNs.toString()!==(null===(t=e.enableOneDsSdkNs)||void 0===t?void 0:t.toString())&&(this._initializeParams.enableOneDsSdkNs=e.enableOneDsSdkNs||!1,n=!0),e.defaultToken&&this._initializeParams.appTokens.default!==e.defaultToken&&(this._initializeParams.appTokens.default=e.defaultToken,n=!0),n&&(this._sendOrCacheOperation("flushForReinit",this._initializeParams),this.logReinitEvent()),void 0!==e.telemetryRegionFetchComplete&&null!==e.telemetryRegionFetchComplete&&this.setContext("telemetryRegionFetchComplete",e.telemetryRegionFetchComplete),e.telemetryRegion&&this.setContext("UserInfo.TelemetryRegion",e.telemetryRegion)}initialize(e,t,n,i,o){var a,l,d,h,u;const{createTelemetryWorkerFn:_}=e,g=(0,s.__rest)(e,["createTelemetryWorkerFn"]);this._initializeParams=g,this._initializeParams.defaultLoggerName=this.defaultLoggerName,this._silent=g.isSilent,this._sharedWorkerOptions.delayLoadingWorker=null!==(a=g.delayLoadingWorker)&&void 0!==a&&a,this._sharedWorkerOptions.isSharedWorkerEnabled=null!==(l=g.enableSharedWorker)&&void 0!==l&&l,this._capturingEventsForDiagnosticPanel=null===(d=g.debugMenuSettings)||void 0===d?void 0:d.debugMenuCaptureEvents,this._capturingContextForDiagnosticPanel=null===(h=g.debugMenuSettings)||void 0===h?void 0:h.debugMenuCaptureContext,t&&(this._consoleLogger=t,g.config.log=void 0,g.enableDebugTrace=!0);const{workerType:m,workerUrlCallback:S}=i;this.columnSuppressionService=o,this._router=_(m,S),this._setupWorker(this._router),this._sendOrCacheOperation("newLogger",{key:this.defaultLoggerName,value:g.appTokens.default}),this._sendOrCacheOperation("logSession",{name:this.defaultLoggerName,state:r.sM.STARTED,sessionId:g.sessionId,sessionStartTime:g.sessionStartTime}),this._sendOrCacheOperation("sessionId",g.sessionId),this._router.postMessage("initialize",g);const E=n.get(c.J.Telemetry),T=new Set(null!==(u=E.multiContextColumns)&&void 0!==u?u:[]),I=new Set(E.cdlMultiContextColumns);this._contextPropagator.updateFilter("maglev",T),this._contextPropagator.updateFilter("cdl",I,!0),g.documentInfo.deviceId&&C.H.getInstance().setSamplingByDevice(g.documentInfo.deviceId);if(n.getObservable(c.J.Telemetry).subscribe((e=>{this._updateSDKwithPrivacyGuard(e),this._updateSecondPartyTelemetryFlag(e),this.setupReinitSubscriptions(e)})),this.setContext("Session.TelemetryWorkerType",m),"shared"===m||"dedicated"===m){new p(this._router,n).init()}}createEvent(e,t,n,i,s,o){var a;const l=new r.kc;return l.name=e,l.eventType=t,l.timestamp=Date.now(),l.setProperty("EventInfo.BaseType",t),n&&(this._copyEventProperties(l,n,i),null===(a=this.columnSuppressionService)||void 0===a||a.applyColumnBlockingRules(e,null!=o?o:t,l,s),s&&l.setProperty(s.columnName,(0,h.XC)(s.packedData))),o&&l.setProperty("EventInfo.Identifier",o),l}flush(){return(0,s.__awaiter)(this,void 0,void 0,(function*(){return this._silent?new Promise(((e,t)=>{t()})):new Promise(((e,t)=>{this._router?(this._router.registerMessageHandler("flushed",(()=>{this._router&&this._router.unregisterMessageHandler("flushed"),e()})),this._router.postMessage("flush")):t()}))}))}logEvent(e,t,n=""){this._silent||(this._sendOrCacheOperation("logEvent",{key:e,value:t,userContextId:n}),this._addCapturedEvent(t,n))}initializeSecondPartyLogger(e,t,n=!1){this.enableSecondPartyTelemetry&&this._sendOrCacheOperation("newSecondPartyOneDsLogger",{key:e,value:{ingestionToken:t,useTeamsContext:n}})}logSecondPartyEvent(e,t){this.enableSecondPartyTelemetry&&!this._silent&&this._sendOrCacheOperation("logSecondPartyEvent",{key:e,value:t})}initializeLogger(e,t){this._sendOrCacheOperation("newLogger",{key:e,value:t})}logOutUser(e){e&&(this._sendOrCacheOperation("logOutUser",{userContextId:e}),this._users.delete(e))}setPrimaryUser(e,t){e&&(this._primaryUserId=e,this._primaryTenantId=t,this._users.has(e)||this._users.add(e),this._sendOrCacheOperation("setPrimaryUser",{userContextId:e,userTenantId:t}))}setContext(e,t,n,i){var s;if("UserInfo.Id"===e&&"string"==typeof t&&(C.H.getInstance().setSamplingByUser(t),t&&!this._users.has(t)&&this._users.add(t)),!(null===(s=this.columnSuppressionService)||void 0===s?void 0:s.isContextColumnOk(e)))return;const r=(0,h.XC)(null!=t?t:"");this._sendOrCacheOperation("setContext",{key:e,value:r,pii:n,userContextId:i}),this._addCapturedContext(e,r,i),this._contextPropagator.send(e,t,i)}setPrivacyGuardUserInfo(e,t){this._sendOrCacheOperation("setPrivacyGuardUserInfo",{userNames:e,upns:t})}setDeviceAuthToken(e){this._sendOrCacheOperation("setDeviceAuthToken",e)}start(){this._silent||this._sendOrCacheOperation("start")}stop(){this._silent||this._sendOrCacheOperation("stop")}sendPulsarSignal(e){this._sendOrCacheOperation("pulsarSignal",e)}registerPulsarBackchannelListener(e){var t;null===(t=this._router)||void 0===t||t.registerMessageHandler("pulsarSignal",e)}Verbose(e){this._consoleLogger&&this._consoleLogger.debug(e)}Error(e){this._consoleLogger&&this._consoleLogger.error(e)}Info(e){this._consoleLogger&&this._consoleLogger.debug(e)}_addCapturedEvent(e,t){const n=5e3;this._capturingEventsForDiagnosticPanel&&(t&&!this._capturedEvents[t]?this._capturedEvents[t]=[]:t||this._capturedEvents.default||(this._capturedEvents.default=[]),this._capturedEvents[t||g].unshift(e),this._capturedEvents[t||g].length>=n&&(this._capturedEvents[t||g].length=n-Math.floor(500)))}_addCapturedContext(e,t,n){this._capturingContextForDiagnosticPanel&&e&&(n&&!this._capturedContext[n]?this._capturedContext[n]={}:n||this._capturedContext.default||(this._capturedContext.default={}),this._capturedContext[n||g][e]=t)}_setupWorker(e){return e.registerMessageHandler("sessionId",(e=>{this._sessionId=null==e?void 0:e.value})),e.registerMessageHandler("batchDone",(()=>{this._workerInited=!0})),e.registerMessageHandler("workerInitialized",(()=>{this._cachedOperation.length>0&&this._router&&(this._router.postMessage("batch",this._cachedOperation),this._cachedOperation=[])})),e.registerMessageHandler("error",(e=>{this.Error(e)})),e.registerMessageHandler("info",(e=>{this.Info(e)})),e.registerMessageHandler("verbose",(e=>{this.Verbose(e)})),e}logReinitEvent(){const e="loggingns",t="instrumentation_reinit",n="info",i=C.H.getInstance().getSampleRate(e,t,n);if(i===C.k)return;const s=this.createEvent(e,t,{message:"Triggering logger reinit",sampleRate:i,"EventInfo.Identifier":t,logLevel:n});this.logEvent(a.h.default,s)}static getInstance(){return this.telemetryProviderInstance||(this.telemetryProviderInstance=new m),this.telemetryProviderInstance}_sendOrCacheOperation(e,t){this._workerInited&&this._router?(this._cachedOperation.length>0&&(this._router.postMessage("batch",this._cachedOperation),this._cachedOperation=[]),this._router.postMessage(e,t)):this._cachedOperation.push({name:e,params:t})}_copyEventProperties(e,t,n){let i=null;for(const n in t)t.hasOwnProperty(n)&&(i=t[n],null!=i&&""!==i&&("object"==typeof i&&i.hasOwnProperty("piiKind")&&i.hasOwnProperty("value")&&i.piiKind in o.A4?e.setProperty(n,(0,h.XC)(i.value),i.piiKind):e.setProperty(n,(0,h.XC)(i))));if(n){const t=d.get(e.eventType);t&&this._copyMonitoringData(e,t,n)}}_copyMonitoringData(e,t,n){const i=[void 0,void 0,void 0],s=t.customDimensions.length;e.setProperty("Scenario.Priority",n.scenarioPriority),n.scenarioErrorCode&&e.setProperty("Scenario.ErrorCode",n.scenarioErrorCode),n.data.forEach((n=>{n.value&&e.setProperty(this._createMonitoringKey(t.featureArea,n.key),n.value);const s=t.customDimensions.findIndex((e=>e===n.key));s>0&&s<3&&(i[s]=n.value)}));let r="";for(let e=0;e<s;e++){const t=void 0===i[e]?"":i[e];r=e===s-1?`${r}${t}`:`${r}${t},`}e.setProperty("CombinedMonitoringDimensions",r)}_createMonitoringKey(e,t){return`QoS.${e}_${t}`}_updateSecondPartyTelemetryFlag(e){this.enableSecondPartyTelemetry=Boolean(e.enableSecondPartyTelemetry)}_updateSDKwithPrivacyGuard(e){var t,n;if(e&&(null===(t=this._initializeParams)||void 0===t?void 0:t.enableOneDsSdkNs)){const t=!!e.enablePrivacyGuard;t!==(null===(n=this._initializeParams)||void 0===n?void 0:n.enablePrivacyGuard)&&(this._initializeParams.enablePrivacyGuard=t,this._sendOrCacheOperation("updateSDKWithPrivacyGuard",t))}}}const S=()=>m.getInstance()},621290:(e,t,n)=>{n.d(t,{G:()=>s});var i=n(165828);class s extends Error{get extensions(){return this.getExtensions()}constructor({type:e,code:t,message:n,prevError:i,userContextId:s}){var r;super(n),this.type=e,this.code=t,this.prevError=i,this.userContextId=s;const o=function(e){var t;return null!==(t=null==e?void 0:e.split("\n").slice(1))&&void 0!==t?t:[]}(null!==(r=null==i?void 0:i.stack)&&void 0!==r?r:this.stack);this.stack=[`${t} Error: ${n}`,...o].join("\n"),Object.setPrototypeOf(this,new.target.prototype)}static isFunction(e){return"function"==typeof e}getBoundaryProps(){return{title:`default_${this.type.toLowerCase()}_title`,description:`default_${this.type.toLowerCase()}_description`}}toTelemetryEntry(){var e,t;let n=this.toTelemetryCode(),r=this.prevError;for(;r;)r instanceof s&&s.isFunction(r.toTelemetryEntry)?(n+=r.toTelemetryEntry(),r=void 0):(0,i.a)(r)?(n+=`[IError::${r.code}]`,r=null!==(e=r.innerError)&&void 0!==e?e:null===(t=r.reason)||void 0===t?void 0:t.innerError):(n+=`[Error::${r.message}]`,r=void 0);return n}toJSON(){return{type:this.type,code:this.code,stack:this.stack,userContextId:this.userContextId,prevError:this.prevError}}serialize(){const e=new WeakSet;return JSON.stringify(this,((t,n)=>{if("object"==typeof n&&null!==n){if(e.has(n))return;e.add(n)}return n}))}deserialize(e){this.stack=e.stack}toTelemetryCode(){return`[${this.type}::${this.code}]`}getExtensions(){return{type:this.type,code:this.code,prevError:this.prevError,boundaryProps:this.getBoundaryProps()}}}},182156:(e,t,n)=>{n.d(t,{$:()=>i,G:()=>d});var i,s=n(621290),r=n(290146),o=n(165828);!function(e){e.CDL_WORKER_FAILURE="CDL_WORKER_FAILURE",e.CLEANUP="CLEANUP",e.CORE_SERVICES_MISSING="CORE_SERVICES_MISSING",e.CREATE_USER_CONTEXT_FAILED_GENERIC="CREATE_USER_CONTEXT_FAILED_GENERIC",e.CREATE_WINDOW_WRAPPER="CREATE_WINDOW_WRAPPER",e.DISABLED_BY_ADMIN="DISABLED_BY_ADMIN",e.EXPERIENCE_DISABLED="EXPERIENCE_DISABLED",e.GET_CURRENT_CLOUD_FAILED="GET_CURRENT_CLOUD_FAILED",e.INVALID_INTENT_OVERRIDE="INVALID_INTENT_OVERRIDE",e.LAUNCH_CLOUD_DEEPLINK_ERROR="LAUNCH_CLOUD_DEEPLINK_ERROR",e.LAYOUT_ERROR="LAYOUT_ERROR",e.LAYOUT_ERROR_USER_BLOCKED="LAYOUT_ERROR_USER_BLOCKED",e.LAYOUT_PHASE_STATE_MACHINE_TIMEOUT="LAYOUT_PHASE_STATE_MACHINE_TIMEOUT",e.NETWORK_OFFLINE="NETWORK_OFFLINE",e.NETWORK_OFFLINE_USER_BLOCKED="NETWORK_OFFLINE_USER_BLOCKED",e.RENDERING_CONTEXT_DOES_NOT_EXIST="RENDERING_CONTEXT_DOES_NOT_EXIST",e.UNKNOWN="UNKNOWN",e.TELEMETRY_PRIMARY_USER_SET_FAILURE="TELEMETRY_PRIMARY_USER_SET_FAILURE",e.USER_DOES_NOT_EXIST="USER_DOES_NOT_EXIST",e.USER_NOT_AUTHENTICATED="USER_NOT_AUTHENTICATED",e.USERCONTEXTID_EMPTY="USERCONTEXTID_EMPTY",e.WINDOW_UNDEFINED="WINDOW_UNDEFINED"}(i||(i={}));const a={CDL_WORKER_FAILURE:"Cdl worker did not start up properly.",DISABLED_BY_ADMIN:"Please switch back to classic Teams.",EXPERIENCE_DISABLED:"We can't wait to show you the new Teams, but we're not quite ready for you. We'll let you know when it's time.",LAYOUT_PHASE_STATE_MACHINE_TIMEOUT:"Layout phase state machine has timed out triggering a view tear down.",TELEMETRY_PRIMARY_USER_SET_FAILURE:"This can result from a failure to load the PIE api, a failure to call maglev, or a failure to set primary user in the telemetry web worker"},l={CREATE_USER_CONTEXT_FAILED_GENERIC:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART","SIGN_OUT"]},DISABLED_BY_ADMIN:{title:"default_disabledbyadmin_title",description:"default_disabledbyadmin_description",actions:["SWITCH_TO_CLASSIC","SIGN_OUT"],icon:r.P.NoLongerAllowed},EXPERIENCE_DISABLED:{title:"default_experiencedisabled_title",description:"default_experiencedisabled_description",actions:["SIGN_OUT"],icon:r.P.NoLongerAllowed},LAYOUT_PHASE_STATE_MACHINE_TIMEOUT:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART"]},NETWORK_OFFLINE:{title:"default_nonetwork_title",description:"error_nonetwork_text"},NETWORK_OFFLINE_USER_BLOCKED:{title:"default_nonetwork_title",description:"error_nonetwork_text",actions:["RESTART"]},CDL_WORKER_FAILURE:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART"]},LAYOUT_ERROR:{title:"default_unknown_title",description:"",actions:[]},LAYOUT_ERROR_USER_BLOCKED:{title:"default_unknown_title",description:"",actions:["RESTART"]},RENDERING_CONTEXT_DOES_NOT_EXIST:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART","SIGN_OUT"]},USER_DOES_NOT_EXIST:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART","SIGN_OUT"]}};class d extends s.G{constructor(e,t,n){var i,s,r,l,d;super({type:"CoreError",code:e,message:null!==(i=a[e])&&void 0!==i?i:(0,o.a)(t)?null!==(r=null===(s=t.innerError)||void 0===s?void 0:s.message)&&void 0!==r?r:null===(d=null===(l=t.reason)||void 0===l?void 0:l.innerError)||void 0===d?void 0:d.message:null==t?void 0:t.message,prevError:t,userContextId:n})}getBoundaryProps(){var e;return null!==(e=l[this.code])&&void 0!==e?e:{title:"default_core_title",description:"default_core_description"}}static fromSerialized(e){if("CoreError"!==(null==e?void 0:e.type))return null;const t=new d(e.code,e.prevError,e.userContextId);return t.deserialize(e),t}}},403623:(e,t,n)=>{n.d(t,{Y:()=>s});var i=n(621290);class s extends i.G{constructor(e,t){super({type:"TrustedTypeError",code:e,prevError:t})}}},165828:(e,t,n)=>{function i(e){const t=e;return"string"==typeof(null==t?void 0:t.code)}n.d(t,{a:()=>i})},578830:(e,t,n)=>{n.d(t,{n:()=>re});var i=n(131420),s=n(216528),r=n(968862),o=n(407878),a=n(170315),l=n(155974);class d{constructor(e,t){this.shellComms=e,this.globalWindow=t,this.defaultRequestTimeoutMs=3e4,this.bufferInTimeout=5e3}postMessage(e,t){const n={eventId:e,payload:t,correlationId:(0,o.v4)()};this.shellComms.postMessage(n)}requestMessage(e,t,n=this.defaultRequestTimeoutMs){let i;const s=(0,o.v4)(),r=((null==t?void 0:t.timeout)||n)+this.bufferInTimeout;return new Promise(((n,o)=>{const d=t=>{this.globalWindow.clearTimeout(i),t&&!t.error?n(t.payload):o((0,a.Tr)(l.w5.ShellService,l.jK.RemoteOperationFailed,"requestMessage",{eventName:e,error:t&&t.error,correlationId:s},"Received an error from IPC"))};i=this.globalWindow.setTimeout((()=>{this.shellComms.remove(e,d),o((0,a.Tr)(l.w5.ShellService,l.jK.TimedOut,"requestMessage",{eventName:e,correlationId:s}))}),r),this.shellComms.once(e,d,s);const c={eventId:e,correlationId:s,payload:t};this.shellComms.postMessage(c)}))}addEventListener(e,t,n){n&&n.once?this.shellComms.once(e,t):this.shellComms.on(e,t)}removeEventListener(e,t){t?this.shellComms.remove(e,t):this.shellComms.removeAll(e)}open(e,t,n){const i={openType:e,openHandler:t,handlerParams:n};this.postMessage("requestShellToOpen",i)}}class c{constructor(e,t,n){this._globalWindow=e,this.shellComms=t,this.envPerformance={getBlinkMemoryInfo:()=>{},getJSHeapStatistics:()=>{},getMallocMemoryUsage:()=>{},getProcessMemoryInfo:()=>{},getWebCacheInfo:()=>{}};const{isInCypressFrame:i,isInIframe:o}=n;let a=s.QP.standAlone;this.viewportContext=r.R.primary,o&&!i?(a=s.QP.iframe,this.viewportContext=r.R.iFrame):null!==this._globalWindow.opener&&(a=s.QP.secondary,this.viewportContext=r.R.secondary),this._hostedWindowContext=Object.assign(Object.assign({},n),{panelContext:a,startReason:s.zF.userInitiated,__webpack_public_path__:this._globalWindow.__webpack_public_path__}),this.opener=new d(this.shellComms,this._globalWindow)}getHostedWindowContext(){return this._hostedWindowContext}onAppStart(){}setTimeout(...e){return this._globalWindow.setTimeout(...e)}clearTimeout(...e){return this._globalWindow.clearTimeout(...e)}}var h=n(873588),u=n(801017);var C=n(715425);class _{constructor(e,t){this.getObservableOn=e=>{const t=this.observableCache,n=t.get(e);if(n)return n;const i=new C.xQ;return t.set(e,i),i},this.next=e=>{this.logger.debug("Incoming message received. Filtering through cached observables.");const t=e.metaData.destination.channel,n=this.observableCache.get(t);n&&n.next(e)},this.error=e=>{const t=e.message?e.message:e;this.logger.error(`Internal Message Source emitted an error - {${t}}. Completing then clearing all observables from cache...`),this.completeAndClearCache()},this.complete=()=>{this.logger.debug("Internal Message Source completed. Completing then clearing all observables from cache..."),this.completeAndClearCache()},this.completeAndClearCache=()=>{this.observableCache.forEach((e=>e.complete())),this.observableCache.clear(),this.logger.debug("Cache cleared")},this.logger=t,this.observableCache=new Map,e.subscribe(this)}}const p="multi-window-manager-channel";var g=n(330924),m=n(790335),S=n(458281);const E=/^https:\/\/local\.teams\.(office|live)\.com(:8080)?$/;function T(e,t){return t.some((t=>{if(t.startsWith("regex:")){const n=t.replace("regex:","");return new RegExp(n).test(e)}return t===e}))}function I(e){return E.test(new URL(e).origin)}const v=(e,t,n,i)=>g.y.create((s=>{e.addEventListener("message",(e=>{const{eventId:r,channel:o}=e.data;e&&r&&o===p&&function(e,t,n){var i,s,r;const o=n.newLogger("PostMessage origin validation"),a=e.origin;return t?!("*"!==t&&!I(a)&&((0,S.isArray)(t)?0===t.length?(null===(i=o.errorToTelemetry)||void 0===i||i.call(o,"PostMessage is disabled for this experience. (case 5)","core_origin_validation_failed",{message:a},!0),1):!T(a,t)&&(null===(s=o.errorToTelemetry)||void 0===s||s.call(o,"Event origin is not in allow-list. Event was dropped. (case 4)","core_origin_validation_failed",{message:a},!0),1):(null===(r=o.errorToTelemetry)||void 0===r||r.call(o,"Could not match the event origin. Event was dropped. (case 6)","core_origin_validation_failed",{message:a},!0),1))):(o.debug("PostMessage is enabled for backwards compatibility. No postMessageConfig is set on this experience. https://aka.ms/tmp-post-message-config (case1 )"),!0)}(e,n.postMessageConfig,i)&&(t.debug("Incoming message from post messages"),s.next(e.data))}))})).pipe((0,m.B)());class f{constructor(e,t,n,i){this.opt=i,this.postMessage=e=>{var t,n;if((0,S.isArray)(this.opt.postMessageConfig)&&0===this.opt.postMessageConfig.length)return void(null===(n=(t=this.logger).errorToTelemetry)||void 0===n||n.call(t,"postMessageConfig is set to empty array. No outgoing post messages are allowed","core_origin_validation_failed",void 0,!0));this.logger.log("Sending targeted message to host browser only");const i=null!==e.payload&&"object"==typeof e.payload?Object.assign({},e.payload):{payload:e.payload};this.windowReference.parent.postMessage({channel:p,payload:Object.assign(Object.assign({},i),{channel:e.channel})},((e,t,n)=>{const i=new URL(e.location.href).origin;let s;if(!t||"*"===t)return"*";if(e.document.referrer)try{s=new URL(e.document.referrer).origin}catch(t){n.error(`Invalid referrer: ${e.document.referrer}`)}return s?s===i||I(s)||T(s,t)?s:(n.error(`Invalid target origin (${s}). Source origin (${i}) was returned as target origin.`),i):(n.log(`Could not determine target origin. Falling back to source origin: ${i}`),i)})(this.windowReference,this.opt.postMessageConfig,this.logger))},this.broadcast=()=>{},this.asObservable=e=>this.shellChannelCache.getObservableOn(e).pipe((0,u.U)((e=>(e=>({channel:e.metaData.destination.channel,payload:e.payload}))(e)))),this.createShellChannelCache=(e,t,n,i)=>{t.debug("Creating Shell Channel cache");const s=v(e,t,n,i);return new _(s,t)},this.logger=n.newLogger("RndrShComm"),this.processId=e,this.windowReference=t,this.shellChannelCache=this.createShellChannelCache(this.windowReference,this.logger,this.opt,n)}}const A="main_process",R="main_renderer";var b;!function(e){e[e.Request=0]="Request",e[e.Response=1]="Response"}(b||(b={}));var D=n(639087),y=n(581411),O=n(217133),P=n(372862),B=n(558621),N=n(196721),w=n(561333),M=n(718206),L=n(736695);const k=5*n(796502).gT.MILLI_PER_SECOND;class U{constructor(e,t,n){this.createResponseFunction=(e,t,n)=>i=>{const s=this.messagePassingService,r={direction:b.Response,responsePayload:i,procedureSignature:n},o={channel:t,payload:r};this.logger.log(`Sending response with signature: ${n}`),s.postMessage(o,[e])};if(3!==arguments.length||e.trim().length<=0)throw(0,a.Tr)("Invalid constructor arguments",l.jK.InvalidInput,typeof U);this.logger=n,this.messagePassingService=t,this.metaData={requestId:e}}send(e,t,n=k){const i=this.messagePassingService,s=this.metaData,r=i.processId,a=s.requestId,l=o.v4(),d=t?[t]:i.processId!==A?[A]:[R],c={channel:a,payload:{direction:b.Request,senderProcessId:r,procedureSignature:l,requestPayload:e}};this.logger.log(`Invoking procedure on ${t} with id, ${l}`);const h=(0,D.c)().pipe((0,P.x)((()=>i.postMessage(c,d)))),u=i.asObservable(a).pipe((0,B.h)((e=>e.payload.direction===b.Response)),(0,N.zg)((e=>{const t=e.payload;return t.procedureSignature===l?(0,y.of)(t.responsePayload):(0,D.c)()})));return(0,O.z)(h,u).pipe((0,w.P)(),(0,M.V)(n))}sendAsPromise(e,t,n=k){return this.logger.debug("Invoking procedure as promise"),new Promise(((i,s)=>{this.send(e,t,n).subscribe((e=>{i(e)}),(e=>{s(e)}))}))}asObservable(){const e=this.messagePassingService,t=this.metaData.requestId;return this.logger.debug("Retreiving observable on request-response procedure"),e.asObservable(t).pipe((0,B.h)((e=>e.payload.direction===b.Request)),(0,L.b)((e=>{this.logger.log(`Incoming request with signature - ${e.payload.procedureSignature}`)})),(0,u.U)((e=>{const n=e.payload,i=n.procedureSignature,s=n.requestPayload,r=n.senderProcessId;return{payload:s,respond:this.createResponseFunction(r,t,i)}})))}}var W=n(482248),F=n(796158),V=n(962741);class x{constructor(e,t,n){this.setState=e=>{const t=this.metaData,n={lastAuthorMetaData:t,newState:e};this.logger.debug(`Process, ${t.authorId}, is setting the state`),this.stateUpdateSource.next(n)},this.asObservable=()=>(this.logger.debug("Retreiving observable on the state"),this.distinctStateUpdates.pipe((0,u.U)((e=>e.newState)))),this.setupContinuousSyncronizationAcrossShellBoundary=()=>{const e=this.messagePassingService,t=this.metaData,n=this.logger,i=this.stateUpdateSource,s=this.distinctStateUpdates,r=t.storeId;s.pipe((0,B.h)((e=>e.lastAuthorMetaData.authorId===this.metaData.authorId)),(0,L.b)((()=>n.debug("Broadcasting state update")))).subscribe((t=>{const n={payload:t,channel:r};e.broadcast(n)})),e.asObservable(r).pipe((0,B.h)((e=>e.payload.lastAuthorMetaData.authorId!==t.authorId)),(0,L.b)((()=>n.log("State update incoming from message passing service")))).subscribe((e=>{i.next(e.payload)}))},this.setupInitialStateSynchronizationRequest=()=>{const e=this.metaData,t=this.distinctStateUpdates,n=this.messagePassingService,i=e.storeId,s=i.concat("-initial-sync-request");t.pipe((0,L.b)((()=>this.logger.debug("State updated. SwitchMapping to observable on incoming sync requests"))),(0,F.w)((()=>n.asObservable(s)),((e,t)=>{const n=t.payload.requesterMetaData.authorId;return{syncResponseMessage:{channel:i,payload:e},targetId:n}})),(0,L.b)((({targetId:e})=>this.logger.debug(`Incoming initial sync request from ${e}.`)))).subscribe((({syncResponseMessage:e,targetId:t})=>{n.postMessage(e,[t])}));const r={channel:s,payload:{requesterMetaData:e}};this.logger.debug("Sending out initial synchronization request..."),n.broadcast(r)};if(3!==arguments.length||e.trim().length<=0)throw(0,a.Tr)("Invalid constructor arguments",l.jK.InvalidInput,typeof x);const i=t.processId;this.logger=n,this.messagePassingService=t,this.metaData={storeId:e,authorId:i};this.stateUpdateSource=new W.t(1),this.distinctStateUpdates=this.stateUpdateSource.pipe((0,V.x)(((e,t)=>(0,S.isEqual)(e,t)))),this.setupContinuousSyncronizationAcrossShellBoundary(),this.setupInitialStateSynchronizationRequest()}}class G{constructor(e,t,n){if(3!==arguments.length||e.trim().length<=0)throw(0,a.Tr)("Invalid constructor arguments",l.jK.InvalidInput,typeof G);this.logger=n,this.messagePassingService=t,this.metaData={streamId:e}}next(e,...t){const n=this.metaData,i=this.messagePassingService,s=t&&t.length>0?t:this.messagePassingService.processId!==A?[A]:[R],r={channel:n.streamId,payload:e};this.logger.debug(`Invoking stream on targets: ${JSON.stringify(s)}.`),i.postMessage(r,s)}asObservable(){const e=this.messagePassingService,t=this.metaData.streamId;return e.asObservable(t).pipe((0,u.U)((e=>e.payload)),(0,L.b)((()=>{this.logger.debug("Handling stream event.")})))}}class H{constructor(e,t){if(this.getRequest=e=>new U(e,this.messagePassingService,this.loggerFactory.newLogger(`ShRqst${e}`)),this.getStream=e=>new G(e,this.messagePassingService,this.loggerFactory.newLogger(`ShStrm${e}`)),this.getStore=e=>new x(e,this.messagePassingService,this.loggerFactory.newLogger(`ShStr${e}`)),!e||!t)throw(0,a.Tr)(`sc: ${e}, lf: ${t}`,l.jK.Undefined,typeof H);this.messagePassingService=e,this.loggerFactory=t}}var K=n(212952),z=n(520923);class Y{constructor(e,t){if(this.windowReference=e,this.opt=t,!this.windowReference)throw(0,a.Tr)(l.w5.ShellService,l.jK.Undefined,"constructor");const n={error:()=>{},warn:()=>{},debug:()=>{},info:()=>{},log:()=>{}},i={newLogger:()=>n},s=new f("browserWindow",this.windowReference,i,this.opt);this.shellComms=new H(s,i),this.subscriptionManager=new C.xQ}postMessage(e){this.shellComms.getStream(e.eventId).next(e)}on(e,t,n=""){this.createSubscription(e,t,!1,n)}once(e,t,n=""){this.createSubscription(e,t,!0,n)}remove(e,t){this.subscriptionManager.next({channel:e,listener:t})}removeAll(e){this.subscriptionManager.next({channel:e})}createSubscription(e,t,n,i){const s=this.shellComms.getStream(e).asObservable().pipe(this.filterWrapper((e=>{var t;const n=(null==e?void 0:e.correlationId)||(null===(t=null==e?void 0:e.payload)||void 0===t?void 0:t.correlationId);return!e||!n||n===i}))),r=this.registerForUnsubscription(e,t);(n?s.pipe((0,K.q)(1),(0,z.R)(r)):s.pipe((0,z.R)(r))).subscribe((e=>{t({payload:e})}),(e=>{throw(0,a.Tr)(l.w5.ShellService,l.jK.RemoteOperationFailed,"createSubscription",{errorMsg:(0,a.B9)(e)})}))}registerForUnsubscription(e,t){return this.subscriptionManager.pipe(this.filterWrapper((n=>n.channel===e&&(void 0===n.listener||n.listener===t))))}filterWrapper(e){return(0,B.h)(e)}}class X{constructor(e,t){this.globalWindow=e,this.opt=t}configureShell(e){const t=this.globalWindow,n=this.createShellCommService(this.globalWindow,this.opt),i=new c(this.globalWindow,n,e);return{hostedWindowContext:i.getHostedWindowContext(),window:(0,h.So)(t,i,!1)}}createShellCommService(e,t){return new Y(e,t)}}class q{constructor(e,t,n,o){this.envPerformance=e,this._globalWindow=t,this.shellComms=n,this._hostedWindowContext=Object.assign(Object.assign({},o),{panelContext:s.QP.secondary,startReason:s.zF.userInitiated,__webpack_public_path__:this._globalWindow.__webpack_public_path__}),this.viewportContext=r.R.iFrame,this.opener=new d(n,this._globalWindow),this._globalWindow.addEventListener("unload",(()=>{this.shellComms.postMessage({eventId:i.W.WindowUnloaded})}))}getHostedWindowContext(){return this._hostedWindowContext}onAppStart(){const e={eventId:i.W.WindowAppStart};this.shellComms.postMessage(e)}setTimeout(...e){return this._globalWindow.setTimeout(...e)}clearTimeout(...e){return this._globalWindow.clearTimeout(...e)}}var $,j=n(797150);!function(e){e.WindowMinimize="child-window-minimize",e.WindowMaximize="child-window-maximize"}($||($={}));const Q="experience-renderer-channel";class J{constructor(e){this.ipcRenderer=e,this.onceListenerLookup={},this.listenerLookup={},this.ipcRenderer.on(Q,((e,t)=>{if(t&&t.eventId){const e=`${t.eventId}${t.correlationId||""}`;this.onceListenerLookup[e]?(this.onceListenerLookup[e].forEach((e=>e(t))),delete this.onceListenerLookup[e]):this.listenerLookup[e]&&this.listenerLookup[e].forEach((e=>{e(t)}))}}))}postMessage(e){switch(e.eventId){case j.rY.ActivityEvent:case j.rY.CreateWebview:case j.rY.GetWindowLaunchSubSteps:case j.rY.SetTouchBar:case j.rY.ClearTouchBar:case j.rY.ActivateOutlook:case j.rY.RequestTabMetrics:case j.rY.HasDevicePermissionsCallback:this.ipcRenderer.send(Q,e);break;case i.W.CoreInitialized:case j.rY.WindowInitialized:this.ipcRenderer.send(Q,e),this.ipcRenderer.sendToHost(Q,e);break;default:this.ipcRenderer.sendToHost(Q,e)}}on(e,t,n=""){const i=`${e}${n}`;this.listenerLookup[i]||(this.listenerLookup[i]=[]),this.listenerLookup[i].push(t)}once(e,t,n=""){const i=`${e}${n}`;this.onceListenerLookup[i]||(this.onceListenerLookup[i]=[]),this.onceListenerLookup[i].push(t)}remove(e,t){e&&t&&(this.onceListenerLookup[e]&&(this.onceListenerLookup[e]=this.onceListenerLookup[e].filter((e=>e!==t)),0===this.onceListenerLookup[e].length&&delete this.onceListenerLookup[e]),this.listenerLookup[e]&&(this.listenerLookup[e]=this.listenerLookup[e].filter((e=>e!==t)),0===this.listenerLookup[e].length&&delete this.listenerLookup[e]))}removeAll(e){delete this.onceListenerLookup[e],delete this.listenerLookup[e]}}class Z{constructor(e){this.windowHandle=e,this.ipcRenderer=this.windowHandle.desktop.ipcRenderer,this.webViewCommService=new J(this.ipcRenderer),this.browserShellCommService=new Y(e,{})}postMessage(e){switch(e.eventId){case j.rY.ActivityEvent:case j.rY.CreateWebview:case j.rY.GetWindowLaunchSubSteps:case j.rY.SetTouchBar:case j.rY.ClearTouchBar:this.ipcRenderer.send(Q,e);break;case i.W.CoreInitialized:case j.rY.WindowInitialized:this.ipcRenderer.send(Q,e),this.browserShellCommService.postMessage(e);break;default:this.browserShellCommService.postMessage(e)}}on(e,t,n=""){this.webViewCommService.on(e,t,n),this.browserShellCommService.on(e,t,n)}once(e,t,n=""){this.webViewCommService.once(e,t,n),this.browserShellCommService.once(e,t,n)}remove(e,t){this.webViewCommService.remove(e,t),this.browserShellCommService.remove(e,t)}removeAll(e){this.webViewCommService.removeAll(e),this.browserShellCommService.removeAll(e)}}class ee{constructor(e){this.globalWindow=e}configureShell(e){const t=this.globalWindow,{isInIframe:n}=e,i=this.extractPerformanceTooling(t),s=n?new Z(t):new J(t.desktop.ipcRenderer),r=new q(i,t,s,e);return Object.keys(t.desktop).forEach((e=>{"perf"!==e&&delete t.desktop[e]})),{hostedWindowContext:r.getHostedWindowContext(),window:(0,h.So)(t,r,!1)}}extractPerformanceTooling(e){return e.desktop.perf||{getBlinkMemoryInfo:()=>{},getJSHeapStatistics:()=>{},getMallocMemoryUsage:()=>{},getProcessMemoryInfo:()=>{},getWebCacheInfo:()=>{}}}}var te=n(344273);class ne{constructor(e){this.windowEnvironment=e}configure(e){const t={isInCypressFrame:ie(this.windowEnvironment),isInIframe:se(this.windowEnvironment)};t.isInIframe&&function(e){var t;if(e.navigator){if("Electron"===te.getParser(null===(t=e.navigator)||void 0===t?void 0:t.userAgent).getBrowserName())return!0}return!1}(this.windowEnvironment)&&function(e){var t;try{const n=e.parent;if(!n||!function(e){return!(!e||!e.electronSafeIpc)}(n))return;e.desktop={perf:null===(t=n.desktop)||void 0===t?void 0:t.perf,ipcRenderer:n.electronSafeIpc},e.createInterprocessStore=n.createInterprocessStore,e.vdiSettings=n.vdiSettings}catch(e){return}}(this.windowEnvironment);return(function(e){return!!(e&&e.desktop&&e.desktop.ipcRenderer)}(this.windowEnvironment)?new ee(this.windowEnvironment):new X(this.windowEnvironment,e)).configureShell(t)}}function ie(e){try{let t=!!e.Cypress;if(!t){const n=e.top||e.parent;t=!!(null==n?void 0:n.Cypress)}return t}catch(e){return!1}}function se(e){try{return e.self!==e.top}catch(e){return!0}}class re{constructor(){this._opt={};const e=new ne(window);this.config=e.configure(this._opt),this.config.window.opener.postMessage(i.W.WindowReady)}set opt(e){Object.keys(e).forEach((t=>{this._opt[t]=e[t]}))}static getInstance(){return re.instance||(re.instance=new re),re.instance}get window(){return this.config.window}}},94879:(e,t,n)=>{var i,s;n.d(t,{V:()=>i}),function(e){e[e.BT_STOP=0]="BT_STOP",e[e.BT_STOP_BASE=1]="BT_STOP_BASE",e[e.BT_BOOL=2]="BT_BOOL",e[e.BT_UINT8=3]="BT_UINT8",e[e.BT_UINT16=4]="BT_UINT16",e[e.BT_UINT32=5]="BT_UINT32",e[e.BT_UINT64=6]="BT_UINT64",e[e.BT_FLOAT=7]="BT_FLOAT",e[e.BT_DOUBLE=8]="BT_DOUBLE",e[e.BT_STRING=9]="BT_STRING",e[e.BT_STRUCT=10]="BT_STRUCT",e[e.BT_LIST=11]="BT_LIST",e[e.BT_SET=12]="BT_SET",e[e.BT_MAP=13]="BT_MAP",e[e.BT_INT8=14]="BT_INT8",e[e.BT_INT16=15]="BT_INT16",e[e.BT_INT32=16]="BT_INT32",e[e.BT_INT64=17]="BT_INT64",e[e.BT_WSTRING=18]="BT_WSTRING",e[e.BT_UNAVAILABLE=127]="BT_UNAVAILABLE"}(i||(i={})),function(e){e[e.MARSHALED_PROTOCOL=0]="MARSHALED_PROTOCOL",e[e.MAFIA_PROTOCOL=17997]="MAFIA_PROTOCOL",e[e.COMPACT_PROTOCOL=16963]="COMPACT_PROTOCOL",e[e.JSON_PROTOCOL=21322]="JSON_PROTOCOL",e[e.PRETTY_JSON_PROTOCOL=20554]="PRETTY_JSON_PROTOCOL",e[e.SIMPLE_PROTOCOL=20563]="SIMPLE_PROTOCOL"}(s||(s={}))},21384:(e,t,n)=>{n.d(t,{D:()=>i});class i{constructor(){this._buffer=[]}Add(e,t){-1==this._getIndex(e)&&this._buffer.push({Key:e,Value:t})}AddOrReplace(e,t){var n=this._getIndex(e);n>=0?this._buffer[n]={Key:e,Value:t}:this._buffer.push({Key:e,Value:t})}Remove(e){var t=this._getIndex(e);t>=0&&this._buffer.splice(t,1)}Count(){return this._buffer.length}GetBuffer(){return this._buffer}ContainsKey(e){return this._getIndex(e)>=0}Get(e){var t=this._getIndex(e);return t>=0?this._buffer[t].Value:null}_getIndex(e){for(var t=0,n=-1;t<this._buffer.length;++t)if(this._buffer[t].Key==e){n=t;break}return n}}},351577:(e,t,n)=>{n.d(t,{ni:()=>r,zM:()=>o,Mr:()=>a,Pp:()=>l,KS:()=>d,rH:()=>c});var i=n(94879),s=n(265162);class r{constructor(e){this.low=0,this.high=0,this.low=parseInt(e),this.low<0&&(this.high=-1)}Equals(e){var t=new r(e);return this.low==t.low&&this.high==t.high}}class o{constructor(e){this.low=0,this.high=0,this.low=parseInt(e)}Equals(e){var t=new o(e);return this.low==t.low&&this.high==t.high}}class a{static ToByte(e){return this.ToUInt8(e)}static ToInt8(e){return 127&e|(128&e)<<24>>24}static ToInt16(e){return 32767&e|(32768&e)<<16>>16}static ToInt32(e){return 2147483647&e|2147483648&e}static ToUInt8(e){return 255&e}static ToUInt16(e){return 65535&e}static ToUInt32(e){return 4294967295&e}}class l{constructor(e){this.Message=e}}class d{static IsDataViewSupport(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView}}class c{constructor(e){this._stream=e}WriteBlob(e){this._stream.Write(e,0,e.length)}WriteBool(e){this._stream.WriteByte(e?1:0)}WriteContainerBegin(e,t){this.WriteUInt8(t),this.WriteUInt32(e)}WriteMapContainerBegin(e,t,n){this.WriteUInt8(t),this.WriteUInt8(n),this.WriteUInt32(e)}WriteContainerEnd(){}WriteDouble(e){var t=s.bh.GetBytes(e);this._stream.Write(t,0,t.length)}WriteFloat(e){var t=s.bv.GetBytes(e);this._stream.Write(t,0,t.length)}WriteFieldBegin(e,t,n){t<=5?this._stream.WriteByte(e|t<<5):t<=255?(this._stream.WriteByte(192|e),this._stream.WriteByte(t)):(this._stream.WriteByte(224|e),this._stream.WriteByte(t),this._stream.WriteByte(t>>8))}WriteFieldEnd(){}WriteFieldOmitted(e,t,n){}WriteInt16(e){e=s.if.EncodeZigzag16(e),this.WriteUInt16(e)}WriteInt32(e){e=s.if.EncodeZigzag32(e),this.WriteUInt32(e)}WriteInt64(e){this.WriteUInt64(s.if.EncodeZigzag64(e))}WriteInt8(e){this._stream.WriteByte(a.ToInt8(e))}WriteString(e){if(""==e)this.WriteUInt32(0);else{var t=s.di.GetBytes(e);this.WriteUInt32(t.length),this._stream.Write(t,0,t.length)}}WriteStructBegin(e,t){}WriteStructEnd(e){this.WriteUInt8(e?i.V.BT_STOP_BASE:i.V.BT_STOP)}WriteUInt16(e){var t=s.Km.GetBytes(a.ToUInt16(e));this._stream.Write(t,0,t.length)}WriteUInt32(e){var t=s.Km.GetBytes(a.ToUInt32(e));this._stream.Write(t,0,t.length)}WriteUInt64(e){var t=s.Ms.GetBytes(e);this._stream.Write(t,0,t.length)}WriteUInt8(e){this._stream.WriteByte(a.ToUInt8(e))}WriteWString(e){this.WriteUInt32(e.length);for(var t=0;t<e.length;++t){var n=e.charCodeAt(t);this._stream.WriteByte(n),this._stream.WriteByte(n>>>8)}}}},325790:(e,t,n)=>{n.d(t,{P6:()=>d,A4:()=>r,WV:()=>h,Pm:()=>u,$L:()=>C});var i,s,r,o=n(351577),a=n(94879),l=n(21384);class d{static GetGuid(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1,5)};return[e(),e(),"-",e(),"-",e(),"-",e(),"-",e(),e(),e()].join("")}static GetTimeStamp(){var e=(new Date).getTime(),t=new o.ni("0");return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t}static GetTimeStampWithValue(e){var t=new o.ni("0");return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t}}!function(e){e[e.NotSet=0]="NotSet",e[e.Event=1]="Event",e[e.PerformanceCounter=2]="PerformanceCounter",e[e.Anomaly=3]="Anomaly",e[e.Prediction=4]="Prediction",e[e.TraceLog=5]="TraceLog",e[e.EventSourceLog=6]="EventSourceLog",e[e.HttpLog=7]="HttpLog",e[e.PerformanceCounterAzure=8]="PerformanceCounterAzure",e[e.PerformanceCounterGfs=9]="PerformanceCounterGfs"}(i||(i={})),function(e){e[e.NotSet=0]="NotSet",e[e.O365=1]="O365",e[e.SkypeBI=2]="SkypeBI",e[e.SkypeData=3]="SkypeData"}(s||(s={})),function(e){e[e.NotSet=0]="NotSet",e[e.DistinguishedName=1]="DistinguishedName",e[e.GenericData=2]="GenericData",e[e.IPV4Address=3]="IPV4Address",e[e.IPv6Address=4]="IPv6Address",e[e.MailSubject=5]="MailSubject",e[e.PhoneNumber=6]="PhoneNumber",e[e.QueryString=7]="QueryString",e[e.SipAddress=8]="SipAddress",e[e.SmtpAddress=9]="SmtpAddress",e[e.Identity=10]="Identity",e[e.Uri=11]="Uri",e[e.Fqdn=12]="Fqdn",e[e.IPV4AddressLegacy=13]="IPV4AddressLegacy",e[e.FilePath=14]="FilePath"}(r||(r={}));class c{constructor(){this.ScrubType=s.NotSet,this.Kind=r.NotSet,this.RawContent=""}Write(e){this.WriteImpl(e,!1)}WriteImpl(e,t){e.WriteStructBegin(null,t),this.ScrubType!=s.NotSet?(e.WriteFieldBegin(a.V.BT_INT32,1,null),e.WriteInt32(this.ScrubType),e.WriteFieldEnd()):e.WriteFieldOmitted(a.V.BT_INT32,1,null),this.Kind!=r.NotSet?(e.WriteFieldBegin(a.V.BT_INT32,2,null),e.WriteInt32(this.Kind),e.WriteFieldEnd()):e.WriteFieldOmitted(a.V.BT_INT32,2,null),""!=this.RawContent?(e.WriteFieldBegin(a.V.BT_STRING,3,null),e.WriteString(this.RawContent),e.WriteFieldEnd()):e.WriteFieldOmitted(a.V.BT_STRING,3,null),e.WriteStructEnd(t)}Read(e){this.ReadImpl(e,!1)}ReadImpl(e,t){}}class h{constructor(){this.Id=d.GetGuid(),this.Timestamp=d.GetTimeStamp(),this.Type="",this.EventType="",this.Extension=new l.D,this.RecordType=i.NotSet,this.PIIExtensions=new l.D}AddOrReplacePII(e,t,n){var i=new c;i.RawContent=t,i.Kind=n,i.ScrubType=s.O365,this.PIIExtensions.AddOrReplace(e,i)}Write(e){this.WriteImpl(e,!1)}WriteImpl(e,t){if(e.WriteStructBegin(null,t),""!=this.Id?(e.WriteFieldBegin(a.V.BT_STRING,1,null),e.WriteString(this.Id),e.WriteFieldEnd()):e.WriteFieldOmitted(a.V.BT_STRING,1,null),this.Timestamp.Equals("0")?e.WriteFieldOmitted(a.V.BT_INT64,3,null):(e.WriteFieldBegin(a.V.BT_INT64,3,null),e.WriteInt64(this.Timestamp),e.WriteFieldEnd()),""!=this.Type?(e.WriteFieldBegin(a.V.BT_STRING,5,null),e.WriteString(this.Type),e.WriteFieldEnd()):e.WriteFieldOmitted(a.V.BT_STRING,5,null),""!=this.EventType?(e.WriteFieldBegin(a.V.BT_STRING,6,null),e.WriteString(this.EventType),e.WriteFieldEnd()):e.WriteFieldOmitted(a.V.BT_STRING,6,null),this.Extension.Count()){e.WriteFieldBegin(a.V.BT_MAP,13,null),e.WriteMapContainerBegin(this.Extension.Count(),a.V.BT_STRING,a.V.BT_STRING);for(var n=0;n<this.Extension.GetBuffer().length;++n)e.WriteString(this.Extension.GetBuffer()[n].Key),e.WriteString(this.Extension.GetBuffer()[n].Value);e.WriteContainerEnd(),e.WriteFieldEnd()}else e.WriteFieldOmitted(a.V.BT_MAP,13,null);if(this.RecordType!=i.NotSet?(e.WriteFieldBegin(a.V.BT_INT32,24,null),e.WriteInt32(this.RecordType),e.WriteFieldEnd()):e.WriteFieldOmitted(a.V.BT_INT32,24,null),this.PIIExtensions.Count()){e.WriteFieldBegin(a.V.BT_MAP,30,null),e.WriteMapContainerBegin(this.PIIExtensions.Count(),a.V.BT_STRING,a.V.BT_STRUCT);for(var s=0;s<this.PIIExtensions.GetBuffer().length;++s)e.WriteString(this.PIIExtensions.GetBuffer()[s].Key),this.PIIExtensions.GetBuffer()[s].Value.WriteImpl(e,!1);e.WriteContainerEnd(),e.WriteFieldEnd()}else e.WriteFieldOmitted(a.V.BT_MAP,30,null);e.WriteStructEnd(t)}Read(e){this.ReadImpl(e,!1)}ReadImpl(e,t){}}class u{constructor(){this.Source="",this.DataPackageId="",this.Timestamp=new o.ni("0"),this.Records=[]}Write(e){this.WriteImpl(e,!1)}WriteImpl(e,t){if(e.WriteStructBegin(null,t),""!=this.Source?(e.WriteFieldBegin(a.V.BT_STRING,2,null),e.WriteString(this.Source),e.WriteFieldEnd()):e.WriteFieldOmitted(a.V.BT_STRING,2,null),""!=this.DataPackageId?(e.WriteFieldBegin(a.V.BT_STRING,5,null),e.WriteString(this.DataPackageId),e.WriteFieldEnd()):e.WriteFieldOmitted(a.V.BT_STRING,5,null),this.Timestamp.Equals("0")?e.WriteFieldOmitted(a.V.BT_INT64,6,null):(e.WriteFieldBegin(a.V.BT_INT64,6,null),e.WriteInt64(this.Timestamp),e.WriteFieldEnd()),this.Records.length){e.WriteFieldBegin(a.V.BT_LIST,8,null),e.WriteContainerBegin(this.Records.length,a.V.BT_STRUCT);for(var n=0;n<this.Records.length;++n)this.Records[n].WriteImpl(e,!1);e.WriteContainerEnd(),e.WriteFieldEnd()}else e.WriteFieldOmitted(a.V.BT_LIST,8,null);e.WriteStructEnd(t)}Read(e){this.ReadImpl(e,!1)}ReadImpl(e,t){}}class C{constructor(){this.DataPackages=[],this.RequestRetryCount=0}Write(e){this.WriteImpl(e,!1)}WriteImpl(e,t){if(e.WriteStructBegin(null,t),this.DataPackages.length){e.WriteFieldBegin(a.V.BT_LIST,1,null),e.WriteContainerBegin(this.DataPackages.length,a.V.BT_STRUCT);for(var n=0;n<this.DataPackages.length;++n)this.DataPackages[n].WriteImpl(e,!1);e.WriteContainerEnd(),e.WriteFieldEnd()}else e.WriteFieldOmitted(a.V.BT_LIST,1,null);0!=this.RequestRetryCount?(e.WriteFieldBegin(a.V.BT_INT32,2,null),e.WriteInt32(this.RequestRetryCount),e.WriteFieldEnd()):e.WriteFieldOmitted(a.V.BT_INT32,2,null),e.WriteStructEnd(t)}Read(e){this.ReadImpl(e,!1)}ReadImpl(e,t){}}},182641:(e,t,n)=>{n.d(t,{Mk:()=>S,sE:()=>E});var i=n(325790);class s{static IsSafariOrFirefox(){return null===s._isSafariOrFirefox&&s._DetectBrowser(),s._isSafariOrFirefox}static ajax(e){var t=s._createConnection();if(e.headers){var n="qsp=true";for(var i in e.headers)n+="&",n+=encodeURIComponent(i),n+="=",n+=encodeURIComponent(e.headers[i]);e.url.indexOf("?")<0?e.url+="?":e.url+="&",e.url+=n}t.open(e.type,e.url),e.complete&&(t.onload=()=>{void 0===t.status&&(t.status=200),e.complete(t)},t.ontimeout=()=>{void 0===t.status&&(t.status=500),e.complete(t)},t.onerror=()=>{e.complete(t)}),t.send(e.data)}static keys(e){if(Object.keys)return Object.keys(e);var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}static IsUsingXDomainRequest(){null==s._usingXDomainRequest&&(void 0===(new XMLHttpRequest).withCredentials&&"undefined"!=typeof XDomainRequest?s._usingXDomainRequest=!0:s._usingXDomainRequest=!1);return s._usingXDomainRequest}static _createConnection(){var e=new XMLHttpRequest;return s.IsUsingXDomainRequest()?new XDomainRequest:e}static _DetectBrowser(){var e=navigator.userAgent.toLowerCase();(e.indexOf("safari")>=0||e.indexOf("firefox")>=0)&&e.indexOf("chrome")<0?s._isSafariOrFirefox=!0:s._isSafariOrFirefox=!1}}s._isSafariOrFirefox=null,s._usingXDomainRequest=null;var r,o,a,l=n(265162),d=n(351577);class c{constructor(){this._buffer=[]}WriteByte(e){this._buffer.push(d.Mr.ToByte(e))}Write(e,t,n){for(;n--;)this.WriteByte(e[t++])}GetBuffer(){return this._buffer}}class h{constructor(){this.data=[]}WriteBlob(e){let t={type:"blob",value:e};this.data.push(t)}WriteBool(e){let t={type:"boolean",value:e};this.data.push(t)}WriteContainerBegin(e,t){let n={type:"containerBegin",size:e,elementType:t};this.data.push(n)}WriteMapContainerBegin(e,t,n){let i={type:"mapContainerBegin",size:e,keyType:t,valueType:n};this.data.push(i)}WriteContainerEnd(){this.data.push({type:"containerEnd"})}WriteDouble(e){let t={type:"number",value:e};this.data.push(t)}WriteFloat(e){let t={type:"number",value:e};this.data.push(t)}WriteFieldBegin(e,t,n){let i={type:"fieldBegin",id:t};this.data.push(i)}WriteFieldEnd(){this.data.push({type:"fieldEnd"})}WriteFieldOmitted(e,t,n){let i={type:"fieldOmitted",id:t};this.data.push(i)}WriteInt16(e){let t={type:"number",value:e};this.data.push(t)}WriteInt32(e){let t={type:"number",value:e};this.data.push(t)}WriteInt64(e){let t={type:"number",value:4294967296*e.high+e.low};this.data.push(t)}WriteInt8(e){let t={type:"number",value:e};this.data.push(t)}WriteString(e){let t={type:"string",value:e};this.data.push(t)}WriteStructBegin(e,t){let n={type:"structBegin",isBase:t};this.data.push(n)}WriteStructEnd(e){let t={type:"structEnd",isBase:e};this.data.push(t)}WriteUInt16(e){let t={type:"number",value:e};this.data.push(t)}WriteUInt32(e){let t={type:"number",value:e};this.data.push(t)}WriteUInt64(e){let t={type:"number",value:e};this.data.push(t)}WriteUInt8(e){let t={type:"number",value:e};this.data.push(t)}WriteWString(e){let t={type:"string",value:e};this.data.push(t)}}!function(e){e[e.ECS_ERROR_OK=0]="ECS_ERROR_OK",e[e.ECS_ERROR_INVALID_STATUS=1]="ECS_ERROR_INVALID_STATUS",e[e.ECS_ERROR_INVALID_RESPONSE=6]="ECS_ERROR_INVALID_RESPONSE",e[e.ECS_ERROR_INVALID_CONFIG=8]="ECS_ERROR_INVALID_CONFIG"}(r||(r={}));!function(e){e[e.CONFIG_UPDATED=0]="CONFIG_UPDATED",e[e.TOKEN_IS_INVALID=1]="TOKEN_IS_INVALID"}(o||(o={}));class u{}u.Servers=["https://config.teams.microsoft.com/config/v1/Skype/"],u.RefreshIntervalInMS=36e5,u.FailedRetryFactorInMS=1e4,u.MaxRetryIntervalForFailedInMS=36e5,function(e){e[e.Created=0]="Created",e[e.Initialized=1]="Initialized",e[e.Started=2]="Started",e[e.Loading=3]="Loading"}(a||(a={}));var C,_,p,g=n(363284);!function(e){e[e.SENT=0]="SENT",e[e.SEND_FAILED=1]="SEND_FAILED"}(C||(C={})),function(e){e[e.DATARV_ERROR_OK=0]="DATARV_ERROR_OK",e[e.DATARV_ERROR_INVALID_EVENT=1]="DATARV_ERROR_INVALID_EVENT",e[e.DATARV_ERROR_INVALID_CONFIG=2]="DATARV_ERROR_INVALID_CONFIG",e[e.DATARV_ERROR_INVALID_DEPENDENCIES=3]="DATARV_ERROR_INVALID_DEPENDENCIES",e[e.DATARV_ERROR_INVALID_STATUS=4]="DATARV_ERROR_INVALID_STATUS",e[e.DATARV_ERROR_INVALID_ARG=5]="DATARV_ERROR_INVALID_ARG"}(_||(_={}));class m{constructor(e){this._errorCode=_.DATARV_ERROR_OK,this._errorCode=e}ErrorCode(){return this._errorCode}toString(){switch(this._errorCode){case _.DATARV_ERROR_OK:return"DATARV_ERROR_OK";case _.DATARV_ERROR_INVALID_EVENT:return"Event is invalid. Either event.Id is empty, or event.Timestamp is empty, or event.EventType is empty.";case _.DATARV_ERROR_INVALID_CONFIG:return"Invalid configuration. CollectorUrl is missing.";case _.DATARV_ERROR_INVALID_DEPENDENCIES:return"DATARV_ERROR_INVALID_DEPENDENCIES";case _.DATARV_ERROR_INVALID_STATUS:return"Telemetry Manager is not initialized.";case _.DATARV_ERROR_INVALID_ARG:return"TenantToken is null or empty, or events is null.";default:return"Unknown error"}}}class S{constructor(){this.eventsLimitInMem=1e4}}class E{static CreateTelemetryManager(){return new I}}class T{}T.MaxPackageSizeInBytes=3e6,T.TimeIntervalForNextSendInMS=15e3,function(e){e[e.Created=0]="Created",e[e.Initialized=1]="Initialized",e[e.Started=2]="Started"}(p||(p={}));class I{constructor(){this._MaxPackageSizeInBytes=T.MaxPackageSizeInBytes,this._listeners=[],this._status=p.Created,this._ecsClient=null,this._etag=null,this._ecsCallback=null,this._testServerResponseHook=null,this._testHookListeners=[]}Initialize(e){if(this._status!=p.Created)throw new m(_.DATARV_ERROR_INVALID_STATUS);if(!e||!e.collectorUrl)throw new m(_.DATARV_ERROR_INVALID_CONFIG);this._config=e,this._Reset(),this._status=p.Initialized,e.ecsClient&&(this._Verbose("ECS object assigned. Do integration"),this._ecsClient=e.ecsClient),e.overwriteSendTimeInterval&&e.overwriteSendTimeInterval>=0&&(T.TimeIntervalForNextSendInMS=e.overwriteSendTimeInterval),this._Verbose("Initialize() done")}setEventsLimitInMem(e){this._eventsCache.setEventsLimitInMem(e)}AddListener(e){if(this._status<p.Initialized)throw new m(_.DATARV_ERROR_INVALID_STATUS);this._Verbose(["AddListener(), status: ",this._status," old length: ",this._listeners.length," func: ",e].join(""));for(var t=0;t<this._listeners.length;++t)if(this._listeners[t]==e)return void this._Verbose("the listener has been added already, index: "+t);this._listeners.push(e),this._Verbose("AddListener() done, the new length: "+this._listeners.length)}RemoveListener(e){if(this._status<p.Initialized)throw new m(_.DATARV_ERROR_INVALID_STATUS);this._Verbose(["RemoveListener(), status: ",this._status," old length: ",this._listeners.length," func: ",e].join(""));for(var t=0;t<this._listeners.length;++t)if(this._listeners[t]==e)return 1==this._listeners.length?this._listeners=[]:t==this._listeners.length-1?this._listeners.pop():this._listeners[t]=this._listeners.pop(),void this._Verbose(["this listener has been found, index: ",t,"new length: ",this._listeners.length].join(""));this._Verbose("listener isn't been found, new length"+this._listeners.length)}Start(){if(this._status<p.Initialized)throw new m(_.DATARV_ERROR_INVALID_STATUS);this._Verbose(["Start(), status:",this._status,"tag:",I._tag].join(" ")),this._status>=p.Started&&this._Verbose("Start() already, ignore"),this._ecsClient&&(this._ecsCallback=this._CreateEcsCallback(),this._ecsClient.AddListener(this._ecsCallback),this._etag=this._ecsClient.GetETag()),++I._tag,this._status=p.Started,this._Verbose(["Start() done, status: ",this._status,"tag: ",I._tag].join(""))}Stop(){if(this._status<p.Initialized)throw new m(_.DATARV_ERROR_INVALID_STATUS);this._Verbose("Stop(), status: "+this._status),this._status!=p.Initialized?(this._Reset(),this._status=p.Initialized,this._Verbose("Stop() done, status: "+this._status)):this._Verbose("Stop() already, ignore")}Flush(e){this._eventsCache.IsEmpty()||this._WorkThread(e)}SendAsync(e,t){var n;if(this._status<p.Initialized)throw new m(_.DATARV_ERROR_INVALID_STATUS);if(this._Verbose(["SendAsync(), status:",this._status,"tenantToken:",e,"count:",t.length].join(" ")),this._status<p.Started)return this._Info("SendAsync(), not started, ignore, return false"),!1;if(!e||!t)throw this._Error("SendAsync(), tenantToken or events is null or empty"),new m(_.DATARV_ERROR_INVALID_ARG);for(var i=0;i<t.length;++i)if(!t[i].Id||!I._eventTypeRegex.test(t[i].EventType)||t[i].Timestamp.Equals("0"))throw this._Error(["eventId:",t[i].Id,"eventType:",t[i].EventType,"timestamp high:",t[i].Timestamp.high,"timestamp low:",t[i].Timestamp.low].join("")),new m(_.DATARV_ERROR_INVALID_EVENT);return null===(n=this._eventsCache)||void 0===n||n.AddEvents(e,t),this._Verbose(["SendAsync(), currentTimer: ",this._timer,"eventsCacheIsEmpty",this._eventsCache.IsEmpty()].join(" ")),this._eventsCache.IsEmpty()||this._timer||this._ScheduleTimer(!1),this._Verbose("SendAsync() done"),!0}_WorkThread(e){var t;try{var n=Date.now();if(this._Verbose("_WorkThread, status: "+this._status),this._status<p.Started)return void this._Verbose("_WorkThread, status is not started, return");var i=this._eventsCache.DequeuEvents();if(null==i)return this._Verbose("_WorkThread, No events found, return"),void this._CleanTimer();var r=i.events.length,o=this._PackEvents(i.tenantToken,i.events);null===(t=this._eventsCache)||void 0===t||t.AddEvents(i.tenantToken,o.remainedEvents);var a=o.remainedEvents.length;if(null==o.buffer||0==o.buffer.length)return void(this._eventsCache.IsEmpty()?(this._Verbose("eventsCache is empty, stop schedule"),this._CleanTimer()):(this._Verbose("eventsCache is not empty, schedule for next run"),this._ScheduleTimer(!1)));if(this._testHookListeners)for(var d=0;d<this._testHookListeners.length;++d)this._testHookListeners[d](o.sendEvents);if(this._testServerResponseHook){var c=this._testServerResponseHook();return void setTimeout((()=>this._SendCallback(u,i.tenantToken,o.sendEvents,c,null)),100)}var h={type:"POST",url:this._config.collectorUrl,processData:!1,headers:{"content-type":"application/bond-compact-binary","client-id":"NO_AUTH","sdk-version":"ACT-Web-JS-"+g.w.version},complete:t=>this._SendCallback(u,i.tenantToken,o.sendEvents,t,e)};this._config.useJsonTextStream?(h.data=o.buffer,h.headers["content-type"]="application/json"):s.IsSafariOrFirefox()||"undefined"==typeof Uint8Array?(this._Verbose("Uint8Array is undefined, send with base64 encode."),h.data=l.DS.GetString(o.buffer),h.headers["content-encoding"]="base64"):(this._Verbose("Uint8Array is defined, send with binary format directly."),h.data=new Uint8Array(o.buffer)),i.tenantToken&&(h.headers["x-apikey"]=i.tenantToken);var u=I._tag;this._lastActiveTime=(new Date).getTime(),s.ajax(h),this._Verbose("_Workthread, send via jquery, tag: "+u),this._Info("Processing telemetry events took "+(Date.now()-n)+" ms for "+(r-a)+" events with total size of "+o.buffer.length+" bytes, remaining events - "+a)}catch(e){this._Error("_WorkThread, exception: "+e)}}_PackEvents(e,t){this._Verbose("_PackageEvents, total Count: "+t.length);var n,s=new i.$L,r=new i.Pm;r.Source="JS_default_source",r.DataPackageId=i.P6.GetGuid(),r.Timestamp=i.P6.GetTimeStamp();var o=t;if(t=[],o.length>200){var a=o.splice(0,200);t.push.apply(t,o),o=a}for(;r.Records=[],r.Records.push.apply(r.Records,o),s.DataPackages=[],s.DataPackages.push(r),n=this._Serialize(s),this._Verbose(["_PackageEvents, sendEvents.length:",o.length," buffer.length:",n.length," MaxPackageSize:",this._MaxPackageSizeInBytes].join("")),!(n.length<this._MaxPackageSizeInBytes);){if(1==o.length){o=[],n=null;break}var l=o.splice(0,Math.floor(o.length/2));this._Verbose("_PackageEvents, too large, package again"),t.push.apply(t,o),o=l}return this._Verbose(["_PakcageEvents done, sendEventsCount:",o.length,"buffer.length:",null==n?0:n.length,"remained events:",t.length].join("")),{buffer:n,sendEvents:o,remainedEvents:t}}_Serialize(e){if(this._config.useJsonTextStream){var t=new h;return e.Write(t),JSON.stringify(t.data)}var n=new c,i=new d.rH(n);return e.Write(i),n.GetBuffer()}_SendCallback(e,t,n,i,s){var r;if(this._Verbose(["_SendCallback","tag:",e,"current tag:",I._tag,"tenantToken:",t,"events count:",n.length,"jqXHR:",i].join("")),null==s){var o=null!=i&&i.status>=200&&i.status<300;if(this._status<p.Started||e<I._tag)this._Verbose("_SendCallback, is not started, or tag is not the same, return");else{if(!(o||i&&400==i.status))return this._Verbose("retry statusCode: "+(i?i.status:0)),null===(r=this._eventsCache)||void 0===r||r.AddEvents(t,n),void this._ScheduleTimer(!0);for(var a=0;a<this._listeners.length;++a)this._listeners[a](o?C.SENT:C.SEND_FAILED,i?i.status:0,t,n);this._eventsCache.IsEmpty()?(this._Verbose("eventsCache is empty, stop schedule"),this._CleanTimer()):(this._Verbose("eventsCache is not empty, schedule for next run"),this._ScheduleTimer(!1))}}else s(i?i.status:0,t,n)}_CleanTimer(){this._Verbose("_CleanTimer(), timer: "+this._timer),this._timer&&(clearTimeout(this._timer),this._timer=null)}_ScheduleTimer(e){if(this._Verbose("_ScheduleTimer: isRetry: "+e),this._CleanTimer(),e){this._Verbose("_ScheduleTimer, current factor: "+this._rescheduleFactor);t=Math.floor(5*this._rescheduleFactor*(1+Math.random()));this._timer=setTimeout((()=>this._WorkThread(null)),1e3*t),this._Verbose("_ScheduleTimer, next try (s): "+t),this._rescheduleFactor<<=1,this._rescheduleFactor>64&&(this._rescheduleFactor=1)}else{var t=0,n=(new Date).getTime()-this._lastActiveTime;t=n>T.TimeIntervalForNextSendInMS?0:T.TimeIntervalForNextSendInMS-n,this._timer=setTimeout((()=>this._WorkThread(null)),t),this._Verbose("_ScheduleTimer, next try: "+t),this._rescheduleFactor=1}}_Verbose(e){this._config.log&&this._config.log.Verbose("[TelemetryManagerImpl]: "+e)}_Info(e){this._config.log&&this._config.log.Info("[TelemetryManagerImpl]: "+e)}_Error(e){this._config.log&&this._config.log.Error("[TelemetryManagerImpl]: "+e)}_Reset(){this._Verbose("Reset()"),this._CleanTimer(),this._lastActiveTime=0,this._rescheduleFactor=1,this._sendingEvents=[],this._eventsCache=new v(this._config.log,this._config.eventsLimitInMem),this._ecsClient&&(this._ecsClient.RemoveListener(this._ecsCallback),this._ecsCallback=null)}_CreateEcsCallback(){return e=>{e==o.CONFIG_UPDATED&&(this._etag=this._ecsClient.GetETag())}}__AddTestHookListener(e){if(this._status<p.Initialized)throw new m(_.DATARV_ERROR_INVALID_STATUS);for(var t=0;t<this._testHookListeners.length;++t)if(this._testHookListeners[t]==e)return;this._testHookListeners.push(e)}__ClearTestHookListener(){this._testHookListeners=[]}__GetListenerArray(){return this._listeners}__GetTotalEventsCount(){return this._eventsCache.GetTotalEventsCount()}__IsScheduled(){return null!=this._timer}__ChageMaxPackageSizeInKB(e){this._MaxPackageSizeInBytes=1024*e}__SetTestServerResponseHook(e){this._testServerResponseHook=e}}I._eventTypeRegex=/^[a-zA-Z0-9]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/,I._tag=0;class v{constructor(e,t){this._logger=e,this._eventsLimitInMem=t,this._events={},this._tokens=[]}AddEvents(e,t){t.length&&(t.length>this._eventsLimitInMem?this._logDroppedEvents(e,t.length):(this._events[e]||(this._events[e]=[],this._tokens.push(e)),this._events[e].push.apply(this._events[e],t)))}IsEmpty(){return 0==this._tokens.length}DequeuEvents(){if(0==this._tokens.length)return null;var e=this._tokens.shift(),t=this._events[e];return delete this._events[e],{tenantToken:e,events:t}}GetTotalEventsCount(){var e=0;for(var t in this._events)e+=this._events[t].length;return e}setEventsLimitInMem(e){this._eventsLimitInMem=e}_logDroppedEvents(e,t){if(!this._logger)return;let n=0;this._events[e]&&(n=this._events[e].length),this._logger.Verbose(`[TelemetryEventCache]: Size of dropped events: ${t},\n      events size currently in queue for tenant ${e}: ${n}`)}}},363284:(e,t,n)=>{n.d(t,{w:()=>i});class i{static get version(){return"2.5.0"}}},648465:(e,t,n)=>{n.d(t,{cS:()=>c,kc:()=>u,sM:()=>s,hD:()=>g,Yd:()=>m});var i,s,r=n(182641),o=n(325790),a=n(21384),l=n(363284),d=null;function c(e){d=e}class h{constructor(){this.key=null,this.value=null,this.pii=null}static _isPii(e){if(e==o.A4.NotSet)return!1;var t=!1;for(var n in o.A4)isNaN(n)||n==e&&(t=!0);return t}}class u{constructor(){this.name=null,this.timestamp=null,this.properties=[],this.eventType=null}setProperty(e,t,n){if(!e||!this.properties[e]&&!u._propertyNameRegex.test(e))throw new C(i.INVALID_PROPERTY_NAME);this.properties[e]={key:e,value:t,pii:n!=o.A4.NotSet?n:null}}unsetProperty(e){if(!e)throw new C(i.INVALID_PROPERTY_NAME);void 0!==this.properties[e]&&(this.properties[e]=void 0,delete this.properties[e])}}u._propertyNameRegex=/^[a-zA-Z0-9](([a-zA-Z0-9|_|.]){0,98}[a-zA-Z0-9])?$/,function(e){e[e.INVALID_TENANT_TOKEN=1]="INVALID_TENANT_TOKEN",e[e.MISSING_EVENT_PROPERTIES_NAME=2]="MISSING_EVENT_PROPERTIES_NAME",e[e.INVALID_PROPERTY_NAME=3]="INVALID_PROPERTY_NAME",e[e.INVALID_COLLECTOR_URL=4]="INVALID_COLLECTOR_URL",e[e.MISSING_FAILURE_SIGNATURE=5]="MISSING_FAILURE_SIGNATURE",e[e.MISSING_FAILURE_DETAIL=6]="MISSING_FAILURE_DETAIL",e[e.MISSING_PAGEVIEW_ID=7]="MISSING_PAGEVIEW_ID",e[e.MISSING_PAGEVIEW_NAME=8]="MISSING_PAGEVIEW_NAME",e[e.INVALID_SESSION_STATE=9]="INVALID_SESSION_STATE"}(i||(i={}));class C{constructor(e){this.errorCode=null,this.errorCode=e}ErrorCode(){return this.errorCode}toString(){switch(this.errorCode){case i.INVALID_TENANT_TOKEN:return"Invalid tenant token";case i.MISSING_EVENT_PROPERTIES_NAME:return"Eventproperties.name can not be null or empty";case i.INVALID_PROPERTY_NAME:return"Invalid Key. Key does not conform to regular expression ^[a-zA-Z0-9](([a-zA-Z0-9|_]){0,98}[a-zA-Z0-9])?$";case i.INVALID_COLLECTOR_URL:return"Collector url can't be null or empty.";case i.MISSING_FAILURE_SIGNATURE:return"Failure signature can't be null or empty.";case i.MISSING_FAILURE_DETAIL:return"Failure detail can't be null or empty.";case i.MISSING_PAGEVIEW_ID:return"Pageview id can't be null or empty.";case i.MISSING_PAGEVIEW_NAME:return"Pageview name can't be null or empty.";case i.INVALID_SESSION_STATE:return"Session state has to be a value from the SessionState enum.";default:return"Unknown error"}}}class _{constructor(e){this.contextMap=new a.D,this.piiKind=o.A4.NotSet,this._allowDeviceInfoFields=!1,this._allowDeviceInfoFields=e}setAppId(e){e&&this.contextMap.Add("AppInfo.Id",e)}setAppVersion(e){e&&this.contextMap.Add("AppInfo.Version",e)}setAppClientType(e){e&&this.contextMap.Add("AppInfo.ClientType",e)}setAppLanguage(e){e&&this.contextMap.Add("AppInfo.Language",e)}setDeviceId(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.Id",e)}setDeviceOsName(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.OsName",e)}setDeviceOsVersion(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.OsVersion",e)}setDeviceBrowserName(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.BrowserName",e)}setDeviceBrowserVersion(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.BrowserVersion",e)}setUserId(e,t){e&&this.contextMap.Add("UserInfo.Id",e),h._isPii(t)&&(this.piiKind=t)}setUserMsaId(e){e&&this.contextMap.Add("UserInfo.MsaId",e)}setUserANID(e){e&&this.contextMap.Add("UserInfo.ANID",e)}setUserAdvertisingId(e){e&&this.contextMap.Add("UserInfo.AdvertisingId",e)}setUserTimeZone(e){e&&this.contextMap.Add("UserInfo.TimeZone",e)}setUserLanguage(e){e&&this.contextMap.Add("UserInfo.Language",e)}setUserRing(e){e&&this.contextMap.Add("UserInfo.Ring",e)}setUserTenantId(e){e&&this.contextMap.Add("UserInfo.TenantId",e)}}class p{static initialize(e){p.documentInfo=e;var t=e.appLanguage;t&&p.semanticContext.setAppLanguage(t);var n=e.userLanguage;n&&p.semanticContext.setUserLanguage(n);var i=(new Date).getTimezoneOffset(),s=i%60,r=(i-s)/60,o="+";r>0&&(o="-"),s=Math.abs(s);var a=o+((r=Math.abs(r))<10?"0"+r:r.toString())+":"+(s<10?"0"+s:s.toString());p.semanticContext.setUserTimeZone(a),p.semanticContext.setDeviceBrowserName(p._getBrowserName()),p.semanticContext.setDeviceBrowserVersion(p._getBrowserVersion()),p.semanticContext.setDeviceOsName(p._getOsName()),p.semanticContext.setDeviceOsVersion(p._getOsVersion()),p.semanticContext.setDeviceId(e.deviceId),p.firstLaunchTime=e.firstLaunchTime,p.semanticContext.setAppVersion(e.appVersion)}static _getUserAgent(){return p.documentInfo.userAgent}static _userAgentContainsString(e){return p._getUserAgent().indexOf(e)>-1}static _isIe(){return p._userAgentContainsString("Trident")}static _isEdge(){return p._userAgentContainsString(p.BROWSERS.EDGE)}static _isEdgeAnaheim(){return p._userAgentContainsString("Edg/")}static _isOpera(){return p._userAgentContainsString("OPR/")}static _getBrowserName(){return p._isOpera()?p.BROWSERS.UNKNOWN:p._userAgentContainsString(p.BROWSERS.PHANTOMJS)?p.BROWSERS.PHANTOMJS:p._isEdge()?p.BROWSERS.EDGE:p._isEdgeAnaheim()?p.BROWSERS.EDGEANAHEIM:p._userAgentContainsString(p.BROWSERS.ELECTRON)?p.BROWSERS.ELECTRON:p._userAgentContainsString(p.BROWSERS.CHROME)?p.BROWSERS.CHROME:p._userAgentContainsString(p.BROWSERS.FIREFOX)?p.BROWSERS.FIREFOX:p._userAgentContainsString(p.BROWSERS.SAFARI)?p.BROWSERS.SAFARI:p._userAgentContainsString(p.BROWSERS.SKYPE_SHELL)?p.BROWSERS.SKYPE_SHELL:p._isIe()?p.BROWSERS.MSIE:p.BROWSERS.UNKNOWN}static _getBrowserVersion(){return p._isIe()?function(){var e,t=p._getUserAgent(),n=t.match(new RegExp(p.BROWSERS.MSIE+" "+p.REGEX_VERSION));if(n)return n[1];if(e=t.match(new RegExp("rv:"+p.REGEX_VERSION)))return e[1]}():function(e){var t;e===p.BROWSERS.SAFARI?e="Version":e===p.BROWSERS.EDGEANAHEIM&&(e="Edg");if(t=p._getUserAgent().match(new RegExp(e+"/"+p.REGEX_VERSION)))return t[1];return p.UNKNOWN_VERSION}(p._getBrowserName())}static _getOsName(){return p._getUserAgent().match(/windows\sphone\s\d+\.\d+/i)?p.OPERATING_SYSTEMS.WINDOWS_PHONE:p._getUserAgent().match(/ arm;/i)?p.OPERATING_SYSTEMS.WINDOWS_RT:p._getUserAgent().match(/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i)?p.OPERATING_SYSTEMS.IOS:p._getUserAgent().match(/android/i)?p.OPERATING_SYSTEMS.ANDROID:p._getUserAgent().match(/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i)?p.OPERATING_SYSTEMS.LINUX:p._getUserAgent().match(/(macintosh|mac os x)/i)?p.OPERATING_SYSTEMS.MACOSX:p._getUserAgent().match(/(windows|win32)/i)?p.OPERATING_SYSTEMS.WINDOWS:p.OPERATING_SYSTEMS.UNKNOWN}static _getOsVersion(){return p._getOsName()===p.OPERATING_SYSTEMS.WINDOWS?function(){var e=p._getUserAgent().match(new RegExp("Windows NT "+p.REGEX_VERSION));if(e&&p.VERSION_MAPPINGS[e[1]])return p.VERSION_MAPPINGS[e[1]];return p.UNKNOWN_VERSION}():p._getOsName()===p.OPERATING_SYSTEMS.MACOSX?function(){var e=p._getUserAgent().match(new RegExp(p.OPERATING_SYSTEMS.MACOSX+" "+p.REGEX_VERSION_MAC));if(e){var t=e[1].replace(/_/g,".");if(t){var n=function(e){if(e.indexOf(".")>-1)return".";if(e.indexOf("_")>-1)return"_";return null}(t);return n?t.split(n)[0]:t}}return p.UNKNOWN_VERSION}():p.UNKNOWN_VERSION}}p.semanticContext=new _(!0),p.firstLaunchTime=-1,p.BROWSERS={MSIE:"MSIE",CHROME:"Chrome",FIREFOX:"Firefox",SAFARI:"Safari",EDGE:"Edge",EDGEANAHEIM:"EdgeAnaheim",ELECTRON:"Electron",SKYPE_SHELL:"SkypeShell",PHANTOMJS:"PhantomJS",UNKNOWN:"Unknown"},p.OPERATING_SYSTEMS={WINDOWS:"Windows",MACOSX:"Mac OS X",WINDOWS_PHONE:"Windows Phone",WINDOWS_RT:"Windows RT",IOS:"iOS",ANDROID:"Android",LINUX:"Linux",UNKNOWN:"Unknown"},p.VERSION_MAPPINGS={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},p.REGEX_VERSION="([\\d,.]+)",p.REGEX_VERSION_MAC="([\\d,_,.]+)",p.UNKNOWN_VERSION="Unknown",p.DEVICE_ID_COOKIE="MicrosoftApplicationsTelemetryDeviceId",p.FIRST_LAUNCH_TIME_COOKIE="MicrosoftApplicationsTelemetryFirstLaunchTime",function(e){e[e.STARTED=0]="STARTED",e[e.ENDED=1]="ENDED"}(s||(s={}));class g{static initialize(e,t){if(!g._initialized){if(!t)throw new C(i.INVALID_TENANT_TOKEN);g._defaultToken=t,g._config.collectorUrl||(g._config.collectorUrl="https://browser.pipe.aria.microsoft.com/Collector/3.0/"),d||(d=r.sE.CreateTelemetryManager()).Initialize(g._config),d.Start(),p.initialize(e),g._initialized=!0}}static initializeWithConfiguration(e,t,n){if(!n.collectorUrl)throw new C(i.INVALID_COLLECTOR_URL);g._config.collectorUrl=n.collectorUrl,g.initialize(e,t)}static flush(e){d.Flush(e)}static addCallbackListener(e){g._initialized&&d.AddListener(e)}static setContext(e,t,n){""!==t&&"null"!==t&&"undefined"!==t?g._contextProperties.setProperty(e,t,n):g._contextProperties.unsetProperty(e)}static isInitialized(){return g._initialized}static getDefaultToken(){return g._defaultToken}static getSemanticContext(){return g._semanticContext}static __addTestHookListener(e){g._initialized&&d.__AddTestHookListener(e)}static __clearTestHookListener(){g._initialized&&d.__ClearTestHookListener()}static __backToUninitialized(){g._config=new r.Mk,g._semanticContext=new _(!0),g._contextProperties=new u,d=r.sE.CreateTelemetryManager(),g._initialized=!1}}g._initialized=!1,g._defaultToken=null,g._config=new r.Mk,g._contextProperties=new u,g._semanticContext=new _(!0);class m{constructor(e){this._initId=o.P6.GetGuid(),this._sequence=0,this._tenantToken=null,this._contextProperties=new u,this._semanticContext=new _(!1),this._sessionStartTime=0,this._sessionId=null,this._tenantToken=e||g.getDefaultToken()}logEvent(e){if(!e.name)throw new C(i.MISSING_EVENT_PROPERTIES_NAME);var t=this._createEventRecord(e.name,e.eventType);this._addCustomPropertiesToEvent(t,e),this._sendRecord(t)}logFailure(e,t,n,s,r){if(!e)throw new C(i.MISSING_FAILURE_SIGNATURE);if(!t)throw new C(i.MISSING_FAILURE_DETAIL);var o=this._createEventRecord("failure","failure");o.Extension.Add("Failure.Signature",e),o.Extension.Add("Failure.Detail",t),n&&o.Extension.Add("Failure.Category",n),s&&o.Extension.Add("Failure.Id",s),this._addCustomPropertiesToEvent(o,r),this._sendRecord(o)}logPageView(e,t,n,s,r,o){if(!e)throw new C(i.MISSING_PAGEVIEW_ID);if(!t)throw new C(i.MISSING_PAGEVIEW_NAME);var a=this._createEventRecord("pageview","pageview");a.Extension.Add("PageView.Id",e),a.Extension.Add("PageView.Name",t),n&&a.Extension.Add("PageView.Category",n),s&&a.Extension.Add("PageView.Uri",s),r&&a.Extension.Add("PageView.ReferrerUri",r),this._addCustomPropertiesToEvent(a,o),this._sendRecord(a)}logSession(e,t,n,r){if(e!==s.STARTED&&e!==s.ENDED)throw new C(i.INVALID_SESSION_STATE);var a=this._createEventRecord("session","session");if(e===s.STARTED){if(this._sessionStartTime>0)return;this._sessionStartTime=r||(new Date).getTime(),this._sessionId=n||o.P6.GetGuid(),a.Extension.Add("Session.Id",this._sessionId),a.Extension.Add("Session.State","Started")}else if(e===s.ENDED){if(0==this._sessionStartTime)return;var l=Math.floor(((new Date).getTime()-this._sessionStartTime)/1e3);a.Extension.Add("Session.Duration",l.toString()),a.Extension.Add("Session.DurationBucket",this._getSessionDurationFromTime(l)),a.Extension.Add("Session.Id",this._sessionId),a.Extension.Add("Session.State","Ended"),this._sessionId=null,this._sessionStartTime=0}a.Extension.Add("Session.FirstLaunchTime",new Date(p.firstLaunchTime).toISOString()),this._addCustomPropertiesToEvent(a,t),this._sendRecord(a)}getSessionId(){return this._sessionId}setContext(e,t,n){this._contextProperties.setProperty(e,t,n)}getSemanticContext(){return this._semanticContext}_getSessionDurationFromTime(e){return e<0?"Undefined":e<=3?"UpTo3Sec":e<=10?"UpTo10Sec":e<=30?"UpTo30Sec":e<=60?"UpTo60Sec":e<=180?"UpTo3Min":e<=600?"UpTo10Min":e<=1800?"UpTo30Min":"Above30Min"}_createEventRecord(e,t){var n=new o.WV;t||(t="custom"),n.EventType=e.toLowerCase(),n.Type=t.toLowerCase(),n.Extension.Add("EventInfo.Source","JS_default_source"),n.Extension.Add("EventInfo.InitId",this._initId),this._sequence++,n.Extension.Add("EventInfo.Sequence",this._sequence.toString()),n.Extension.Add("EventInfo.Name",e.toLowerCase());var i=new Date;return n.Timestamp=o.P6.GetTimeStampWithValue(i.getTime()),n.Extension.Add("EventInfo.Time",i.toISOString()),n.Extension.Add("EventInfo.SdkVersion","ACT-Web-JS-"+l.w.version),n}_addCustomPropertiesToEvent(e,t){this._addSemanticContext(e,p.semanticContext),this._addSemanticContext(e,g._semanticContext),this._addSemanticContext(e,this._semanticContext),this._sessionId&&e.Extension.Add("Session.Id",this._sessionId),this._addEventPropertiesToEvent(e,g._contextProperties),this._addEventPropertiesToEvent(e,this._contextProperties),this._addEventPropertiesToEvent(e,t)}_addSemanticContext(e,t){if(t&&t.contextMap.Count()>0)for(var n=t.contextMap.GetBuffer(),i=0;i<n.length;i++)"UserInfo.Id"==n[i].Key&&t.piiKind!=o.A4.NotSet?e.AddOrReplacePII(n[i].Key,n[i].Value,t.piiKind):e.Extension.AddOrReplace(n[i].Key,n[i].Value)}_addEventPropertiesToEvent(e,t){if(t){t.timestamp&&t.timestamp>=new Date("1/1/2000").getTime()&&(e.Timestamp=o.P6.GetTimeStampWithValue(t.timestamp),e.Extension.AddOrReplace("EventInfo.Time",new Date(t.timestamp).toISOString())),t.name&&(e.EventType=t.name.toLowerCase(),e.Extension.AddOrReplace("EventInfo.Name",t.name.toLowerCase()));var n=t.properties;if(n)for(var i in n)n[i].key&&"string"==typeof n[i].key&&(n[i].value||0==n[i].value||0==n[i].value||""==n[i].value)&&(h._isPii(n[i].pii)?(e.AddOrReplacePII(n[i].key,n[i].value.toString(),n[i].pii),e.Extension.Remove(n[i].key)):(e.Extension.AddOrReplace(n[i].key,n[i].value.toString()),e.PIIExtensions.Remove(n[i].key)))}}_sendRecord(e){g.isInitialized()&&d.SendAsync(this._tenantToken,[e])}}},920514:(e,t,n)=>{n.d(t,{a:()=>u,B:()=>h});var i=n(505898);const s=[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.DL,i.Cb.ModernGroup,i.Cb.PersonalContact,i.Cb.UserDefinedGroup,i.Cb.Pstn,i.Cb.CallQandAA,i.Cb.Room,i.Cb.TeamTags,i.Cb.GroupChats,i.Cb.Xtap,i.Cb.TflOffNetworkEmails,i.Cb.TflOffNetworkPhones,i.Cb.TflConsumer,i.Cb.ImplicitContacts],r=[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.DL,i.Cb.ModernGroup,i.Cb.UserDefinedGroup,i.Cb.Pstn,i.Cb.CallQandAA,i.Cb.Room,i.Cb.TeamTags,i.Cb.GroupChats,i.Cb.Xtap,i.Cb.TflOffNetworkEmails,i.Cb.TflOffNetworkPhones,i.Cb.TflConsumer,i.Cb.ImplicitContacts],o=[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.DL,i.Cb.ModernGroup,i.Cb.UserDefinedGroup,i.Cb.Pstn,i.Cb.CallQandAA,i.Cb.Room,i.Cb.TeamTags,i.Cb.GroupChats,i.Cb.Xtap,i.Cb.TflOffNetworkEmails,i.Cb.TflOffNetworkPhones,i.Cb.TflConsumer,i.Cb.ImplicitContacts],a=[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.DL,i.Cb.ModernGroup,i.Cb.UserDefinedGroup,i.Cb.Pstn,i.Cb.CallQandAA,i.Cb.Room,i.Cb.GroupChats,i.Cb.Xtap,i.Cb.Meetings,i.Cb.TflSmsName],l=(i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.DL,i.Cb.ModernGroup,i.Cb.PersonalContact,i.Cb.UserDefinedGroup,i.Cb.Pstn,{[i.TS.callForwardGroupSelection]:[i.Cb.AADTenant,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Pstn,i.Cb.CallQandAA],[i.TS.allTrue]:s,[i.TS.meetingRoomCall]:r,[i.TS.searchSuggestions]:a,[i.TS.addToMeetingForSharedChannel]:o,[i.TS.calendarPeoplePicker]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.DisabledUser,i.Cb.PersonalContact,i.Cb.ModernGroup,i.Cb.DL],[i.TS.searchResults]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.ModernGroup,i.Cb.UserDefinedGroup,i.Cb.Pstn,i.Cb.CallQandAA],[i.TS.addToTeam]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.Pstn],[i.TS.newChat]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.DL,i.Cb.ModernGroup,i.Cb.UserDefinedGroup,i.Cb.TeamTags,i.Cb.Room,i.Cb.TflSmsName,i.Cb.ExtendedDirectoryUsers],[i.TS.transfer]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.DisabledUser,i.Cb.DL,i.Cb.ModernGroup,i.Cb.UserDefinedGroup,i.Cb.Pstn,i.Cb.CallQandAA],[i.TS.addToCall]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.UserDefinedGroup,i.Cb.Pstn,i.Cb.PersonalContact,i.Cb.CallQandAA,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.ImplicitContacts,i.Cb.TflConsumer,i.Cb.Xtap],[i.TS.addToChat]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.DisabledUser,i.Cb.TeamTags,i.Cb.Room],[i.TS.searchPeopleFilter]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.Pstn,i.Cb.TeamTags],[i.TS.callRouting]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.DL,i.Cb.UserDefinedGroup,i.Cb.Pstn,i.Cb.CallQandAA],[i.TS.delegationSelection]:[i.Cb.AADTenant],[i.TS.presenceSettings]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Pstn],[i.TS.addToMeeting]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.DL,i.Cb.ModernGroup,i.Cb.UserDefinedGroup,i.Cb.Pstn],[i.TS.meetingSchedule]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.DL,i.Cb.ModernGroup,i.Cb.Pstn],[i.TS.addToSpeedDialOrContacts]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.Pstn,i.Cb.CallQandAA],[i.TS.atMention]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Bot,i.Cb.Pstn],[i.TS.orgChart]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Pstn],[i.TS.priorityContactsSelection]:[i.Cb.AADTenant,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Pstn],[i.TS.taggedContactsSelection]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.DL],[i.TS.shareToTeams]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.DisabledUser,i.Cb.UserDefinedGroup],[i.TS.escalateMessage]:[i.Cb.AADTenant],[i.TS.voicemailTransferTarget]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.ModernGroup,i.Cb.UserDefinedGroup,i.Cb.Pstn,i.Cb.CallQandAA],[i.TS.addToSharedChannel]:[i.Cb.AADTenant,i.Cb.Xtap],[i.TS.allFalse]:[],[i.TS.custom]:[]});var d=n(458281);const c=(e,t)=>(0,d.flatten)(e.filter((([e,n])=>e===t)).map((([e,t])=>t))),h={[i.H8.Substrate]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.GroupChats,i.Cb.DL,i.Cb.ModernGroup,i.Cb.Room,i.Cb.ExtendedDirectoryUsers,i.Cb.PersonalContact,i.Cb.MTOUsers],[i.H8.AAD]:[i.Cb.Guest],[i.H8.IndexedDb]:[i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.Pstn],[i.H8.MiddleTier]:[],[i.H8.TopNCache]:[],[i.H8.Memory]:[],[i.H8.TFLZeroState]:[]};class u{constructor(e,t){this.includeFeatures=e,this.name=t,this.includeAADTenant=!1,this.includeGuest=!1,this.includeFederated=!1,this.includeFederatedConsumer=!1,this.includeBot=!1,this.includeDisabledUser=!1,this.includeDL=!1,this.includeModernGroup=!1,this.includePersonalContact=!1,this.includeUserDefinedGroup=!1,this.includePstn=!1,this.includeCallQandAA=!1,this.includeRoom=!1,this.includeTeamTags=!1,this.includeGroupChats=!1,this.includeMeetingChats=!1,this.includeXtap=!1,this.includeOffNetworkEmails=!1,this.includeOffNetworkPhones=!1,this.includeTflConsumer=!1,this.includeTflSmsName=!1,this.includeImplicitContacts=!1,this.includeExtendedDirectoryUsers=!1,this.includeMTOUsers=!1,this.includeAADTenant=(0,d.includes)(e,i.Cb.AADTenant),this.includeGuest=(0,d.includes)(e,i.Cb.Guest),this.includeFederated=(0,d.includes)(e,i.Cb.Federated),this.includeFederatedConsumer=(0,d.includes)(e,i.Cb.FederatedConsumer),this.includeBot=(0,d.includes)(e,i.Cb.Bot),this.includeDisabledUser=(0,d.includes)(e,i.Cb.DisabledUser),this.includeDL=(0,d.includes)(e,i.Cb.DL),this.includeModernGroup=(0,d.includes)(e,i.Cb.ModernGroup),this.includePersonalContact=(0,d.includes)(e,i.Cb.PersonalContact),this.includeUserDefinedGroup=(0,d.includes)(e,i.Cb.UserDefinedGroup),this.includePstn=(0,d.includes)(e,i.Cb.Pstn),this.includeCallQandAA=(0,d.includes)(e,i.Cb.CallQandAA),this.includeRoom=(0,d.includes)(e,i.Cb.Room),this.includeTeamTags=(0,d.includes)(e,i.Cb.TeamTags),this.includeGroupChats=(0,d.includes)(e,i.Cb.GroupChats),this.includeMeetingChats=(0,d.includes)(e,i.Cb.Meetings),this.includeXtap=(0,d.includes)(e,i.Cb.Xtap),this.includeOffNetworkEmails=(0,d.includes)(e,i.Cb.TflOffNetworkEmails),this.includeOffNetworkPhones=(0,d.includes)(e,i.Cb.TflOffNetworkPhones),this.includeTflConsumer=(0,d.includes)(e,i.Cb.TflConsumer),this.includeTflSmsName=(0,d.includes)(e,i.Cb.TflSmsName),this.includeImplicitContacts=(0,d.includes)(e,i.Cb.ImplicitContacts),this.includeExtendedDirectoryUsers=(0,d.includes)(e,i.Cb.ExtendedDirectoryUsers),this.includeMTOUsers=(0,d.includes)(e,i.Cb.MTOUsers)}}u.fromName=(e,t=[])=>{if(!(e in l))throw new TypeError("Invalid `name` attribute passed. Please make sure it exists in PEOPLE_FILTER_NAME_CONFIG.");const n=c(t,!0),i=c(t,!1),s=d.without.apply(null,[(0,d.concat)(l[e],n),...i]);return new u(s,e)},u.createFrom=(e,t,n)=>new u(t||e.includeFeatures,n||e.name),u.includesAll=(e,t)=>(0,d.every)(t,(t=>(0,d.includes)(e.includeFeatures,t))),u.includesAny=(e,t)=>(0,d.some)(t,(t=>(0,d.includes)(e.includeFeatures,t)))},634102:(e,t,n)=>{n.d(t,{t:()=>o});var i=n(122267),s=n(403623),r=n(695047);class o{constructor(e,t){this._document=e,this._chunkConfig=t,this._loadedItems=new Map,this._loadScript=(0,r.m)(((e,t)=>new Promise(((n,i)=>{if(!e)return n();const r=this._document.createElement("script");if(r.onload=()=>n(),r.onerror=i,r.async=!0,r.id=`${t}-script`,r.charset="utf-8",!this._coreSecurityService)throw new s.Y("DEVELOPER_ERROR",new Error("Chunkloader core security service is not defined. This should never happen"));try{const t=this._coreSecurityService.getTrustedTypePolicy("@msteams/services-utilities-common#ChunkLoader").createScriptURL(e,r.baseURI);r.src=t}catch(e){throw e}this._document.body.appendChild(r)}))),{backoffTime:1e4,retryWindow:3e4,maxRetries:3}),this._loadStyle=(0,r.m)(((e,t)=>new Promise(((n,i)=>{if(!e)return n();const s=this._document.createElement("link");s.onload=()=>n(),s.onerror=i,s.type="text/css",s.rel="stylesheet",s.id=`${t}-style`,s.charset="utf-8",s.href=e,this._document.head.appendChild(s)}))),{backoffTime:1e4,retryWindow:3e4,maxRetries:3}),this.loadChunk=(e,t=!1)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this._chunkConfig)throw new Error("Chunk loading is not supported in this window or host.");const n=e.reduce(((e,n)=>{const i=this._chunkConfig&&this._chunkConfig[n];if(!i)return e.push(Promise.reject(new Error(`No chunk information found for ${i}.`))),e;const s=i.endsWith(".css")?this._loadStyle:this._loadScript,r=this._loadedItems.get(i)||s(i,n).catch((e=>{throw t&&this._loadedItems.delete(i),e}));return this._loadedItems.has(i)||this._loadedItems.set(i,r),e.push(r),e}),[]);yield Promise.all(n)}))}configureCoreSecurityService(e){if(this._coreSecurityService)throw new s.Y("DUPLICATE_POLICY_FOUND",new Error("ChunkLoader::coreSecurityService is already defined. Developer should not be calling configureCoreSecurityService multiple times in it's context"));e&&(this._coreSecurityService=e)}}},507416:(e,t,n)=>{function i(e){let t=5381;for(let n=0;n<e.length;n++)t=(t<<5)+t+e.charCodeAt(n);return t>>>0}n.d(t,{E:()=>i})},953917:(e,t,n)=>{function i(e){return e.ResizeObserver?e.ResizeObserver:function(t){const n=new Map;let i,s=!1;function r(){if(s||!n.size)return void(i=void 0);const o=[];n.forEach(((e,t)=>{const i=t.getBoundingClientRect();e.height!==i.height&&(n.set(t,i),o.push({target:t,contentRect:i}))})),o.length&&t(o),i=e.requestAnimationFrame(r)}return{observe(t){n.has(t)||(n.set(t,t.getBoundingClientRect()),i||(i=e.requestAnimationFrame(r)))},unobserve(e){n.has(e)&&n.delete(e)},disconnect(){n.clear(),i=void 0,s=!0}}}}n.d(t,{S:()=>i})},695047:(e,t,n)=>{n.d(t,{X:()=>d,m:()=>c});var i=n(122267),s=n(403623),r=n(707728),o=n(170315),a=n(155974),l=n(869101);const d=(e,t)=>(...n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){for(;;)try{return yield e(...n)}catch(e){yield t(e,...n)}})),c=(e,t)=>{const{maxRetries:n,retryWindow:d,backoffTime:c,shouldRetry:h}=t,u=e=>d-(Date.now()-e);return(...t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const i=Date.now();let d=0,C=u(i);for(;d++<=n&&C>0;)try{return yield Promise.resolve(e.apply(e,t))}catch(e){if(e instanceof s.Y)throw e;const t=yield(0,r.tE)(e);if(h&&!h(t))throw t?(0,o.Tr)(t.context,t.code,t.subContext?t.subContext:"",t.reason,t.message,t.serverResponse):(0,o.Tr)("RetryWithBackoff",a.jK.MaxLimitReached,"elapsed",void 0,`All retries elapsed or retryWindow expired, RetryCount: ${d}, RemainingTime: ${C}`);if(d>=n||u(i)<=0)break;yield(0,l._)(c),C=u(i)}throw(0,o.Tr)("RetryWithBackoff",a.jK.MaxLimitReached,"elapsed",void 0,`All retries elapsed or retryWindow expired, RetryCount: ${d}, RemainingTime: ${C}`)}))}},796502:(e,t,n)=>{var i,s,r;n.d(t,{gT:()=>i,lP:()=>s,ej:()=>r}),function(e){e[e.Two=2]="Two",e[e.FOUR=4]="FOUR",e[e.FIVE=5]="FIVE",e[e.FIFTEEN=15]="FIFTEEN",e[e.TWENTY_FOUR=24]="TWENTY_FOUR",e[e.SECONDS_PER_MINUTE=60]="SECONDS_PER_MINUTE",e[e.MINUTES_PER_HOUR=60]="MINUTES_PER_HOUR",e[e.MILLI_PER_SECOND=1e3]="MILLI_PER_SECOND",e[e.MILLI_PER_MINUTE=6e4]="MILLI_PER_MINUTE",e[e.MILLISECONDS_PER_HOUR=36e5]="MILLISECONDS_PER_HOUR",e[e.MILLISECONDS_PER_DAY=864e5]="MILLISECONDS_PER_DAY"}(i||(i={})),function(e){e[e.LOAD_FRAME_TIMEOUT=15e3]="LOAD_FRAME_TIMEOUT",e[e.EXPIRE_OFFSET_SECONDS=600]="EXPIRE_OFFSET_SECONDS",e[e.MT_TOKEN_INTERVAL=12e4]="MT_TOKEN_INTERVAL",e[e.ACQUIRE_TOKEN_TIMEOUT=6e4]="ACQUIRE_TOKEN_TIMEOUT",e[e.DEFAULT_ACQUIRE_TOKEN_MAX_RETRIES=3]="DEFAULT_ACQUIRE_TOKEN_MAX_RETRIES",e[e.DEFAULT_ACQUIRE_TOKEN_RETRY_WINDOW=3e4]="DEFAULT_ACQUIRE_TOKEN_RETRY_WINDOW",e[e.DEFAULT_ACQUIRE_TOKEN_BACKOFF_TIME=2e3]="DEFAULT_ACQUIRE_TOKEN_BACKOFF_TIME",e[e.ELECTRON_ACQUIRE_TOKEN_TIMEOUT=22e4]="ELECTRON_ACQUIRE_TOKEN_TIMEOUT",e[e.ACQUIRE_TOKEN_SCENARIO_TIMEOUT=24e4]="ACQUIRE_TOKEN_SCENARIO_TIMEOUT",e[e.DEFAULT_SKYPE_MAX_DELAY_TIME_MS=3e4]="DEFAULT_SKYPE_MAX_DELAY_TIME_MS",e[e.DEFAULT_SKYPE_MAX_RETRY_DURATION_MS=15e3]="DEFAULT_SKYPE_MAX_RETRY_DURATION_MS",e[e.DEFAULT_SKYPE_MAX_RETRY_COUNT=3]="DEFAULT_SKYPE_MAX_RETRY_COUNT",e[e.DEFAULT_SKYPE_MIN_RETRY_INTERVAL_MS=1e3]="DEFAULT_SKYPE_MIN_RETRY_INTERVAL_MS",e[e.DEFAULT_SKYPE_EXP_DELAY_FACTOR=2]="DEFAULT_SKYPE_EXP_DELAY_FACTOR"}(s||(s={})),function(e){e.LOKI_TFL_AUTH_TOKEN_AUDIENCE="liveprofilecard.access",e.MT_AAD_KEY="https://api.spaces.skype.com",e.MT_KEY="middleTier",e.SKYPE_KEY="skype",e.AUTHZ_DEFAULT_BASE_URL="https://authsvc.teams.microsoft.com/v1.0/authz",e.GROUPS_SERVICE="https://groupssvc.fl.teams.microsoft.com/teams.readwrite",e.UNIFIED_CONSENT_WEB_AUTH_URL="https://consentservice.microsoft.com/web/UnifiedUserConsent.ReadWrite",e.UNIFIED_CONSENT_CHECKIN_AUTH_URL="https://consentservice.microsoft.com/checkin/UnifiedUserConsent.Read"}(r||(r={}))}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/64275-78d79bf725cd44d4.js.map